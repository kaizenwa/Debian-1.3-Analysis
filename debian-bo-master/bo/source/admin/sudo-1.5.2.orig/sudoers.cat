


sudoers(5)                FILE FORMATS                 sudoers(5)



NAME
     sudoers - list of which users may execute what as root

DESCRIPTION
     The _s_u_d_o_e_r_s file is composed of an optional host alias
     section, an optional command alias section and the user
     specification section.  All command or host aliases need to
     start with their respective keywords (ie: Host_Alias,
     User_Alias, or Cmnd_Alias).  If there are multiple
     occurrences of a user, the union of the entries will be
     used.

     user specification format:

       user access_group [: access_group] ...

         access_group ::= host_type = [(user_list)] [NOPASSWD:] [op]cmnd_type
                          [,[(user_list)] [NOPASSWD:] [op]cmnd_type] ...
            host_type ::= a lower-case hostname, netgroup, ip address,
                          network number, network number/netmask,
                          or host alias.
            user_list ::= comma-separated list of users, uids, or
                          User_Aliases the user may run commands as
                          (default is root).
            cmnd_type ::= a command OR a command alias.
                   op ::= the logical "!" NOT operator.


     host alias section format:

       Host_Alias HOSTALIAS = host-list

           Host_Alias ::= a keyword.
            HOSTALIAS ::= an upper-case alias name.
            host-list ::= a comma separated list of hosts, netgroups,
                          ip addresses, networks.


     user alias section format:

       User_Alias USERALIAS = user-list

           User_Alias ::= a keyword.
            USERALIAS ::= an upper-case alias name.
            user-list ::= a comma separated list of users, groups, netgroups.


     command alias section format:

       Cmnd_Alias CMNDALIAS = cmnd-list





7/Sep/96                      1.5.2                             1






sudoers(5)                FILE FORMATS                 sudoers(5)



           Cmnd_Alias ::= a keyword.
            CMNDALIAS ::= an upper-case alias name.
            cmnd-list ::= a comma separated list commands.


     command specification:

       path arg1 arg2 .. argn = command

                 path ::= a fully qualified pathname.
            arg[1..n] ::= optional command line arguments.


     wildcards (aka meta characters):

     sudo allows shell-style _w_i_l_d_c_a_r_d_s along with command
     arguments in the _s_u_d_o_e_r_s file.  Wildcard matching is done
     via the POSIX fnmatch(3) routine.

     *       Matches any set of zero or more characters.

     ?       Matches any single character.

     [...]   Matches any character in the specified range.

     [!...]  Matches any character not in the specified range.

     \x      For any character "x", evaluates to "x".  This is
             used to escape special characters such as: "*", "?",
             "[", and "}".

     exceptions to wildcard rules:

     The following exceptions apply to the above rules:

          If the empty string "" is the only command line
          argument in the _s_u_d_o_e_r_s entry it means that command may
          take no arguments.

     other special characters and reserved words:

     Text after a pound sign (#) is considered a comment.  Words
     that begin with a percent sign (%) are assumed to be UN*X
     groups (%staff refers to users in the group _s_t_a_f_f).  Words
     that begin with a plus sign (+) are assumed to be netgroups
     (+cshosts refers to the netgroup _c_s_h_o_s_t_s).  Long lines can
     be newline escaped with the backslash \ character.  The
     reserved word NOPASSWD indicates that a user need not enter
     a password for the command listed in that entry.

     The reserved alias _A_L_L can be used for both
     {Host,User,Cmnd}_Alias.  DO NOT define an alias of _A_L_L, it



7/Sep/96                      1.5.2                             2






sudoers(5)                FILE FORMATS                 sudoers(5)



     will NOT be used.  Note that _A_L_L implies the entire universe
     of hosts/users/commands.  You can subtract elements from the
     universe by using the syntax:
        user  host=ALL,!ALIAS1,!/etc/halt...  Note that the "!"
     notation only works in a user's command list.  You may not
     use it to subtract elements in a User_Alias, Host_Alias,
     Cmnd_Alias or user list.

     Commands may have optional command line arguments.  If they
     do, then the arguments in the _s_u_d_o_e_r_s file must exactly
     match those on the command line.  It is also possible to
     have a command's arguments span multiple lines as long as
     the line continuance character "\" is used.  The following
     characters must be escaped with a "\" if used in command
     arguments: ",", ":", "=", "\".

EXAMPLES
         # Host alias specification
         Host_Alias  HUB=houdini:\
                     REMOTE=merlin,kodiakthorn,spirit
         Host_Alias  SERVERS=houdini,merlin,kodiakthorn,spirit
         Host_Alias  CUNETS=128.138.0.0/255.255.0.0
         Host_Alias  CSNETS=128.138.243.0,128.138.204.0,\
                            128.138.205.192

         # User alias specification
         User_Alias  FULLTIME=millert,dowdy,mikef
         User_Alias  PARTTIME=juola,mccreary,tor

         # Command alias specification
         Cmnd_Alias  LPCS=/usr/etc/lpc,/usr/ucb/lprm
         Cmnd_Alias  SHELLS=/bin/sh,/bin/csh,/bin/tcsh,/bin/ksh
         Cmnd_Alias  SU=/bin/su
         Cmnd_Alias  MISC=/bin/rm,/bin/cat:\
                     SHUTDOWN=/etc/halt,/etc/shutdown

         # User specification
         FULLTIME    ALL=(ALL) NOPASSWD: ALL
         %wheel      ALL=ALL
         PARTTIME    ALL=ALL,!SHELLS,!SU
         +interns    +openlabs=ALL,!SHELLS,!SU
         britt       REMOTE=SHUTDOWN:ALL=LPCS
         jimbo       CUNETS=/bin/su ?*,!/bin/su root
         nieusma     SERVERS=SHUTDOWN,/etc/reboot:\
                     HUB=ALL,!SHELLS
         jill        houdini=/etc/shutdown -[hr] now,MISC
         markm       HUB=ALL,!MISC,!/etc/shutdown,!/etc/halt
         davehieb    merlin=ALL:SERVERS=/etc/halt:\
                     kodiakthorn=NOPASSWD: ALL
         steve       CSNETS= (operator) /usr/op_commands/





7/Sep/96                      1.5.2                             3






sudoers(5)                FILE FORMATS                 sudoers(5)



     Host Alias specifications:

     The are four _h_o_s_t _a_l_i_a_s_e_s.  The first actually contains two
     _a_l_i_a_s_e_s.  It sets HUB to be houdini and REMOTE to the three
     machines merlin, kodiakthorn and spirit.  Similarly, SERVERS
     is set to the machines houdini, merlin, kodiakthorn and
     spirit.  The CSNETS alias will match any host on the
     128.138.243.0, 128.138.204.0, or 128.138.205.192 nets.  The
     CUNETS alias will match any host on the 128.138.0.0 (class
     B) network.  Note that these are network addresses, not ip
     addresses.  Unless an explicate netmask is given, the local
     _n_e_t_m_a_s_k is used to determine whether or not the current host
     belongs to a network.

     User Alias specifications:

     The two _u_s_e_r _a_l_i_a_s_e_s simply groups the FULLTIME and PARTTIME
     folks into two separate aliases.

     Command alias specifications:

     Command aliases are lists of commands with or without
     associated command line arguments.  The entries above should
     be self-explanatory.

     User specifications:

     FULLTIME        Full-time sysadmins in the FULLTIME alias
                     may run any command on any host as any user
                     without a password.

     %wheel          Any user in the UN*X group wheel may run any
                     command on any host.

     PARTTIME        Part-time sysadmins in the PARTTIME alias
                     may run any command except those in the
                     SHELLS and SU aliases on any host.

     +interns        Any user in the netgroup interns may run any
                     command except those in the SHELLS and SU
                     aliases on any host that is in the openlabs
                     netgroup.

     britt           The user britt may run commands in the
                     SHUTDOWN alias on the REMOTE machines and
                     commands in the LPCS alias on any machine.

     jimbo           The user jimbo may su to any user save root
                     on the machines on CUNETS (which is
                     explicately listed as a class B network).





7/Sep/96                      1.5.2                             4






sudoers(5)                FILE FORMATS                 sudoers(5)



     nieusma         The user nieusma may run commands in the
                     SHUTDOWN alias as well as /_e_t_c/_r_e_b_o_o_t on the
                     SERVER machines and any command except those
                     in the SHELLS alias on the HUB machines.

     jill            The user jill may run /etc/shutdown -h now
                     or /etc/shutdown -r now as well as the
                     commands in the MISC alias on houdini.

     markm           The user markm may run any command on the
                     HUB machines except /_e_t_c/_s_h_u_t_d_o_w_n,
                     /_e_t_c/_h_a_l_t, and commands listed in the MISC
                     alias.

     davehieb        The user davehieb may run any command on
                     merlin, /_e_t_c/_h_a_l_t on the SERVERS.  He may
                     also run any command on kodiakthorn without
                     giving a password.

     steve           The user steve may run any command in the
                     /_u_s_r/_o_p__c_o_m_m_a_n_d_s/ directory as user operator
                     on the machines on CSNETS.

CAVEATS
     The _s_u_d_o_e_r_s file should always be edited by the visudo
     command which locks the file and does grammatical checking.
     It is imperative that the _s_u_d_o_e_r_s be free of syntax errors
     since sudo will not run with a syntactically incorrect
     _s_u_d_o_e_r_s file.

FILES
      /etc/sudoers           file of authorized users.
      /etc/netgroup          list of network groups.


SEE ALSO
     _s_u_d_o(8), _v_i_s_u_d_o(8), _s_u(1), _f_n_m_a_t_c_h(3).


















7/Sep/96                      1.5.2                             5



