.\" Hey Emacs! This file is -*- nroff -*- source.
.\"
.\" This manpage is Copyright (C) 1992 Drew Eckhardt;
.\"                               1993 Michael Haardt
.\"                               1993,1994 Ian Jackson.
.\" You may distribute it under the terms of the GNU General
.\" Public Licence. It comes with NO WARRANTY.
.\"
.\" 
.\" Traduction  10/10/1996 Christophe BLAESS (ccb@club-internet.fr)
.\" 
.TH MKNOD 2 "10 Octobre 1996" "Linux 1.0" "Manuel du programmeur Linux"
.SH NOM
mknod \- Creer un noeud du systeme de fichier.
.SH SYNOPSIS
.nf
.B #include <sys/types.h>
.B #include <sys/stat.h>
.B #include <fcntl.h>
.B #include <unistd.h>
.sp
.BI "int mknod(const char *" pathname ", mode_t " mode ", dev_t " dev );
.fi
.SH DESCRIPTION
.B mknod
cree un noeud du systeme de fichiers (fichier, fichier special de peripherique ou
tube) appele
.IR pathname ", avec les attributs " mode " et " dev .

.I mode
definit a la fois les permissions d'utilisation, et le type de noeud
a creer. C'est une combinaison par 
.I OU binaire
( | ) 
entre l'un des types de noeuds ci-dessous et les permissions d'acces
pour le nouveau noeud.

Les permissions sont modifiees par le
.BR umask
du processus : les permissions effectivement ecrites sont
.BR "(mode & ~umask)" .

Le type de noeud doit etre l'un des suivants
.BR S_IFREG ", " S_IFCHR ", " S_IFBLK " et " S_IFIFO
pour indiquer respectivement un fichier normal (vide a la creation),
un fichier special mode caractere, un fichier special mode bloc,
ou un tube nomme (FIFO).
On peut egalement utiliser 0 pour creer un fichier normal.

Si le noeud est de type
.BR S_IFCHR " or " S_IFBLK
alors
.I dev
doit specifier les numeros majeurs et mineurs du peripherique
associe, pour les autres types de noeuds,
.I dev
est ignore.

Le noeud nouvellement cree aura pour proprietaire l'UID effectif
du processus. Si le repertoire contenant ce noeud a son bit
Set\-GID a 1, ou si le systeme de fichier est monte avec une
semantique BSD, le nouveau noeud heritera de l'appartenance au
groupe de son parent. Sinon il appartiendra au groupe effectif
du processus.
.SH "VALEUR RENVOYEE"
.BR mknod
renvoie 0 s'il reussit, ou \-1 s'il echoue, auquel cas
.I errno
contient le code d'erreur.
.SH ERREURS
.TP
.B EPERM
.I mode
demande la creation d'un noeud autre qu'un tube nomme, alors que
le processus appelant n'est pas le Super\-User. Cette erreur se
produit egalement si le systeme de fichier contenant
.I pathname
ne supporte pas les noeuds du type demande.
.TP
.B EINVAL
.I mode
demande la creation d'autre chose qu'un fichier normal, fichier
special de peripherique ou tube nomme.
.TP
.B EEXIST
.I pathname
existe deja
.TP
.B EFAULT
.IR pathname " pointe en\-dehors de l'espace d'adressage accessible."
.TP
.B EACCES
Le repertoire parent n'autorise pas l'ecriture au processus, ou l'un
des repertoires de
.IR pathname
n'autorise pas la consultation de son contenu.
.TP
.B ENAMETOOLONG
.IR pathname " trop long."
.TP
.B ENOENT
Un repertoire du chemin d'acces
.I pathname
n'existe pas ou est un lien symbolique pointant nulle part.
.TP
.B ENOTDIR
Un element utilise dans le chemin
.I pathname
n'est pas un repertoire.
.TP
.B ENOMEM
Pas assez de memoire pour le noyau.
.TP
.B EROFS
.I pathname
correspond a un fichier sur un systeme de fichier en lecture seule.
.TP
.B ELOOP
.I pathname
contient une reference circulaire (a travers un lien symbolique).
.TP
.B ENOSPC
Le peripherique contenant
.I pathname
n'a pas assez de place pour le nouveau noeud. Cette erreur se
produit egalement si
le quota de disque de l'utilisateur est depasse.
.\" .SH "CONFORME A"
.SH BUGS
.B mknod
ne peut pas etre utilise pour creer des repertoires ou des fichiers
socket, et ne peut etre appele que par le Super\-User pour creer des
fichiers normaux.
.SH "VOIR AUSSI"
.BR read "(2), " write "(2), " fcntl "(2), " close (2),
.BR unlink "(2), " open "(2), " mkdir "(2), " stat "(2), " umask (2),
.BR mount "(2), " socket "(2), " socket "(2), " fopen (3).
