'\" t
.\" Copyright (c) Michael Haardt (michael@cantor.informatik.rwth-aachen.de), Sun Jan 15 19:16:33 1995
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual; if not, write to the Free
.\" Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
.\" USA.
.\"
.\" Modified, Sun Feb 26 15:02:58 1995, faith@cs.unc.edu
.\"
.\" Traduction 18/10/1996 par Christophe Blaess (ccb@club-internet.fr)
.\"
.TH LP 4 "18 Octobre 1996" Linux "Manuel du programmeur Linux"
.SH NOM
lp \- Imprimantes paralleles.
.SH SYNOPSIS
#include <linux/lp.h>
.SH CONFIGURATION
\fBlp\fP[0\(en2] sont des peripheriques caracteres pour les imprimantes a
liaison parallele. Ils ont un numero majeur 6 et un numero mineur 0\(en2.  
Le numero mineur correspond aux ports d'imprimantes d'adresse de base
0x03bc, 0x0378 et 0x0278.
Habituellement ils ont un mode d'acces 220 et un proprietaire root.lp.

On peut utiliser les ports paralleles soit en scrutation (polling) soit
en interruption. L'utilisation en interruption est surtout recommandee
avec un haut trafic (ex : imprimante laser). Pour les imprimantes
matricielles classiques, la scrutation suffira. Par defaut le systeme
utilise la scrutation.
.SH DESCRIPTION
Les appels systemes
.IR ioctl (2)
suivants sont supportes :
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPTIME, int \fP\fIarg\fP\fB)\fP"
fixe la duree pendant laquelle le driver s'endort avant de reverifier
l'etat de l'imprimante apres que le buffer ait ete rempli. 
Avec une imprimante rapide on peut diminuer ce delai, avec une imprimante
lente on peut l'augmenter.
La duree est indiquee dans \fIarg\fP, en centiemes de secondes. La valeur
par defaut est 2 (soit 0,02 seconde). Cela n'influe que sur le driver
en scrutation.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPCHAR, int \fP\fIarg\fP\fB)\fP"
indique le nombre maximum d'iterations d'attente active que le driver
en scrutation effectue alors qu'il attend que l'imprimante soit prete.
Si l'impression est trop lente, augmenter cette valeur, si le systeme
ralentit trop, la diminuer.
Le nombre est indique dans \fIarg\fP, la valeur par defaut est 1000. Cela
n'influe que sur le diver en scrutation.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPABORT, int \fP\fIarg\fP\fB)\fP"
Si \fIarg\fP vaut 0, le driver reessaiera en cas d'erreur d'impression,
sinon il abandonnera. La valeur par defaut est 0.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPABORTOPEN, int \fP\fIarg\fP\fB)\fP"
Si \fIarg\fP vaut 0,
.IR open (2)
sera annule en cas d'erreur, sinon l'erreur sera ignoree. Par defaut elle
est ignoree.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPCAREFUL, int \fP\fIarg\fP\fB)\fP"
Si \fIarg\fP vaut 0, on bloquera l'ecriture sur le port parallele au cas
ou les broches \fIerreur\fP,  \fIplus\-de\-papier\fP, ou \fIimprimante\-hors\-ligne\fP
sont validees. Sinon ces signaux seront ignores. Par defaut
ils sont ignores.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPWAIT, int \fP\fIarg\fP\fB)\fP"
Indique le nombre d'iterations d'attente active a effectuer avant d'activer
la broche STROBE pour que l'imprimante accepte le caractere ecrit,
et le nombre d'iterations a effectuer avant d'eteindre a nouveau la
broche STROBE.
Les specifications indique que ce delai devrait etre de 0,5 micro\-secondes,
mais l'experience a montre que le delai induit par le code du driver
est suffisant. La valeur est indiquee dans \fIarg\fP, elle vaut 0
par defaut. Ceci concerne autant le gestionnaire en interruption que
celui en scrutation.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPSETIRQ, int \fP\fIarg\fP\fB)\fP"
Cet ioctl() necessite des privileges Super\-User. Son argument est une
nouvelle IRQ pour l'imprimante. Comme effet de bords, l'imprimante est
reinitialisee. Si \fIarg\fP vaut 0, le gestionnaire en scrutation sera
utilise, ce qui est le comportement par defaut.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPGETIRQ, int *\fP\fIarg\fP\fB)\fP"
Stocke la valeur actuelle d'IRQ dans \fIarg\fP.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPGETSTATUS, int *\fP\fIarg\fP\fB)\fP"
Stocke le statut actuel du port dans \fIarg\fP.  Les bits ont les significations
suivantes :
.sp
.TS
l l.
LP_PBUSY	Entree OCCUPEE inversee, active a 1
LP_PACK	Entree ACQUITTEMENT, active a 0
LP_POUTPA	Entree PLUS-DE-PAPIER, active a 1
LP_PSELECD	Entree SELECT, active a 1
LP_PERRORP	Entree ERREUR, active a 0
.TE
.sp
Referez vous au manuel de votre imprimante pour la signification de ces
signaux. Des bits non documentes peuvent egalement etre presents,
suivant le type d'imprimante.

.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPRESET)\fP"
Reinitialise l'imprimante.  Pas d'argument.
.SH FICHIERS
/dev/lp*
.SH AUTEURS
Le driver d'imprimante a ete ecrit a l'origine par Jim Weigand et Linus
Torvalds.  Il fut ensuite ameliore par Michael K.\& Johnson.  Le code
d'interruption a ete ecrit par by Nigel Gamble.  Alan Cox l'a modularise.
LPCAREFUL, LPABORT, LPGETSTATUS ont ete ajoutes par Chris Metcalf.
.SH "VOIR AUSSI"
.BR mknod "(1), " chown "(1), " chmod "(1), " tunelp "(8), " lpcntl (8)
