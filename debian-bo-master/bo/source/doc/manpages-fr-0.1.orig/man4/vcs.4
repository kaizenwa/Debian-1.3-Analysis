.\" Copyright (c) 1995 James R. Van Zandt <jrv@vanzandt.mv.com>
.\" Sat Feb 18 09:11:07 EST 1995
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual; if not, write to the Free
.\" Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
.\" USA.
.\"
.\" Modified, Sun Feb 26 15:08:05 1995, faith@cs.unc.edu
.\" "
.\"
.\" Traduction 18/10/1996 par Christophe Blaess (ccb@club-internet.fr)
.\"
.TH VCS 4 "18 Octobre 1996" Linux "Manuel du programmeur Linux"
.SH NOM
vcs, vcsa \- Memoires des consoles virtuelles.
.SH DESCRIPTION
\fB/dev/vcs0\fP est un peripherique caracteres de numero majeur 7 et
de numero mineur 0, avec les permissions 0644 et un proprietaire root.tty.

Il correspond a la memoire d'affichage de la console virtuelle en
cours d'utilisation.
.LP
\fB/dev/vcs[1-63]\fP sont des peripheriques caracteres representant
la memoire d'affichage des consoles virtuelles. 
Ils ont un numero majeur 7 et des numeros mineurs 1 a 63.
Ils ont generalement un mode d'acces 0644 et un proprietaire root.tty.

Les \fB/dev/vcsa[0-63]\fP sont equivalents mais incluent en plus les
attributs, et sont prefixes avec 4 octets indiquant les dimensions
de l'ecran et la position du curseur :
\fIlines\fP, \fIcolumns\fP, \fIx\fP, \fIy\fP.
(\fIx\fP = \fIy\fP = 0 en haut a gauche de l'ecran.)
.PP
Ceci remplace les ioctls "screendump" de \fBconsole\fP(4), ainsi
l'administrateur peut controler les acces en utilisant les
permissions du systeme de fichiers.
.PP
Les peripheriques pour les 8 premieres consoles virtuelles peuvent
etre cree ainsi :

.nf
	for x in 0 1 2 3 4 5 6 7 8; do 
		mknod -m 644 /dev/vcs$x c 7 $x;
		mknod -m 644 /dev/vcsa$x c 7 $[$x+128];
	done
	chown root.tty /dev/vcs*
.fi

Aucune requete \fBioctl()\fP n'est supportee.
.SH EXEMPLES
On peut faire un screendump de la console vt3 en basculant sur
vt1 et en tapant \fIcat /dev/vcs3 >foo\fP. 
Notez que la sortie ne contient pas de caracteres de retour-chariot,
aussi quelques manipulations peuvent etre necessaires comme
\fIfold -w 81 /dev/vcs3 | lpr\fP ou (horrible !)
\fIsetterm -dump 3 -file /proc/self/fd/1\fP.

Ce programme affiche le caractere et l'attribut d'ecran sous le curseur
de la seconde console virtuelle, puis y change la couleur de fond :

.nf
	#include <unistd.h>
	#include <stdio.h>
	#include <fcntl.h>

	void main()
	{	int fd;
		struct {char lines, cols, x, y;} scrn;
		char ch, attrib;

		fd = open("/dev/vcsa2", O_RDWR);
		(void)read(fd, &scrn, 4);
		(void)lseek(fd, 4 + 2*(scrn.y*scrn.cols + scrn.x), 0);
		(void)read(fd, &ch, 1);
		(void)read(fd, &attrib, 1);
		printf("ch='%c' attrib=0x%02x\\n", ch, attrib);
		attrib ^= 0x10;
		(void)lseek(fd, -1, 1);
		(void)write(fd, &attrib, 1);
	}
.fi

.SH FICHIERS
/dev/vcs[0-63]
.br
/dev/vcsa[0-63]
.SH AUTEUR
Andries Brouwer <aeb@cwi.nl>
.SH HISTORIQUE
Introduits dans la version 1.1.92 du noyau Linux.
.SH "VOIR AUSSI"
.BR console "(4), " tty "(4), " ttys "(4), " selection (1)
