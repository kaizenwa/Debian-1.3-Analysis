.\" @(#)lilo.conf.5 1.0 950728 aeb
.\" This page is based on the lilo docs, which carry the following
.\" COPYING condition:
.\"
.\" LILO program code, documentation and auxiliary programs are
.\" Copyright 1992-1994 Werner Almesberger.
.\" All rights reserved.
.\" 
.\" Redistribution and use in source and binary forms of parts of or the
.\" whole original or derived work are permitted provided that the
.\" original work is properly attributed to the author. The name of the
.\" author may not be used to endorse or promote products derived from
.\" this software without specific prior written permission. This work
.\" is provided "as is" and without any express or implied warranties.
.\"
.\" Traduction 18/10/1996 par Christophe Blaess (ccb@club-internet.fr)
.\"
.TH LILO.CONF 5 "18 Octobre 1996" Lilo "Manuel de l'administrateur Linux"
.SH NOM
lilo.conf \- Fichier de configuration pour Lilo.
.SH DESCRIPTION
.LP
Ce fichier, par defaut
.IR /etc/lilo.conf ,
est lu lors de l'installation du chargeur Lilo (voir lilo(8)).
.LP
Il doit avoir la forme suivante
.IP
.nf
boot = /dev/hda
delay = 40
compact
vga = normal
root = /dev/hda1
read-only
image = /zImage-1.5.99
        label = try
image = /zImage-1.0.9
        label = 1.0.9
image = /tamu/vmlinuz
	label = tamu
	root = /dev/hdb2
	vga = ask
other = /dev/hda3
	label = dos
	table = /dev/hda
.fi
.LP
Ce fichier de configuration indique que Lilo utilise le
secteur de boot pprincipal (Master Boot Record) sur le
disque /dev/hda. 
(Pour plus d'information sur les differentes manieres
d'utiliser Lilo, et les interractions avec d'autres
systemes d'exploitation, voir le fichier user.tex 
de la documentation Lilo.)
.LP
Au demarrage, le chargeur va attendre 4 secondes (40 dixiemes
de seconde) pour une eventuelle pression sur SHIFT.

Si on ne presse pas SHIFT, l'image du premier noyau 
(/zImage-1.5.99, qui a probablement ete installe 5 minutes plus tot) 
sera chargee.

Si l'on presse SHIFT, Lilo demandera quelle image utiliser pour
demarrer. En pressant [TAB] ou ([?] sur les claviers US), la
liste des choix possibles sera affichee.

Il est alors possible de demarrer sur ce noyau flambant neuf ou
sur un noyau plus ancien, ou sur un noyau situe sur un
autre systeme de fichiers principal (juste au cas ou l'on vient
de faire une anerie suur le systeme racine habituel), ou meme
de demarrer un autre systeme d'exploitation.

Il peut y avoir jusqu'a 16 images differentes dans lilo.conf.

.LP
Comme on peut le voir ci\-dessus, un fichier de configuration
commence avec un certain nombre d'options globales (les 6
premieres lignes de l'exemple), puis viennent les options
pour chacune des images a gerer.

Lorsqu'une option est indiquee pour une image donnee, elle a
precedence sur la valeur de l'option globale correspondante.

.SH "OPTIONS GLOBALES"
Il existe plusieurs mots\-cles, les descriptions ci-dessous
sont extraites de user.tex (un peu abregees).
.TP
.BI "backup=" backup-file
Copier le secteur de boot original dans le fichier
.I backup-file
(qui peut egalement etre un peripherique, par exemple
.IR /dev/null )
a la place de
.IR /boot/boot.NNNN .
.TP
.BI "boot=" boot-device
indique le nom du peripherique (ex : une partition de disque dur) qui
contient le secteur de boot. Si ce mot\-cle est omis, le secteur de boot
lu (et eventuellement ecrit) est celui du peripherique actuellement
monte comme racine du systeme de fichiers.
.TP
.BI "compact"
Essaye de regrouper les lectures de secteurs adjacents en une seule
requete. Ceci reduit nettement le temps de chargement et la taille
du fichier de carte.
L'utilisation de `compact' est surtout recommandee lorsque l'on
boote depuis une disquette.
.TP
.BI "default=" name
Utiliser par defaut l'image indiquee. Si `default' est omis, la
premiere image du fichier de configuration est utilisee comme image
par defaut.
.TP
.BI "delay=" dsecs
indique la duree (en dixiemes de secondes) pendant laquel le chargeur
attendra avant de demarrer la premiere image. Ceci est utilise sur les
systemes qui bootent immediatement sur le disque dur apres avoir mis
le clavier en marche. Si `delay' est absent, ou si sa valeur est nulle,
le chargeur n'attend pas.
.TP
.BI "disk=" device-name
Precise les valeurs des parametres non\-standards du disque indique.
Voir la section "Geometrie du disque" dans user.tex pour plus de
details.
.TP
.BI "disktab=" disktab-file
Indique le nom d'un fichier de parametres pour le disque. Si cette
option est absente, le fichier
.I /etc/disktab
est recherche. Il vaut mieux eviter d'utiliser ces fonctionnalites.
.TP
.BI "fix-table"
Ceci permet a Lilo d'ajuster les adresses 3D (secteur/tete/cylindre)
de la table des partitions. 
Chaque partition possede une adresse 3D et une adresse lineaire pour
son premier et son dernier secteur.

Si la partition n'est pas alignee sur une frontiere de piste, et si
certains autres systemes d'exploitation (MS\-DOS, ou OS/2) utilisent
le meme disque, ils peuvent modifier l'adresse 3D.
Lilo ne peut installer son secteur de demarrage que sur des partitions
ou les deux types d'adressage correspondent.
Si l'option `fix-table' est indiquee, Lilo reajustera les
adresses 3D incorectes.

ATTENTION :
Ceci ne garantit pas que les autres systemes d'exploitation ne vont
pas essayer de modifier a nouveau l'adressage plus tard. Il est
egalement possible que ces corrections aient des effets de bords
inattendus.

La veritable correction a apporter consiste a repartitionner le
disque avec un utilitaire qui aligne les partitions sur les frontieres
de pistes.

De plus, avec certains disques (les gros disques EIDE avec une translation
d'adresses automatique), et sous certaines circonstances, il est
inevitable d'obtenir des conflits dans la table des partitions.
.TP
.BI "force-backup=" backup-file
Comme `backup' mais ecrase la sauvegarde precedente s'il y en a une.
.TP
.BI "ignore-table"
ne pas tenir compte des erreurs dans la table des partitions.
.TP
.BI "install=" boot-sector
Utiliser le fichier indique comme secteur de demarrage.
Si `install' est omis,
.I /boot/boot.b
sera utilise par defaut.
.TP
.BI "linear"
Cree des adresses de secteur lineaires plutot que des adresses 3D
(secteur/tete/cylindre). Les adresses lineaires sont traduites a
l'execution, et ne dependent pas de la geometrie du disque.

Notez que les disquettes de demarrage risquent de ne pas etre portables
d'une machine a l'autre si `linear' est utilise, car les services BIOS
pour determiner la geometrie du disque ne fonctionnent pas bien avec les
disquettes. Quand on utilise `linear' avec des gros disques,
.I /sbin/lilo
risque de generer des references a des zones de disque inacessibles
car les adresses 3D ne sont pas connues avant le boot.
.TP
.BI "lock"
Autorise l'enregistrement de lignes de commande au demarrage comme
un choix par defaut pour les redemarrages ulterieurs. De cette
facon, Lilo "verrouille" un choix jusqu'a ce qu'il soit ecrase
manuellement.
.TP
.BI "map=" map-file
Indique l'emplacement du fichier de carte des noyaux. Si `map' est
omis, le fichier
.I /boot/map
est utilise.
.TP
.BI "message=" message-file
indique l'emplacement d'un fichier contenant un message qui sera
affiche avant l'invite de demarrage. Aucun message n'est affiche
pendant l'attente de la touche SHIFT, apres avoir imprime "LILO ".
Dans ce message, le caractere FF (Ctrl-L) efface l'ecran.
La taille du message est limitee a 65535 octets. Le fichier carte
doit etre reconstruit si le message est modifie ou deplace.
.TP
.BI "nowarn"
Desactive les avertissements a propos de risques futurs.
.TP
.BI "optional"
Correspond a l'option `optional' specifique a une image, que l'on
applique alors a toutes les images (voir plus bas).
.TP
.BI "password=" password
Correspond a l'option `password' specifique a une image, que l'on
applique alors a toutes les images (voir plus bas).
.TP
.BI "prompt"
Affiche obligatoirement l'invite de demarrage, sans reclamer de
pression sur SHIFT. Un redemarrage intempestif (coupure electrique)
de la machine est impossible si `prompt' est indique, et 
pas `timeout'.
.TP
.BI "restricted"
Correspond a l'option `restricted' specifique a une image, que l'on
applique alors a toutes les images (voir plus bas).
.TP
.BI "serial=" parameters
Autorise la prise de controle par une ligne serie. Le port serie 
mentionne est initialise, et le chargeur accepte des instructions
a la fois depuis le clavier et depuis le port.

L'emission d'un `break' sur la prise serie est equivalente a la
pression sur SHIFT afin de reclamer l'attention du chargeur.
Toutes les images devraient etre protegees par mots de passe si 
l'acces au port serie est moins securise que l'acces au clavier
(par exemple a travers un modem).

La chaine de parametres a la syntaxe suivante :
.sp
.nf
    <port>[,<bps>[<parity>[<bits>]]]
.fi
.sp
<port>:  numero du port serie (0 correspond a COM1, alias /dev/ttyS0).
Les quatres ports (s'ils existent) peuvent etre utilises.
.sp
<bps>: vitesse du port serie. Les vitesses suivantes sont supportees :
110, 150, 300, 600, 1200, 2400, 4800 et 9600 bps (2400 bps par defaut).
.sp
<parity>: parite utilisee sur la ligne. Le chargeur ignore la parite
en entree, et elimine le 8ieme bit. Les lettres suivantes decrivent
la parite : n  aucune,  e  paire, o  impaire.
.sp
<bits>: nombre de bits par caracteres. Seuls les caracteres de 7 et
8 bits sont supportes. (par defaut 8 si parite n, 7 si parite e ou o).
.sp
Si `serial' est indique, la valeur de `delay' est automatiquement
portee a 20.
.sp
Exemple: serial=0,2400n8 initialise COM1 avec les parametres par defaut.
.TP
.BI "timeout=" dsecs
indique un delai (en dixieme de secondes) pour la saisie au clavier.
Si aucune touche n'est pressee apres ce delai la saisie est abandonnee.
Sur l'invite de connexion, l'image par defaut est lancee, sur la
saisie de mot de passe, l'action est annulee.
La valeur par defaut du timeout est infinie.
.TP
.BI "verbose=" level
Valide de nombreux rapports de progression. Plus le nombre est eleve,
plus Lilo sera bavard. Si \-v est de plus ajoute sur la ligne de
commande, le niveau sera augmente. Le niveau maximal de bavardage est 5.
.LP
En outre, des parametres de configuration du noyau
.BR append ", " ramdisk ", " read-only ", " read-write ", " root
et
.B vga
peuvent etre indiques dans la section des options globales. Ils sont
utilises par defaut a moins d'etre surcharges dans les sections de
configurations specifiques des images.

.SH "SECTIONS SPECIFIQUES AUX IMAGES"
Une section specifique a une image debute soit par une ligne
.sp
.nf
    \fBimage=\fP\fIpathname\fP
.fi
.sp
(qui indique un fichier ou un peripherique contenant l'image d'un
noyau Linux), soit par une ligne
.sp
.nf
    \fBother=\fP\fIpathname\fP
.fi
.sp
pour indiquer le demarrage d'un autre systeme d'exploitation.
.LP

Dans le premier cas, si la ligne \fBimage\fP demande le demarrage depuis
un peripherique, alors il faut egalement indiquer l'intervalle de
secteurs a utiliser. Ceci se fait ainsi :
.sp
.nf
         \fBrange=\fP\fIdebut\fP-\fIfin\fP
.fi
.sp

Dans le second cas (demarrer un autre systeme) il existe 3 options.
.TP
.BI "loader=" chain-loader
Ceci indique le chargeur a utiliser. Par defaut
.I /boot/chain.b
est utilise. Le chargeur doit etre precise si l'on demarre depuis un
peripherique autre que le premier disque dur ou disquette.
.TP
.BI "table=" device
Cette option specifie le peripherique qui contient la table de partitions.
Le chargeur ne transmettra pas les informations sur les partitions au
systeme a demarrer si cette variable est omise (certains systemes 
d'exploitation utilisent d'autres moyens pour determiner la partition
depuis laquelle ils demarrent, par exemple MS-DOS stocke habituellement
les informations geometriques dans son secteur de demarrage).
Notez que /sbin/lilo doit etre relance si une table de partitions referencee
dans une option `table' est modifiee.
.TP
.BI "unsafe"
ne pas toucher au secteur de demarrage lors de la creation de la carte.
Ceci desactive certains controles, y compris la verification de la table
des partitions.
Si le secteur de boot se trouve sur une disquette avec un format proprietaire,
l'utilisation de UNSAFE evite d'avoir a inserer un disque lisible dans
le lecteur durant l'installation de la carte.
Les options `unsafe' et `table' sont mutuellement exclusives.
.LP

Dans tous les cas les options suivantes s'appliquent :
.TP
.BI "label=" name
Le chargeur utilise le nom de fichier principal (sans le chemin
d'acces) de chaque image pour les identifier. On peut indiquer
ici un nom different qui sera utilise lors de l'invite de
connexion.

NDT : Lors de l'invite de demarrage, le clavier est au format
QWERTY, et vous avez probablement sous les yeux un clavier
AZERTY. Aussi evitez d'utiliser des noms d'images employant
les lettre A, Z, Q, W, et M. Ceci ne pose aucun probleme pour
des etiquettes comme LINUX, UNIX, et meme DOS, par contre
il vaut mieux eviter d'utiliser WIN (personnellement je
trouve OUIN plus marrant).
.TP
.BI "alias=" name
Un deuxieme nom peut etre utilise comme alias pour la meme image.
.TP
.BI "lock"
(voir au-dessus)
.TP
.BI "optional"
Omettre l'image si elle n'est pas presente lors de la creation de
la carte. Ceci est utile pour indiquer des noyaux de test qui
ne sont pas toujours presents.
.TP
.BI "password=" password
Proteger le chargement de l'image par un mot de passe.
.TP
.BI "restricted"
Ne demander un mot de passe que si l'on ajoute des parametres
sur la ligne de commande (par exemple `single' pour redemarrer
en mode mono\-utilisateur).
.LP

.SH "OPTIONS DU NOYAU"
Si l'image chargee est un noyau Linux, on peut lui passer des
parametres supplementaire sur la ligne de commande.
.TP
.BI "append=" string
Ajoute l'option indiquee sur la ligne de commande transmise au
noyau. Ceci est typiquement utilise pour indiquer des parametres
materiels qui ne peuvent pas etre auto-detectes, ou pour lesquels
l'auto-detection peut etre dangereuse. Par exemple :
.sp
.nf
     append = "hd=64,32,202"
.fi
.sp
.TP
.BI "literal=" string
Comme `append', mais elimine de surcroit toutes les autres options
(par ex : l'emplacement du peripherique racine). Comme des options
vitales peuvent etre supprimees malencontreusement avec `literal',
celle\-ci ne peut pas apparaitre dans les options globales.
.TP
.BI "ramdisk=" size
Indique la taille d'un disque virtuel optionnel. Une valeur nulle
empeche la creation du disque RAM. Si cette variable est omise,
la taille de disque virtuel indiquee dans la configuration de
l'image du noyau est utilisee.
.TP
.BI "read-only"
Ceci indique que le systeme de fichiers racine doit etre monte en
lecture seule. Typiquement le demarrage du noyau remontera ce
systeme en lecture/ecriture plus tard (apres l'avoir verifie).
.TP
.BI "read-write"
Ceci indique que le systeme de fichiers racine doit etre monte en
lecture/ecriture.
.TP
.BI "root=" root\-device
Precise le peripherique a monter en tant que racine du systeme de
fichier. Si le mot\-cle
.B current
est utilise en guise de
.I root\-device
la racine du systeme actuel est utilisee. Si la racine a ete 
changee avec l'option \-r, le peripherique correspondant est utilise.
Si la variable `root' est omise, le peripherique indique dans l'image
du noyau est utilise.
(Il est positionne au mmoment de la compilation par la variable ROOT_DEV
dans le fichier Makefile, et peut etre change ulterieurement avec le
programme
.IR rdev (8)).
.TP
.BI "vga=" mode
Ceci precise le mode texte VGA a utiliser pendant le demarrage. Les
valeurs suivantes sont autorisees (pas de difference majuscule/minuscule) :
.sp
.BR normal :
Mode texte 80x25 normal.
.sp
.BR extended " (ou " ext ):
Mode texte 80x50.
.sp
.BR ask :
Arreter et demander a l'utilisateur (lors du demarrage).
.sp
<number>:  Utiliser le mode texte correspondant. Une liste des
modes disponibles peut etre obtenue en bootant avec
.I vga=ask  
et en pressant [Enter]. 
.sp
Si cette variable est omise, le mode VGA declare dans l'image du noyau
est utilise. (Le mode est indique a la compilation du noyau dans la
variable SVGA_MODE du fichier Makefile, et peut etre change ulterieurement
avec le programme
.IR rdev (8)).
.SH "VOIR AUSSI"
lilo(8), rdev(8).
.br
La distribution Lilo est accompagne d'une documentation tres complete, dont
la presente page n'est qu'un extrait.
