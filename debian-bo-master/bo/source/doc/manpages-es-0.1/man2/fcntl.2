.\" Hey Emacs! This file is -*- nroff -*- source.
.\"
.\" This manpage is Copyright (C) 1992 Drew Eckhardt;
.\"                               1993 Michael Haardt, Ian Jackson.
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" Modified Sat Jul 24 13:39:26 1993 by Rik Faith (faith@cs.unc.edu)
.\" Translated 22 Dec 1995 Miguel A. Sepulveda (miguel@typhoon.harvard.edu)
.\" Modified 1 Jul 1996 Miguel A. Sepulveda (angel@vivaldi.princeton.edu)
.TH FCNTL 2 "1 Julio 1996" Linux "Manual del Programador"
.SH NOMBRE
fcntl \- manipula el descriptor de fichero
.SH SINOPSIS
.nf
.B #include <unistd.h>
.B #include <fcntl.h>
.sp
.BI "int fcntl(int " fd ", int " cmd );
.BI "int fcntl(int " fd ", int " cmd ", long " arg );
.fi
.SH DESCRIPCIÓN
.B fcntl
realiza una de las diversas operaciones miscelaneas en
.IR fd .
La operación en cuestión está determinada mediante
.IR cmd :
.TP 0.9i
F_DUPFD
Hace que 
.I arg
sea una copia de
.IR fd ,
es necesario cerrar 
.I fd
en primer lugar.
.sp
El mismo resultado se puede obtener fácilmente usando        
.BR dup2 .
.sp
Los descriptores antiguo y nuevo pueden usarse indistintamente. Ambos
comparten candados (locks), punteros de posición de ficheros 
(file position pointers) y banderas (flags); por ejemplo,
si la posición del fichero se modifica usando
.B lseek
en uno de los descriptores, la posición del otro resulta modificada   
simultaneamente.
.sp
Sin embargo, los dos descriptores no comparten la bandera close-on-exec
"cerrar-en-ejecución".
.sp
En caso de éxito, se regresa un nuevo descriptor.
.TP
F_GETFD
Lee la bandera close-on-exec. Si el bit de bajo-orden es 0, el fichero 
permanecerá abierto durante
.BR exec ,
en caso contrario se cerrará el fichero.
.TP
F_SETFD
Asigna el valor de la bandera close-on-exec al valor especificado por 
.I arg
(solamente se usa el bit menos significativo).

.TP
F_GETFL
Lee las banderas del descriptor (todas las banderas, según 
asignadas por
.BR open (2)
serán regresadas).
.TP
F_SETFL
Asignar las banderas del descriptor al valor asignado por
.IR arg .
Sólo
.BR O_APPEND " y  " O_NONBLOCK
pueden asignarse.
.sp
Las banderas se comparten entre copias (hechas con
.B dup
etc.) del mismo descriptor de fichero.
.sp
Las banderas y su semántica están descritas en 
.BR open (2).
.TP
F_GETLK, F_SETLK, and F_SETLKW
Dirige candados de ficheros discrecionarios (discretionary file locks).
.TP
F_GETOWN
Obtiene el ID del proceso (o grupo de procesos) del dueño de un
zócalo (socket).
.sp
Grupos de procesos regresan como valores negativos.
.TP
F_SETOWN
Asigna el proceso o grupo de procesos propietarios de un interruptor.
.sp
Para estas directivas, "propiedad"
significa recivir una señal
.B SIGIO
ó
.B SIGURG
.sp
Grupos de procesos regresan como valores negativos.
.SH "VALOR REGRESADO"
El valor regresado depende de la operación:
.TP 0.9i
F_DUPFD
El nuevo descriptor.
.TP
F_GETFD
Valor de la bandera.
.TP
F_GETFL
Valor de las banderas.
.TP
F_GETOWN
Valor del propietario del descriptor.
.PP
En caso de error el valor regresado es \-1, y 
.I errno
es asignado apropiadamente.
.SH ERRORES
.TP 0.9i
.B EBADF
.I fs
no es un descriptor de fichero abierto.
.TP
.B EINVAL
Para
.BR F_DUPFD ,
.I arg
es negativo o mayor que el valor máximo permitido.          
.TP
.B EINVAL
Para
.BR F_DUPFD ,
el proceso ya tiene el número máximo de descriptores de ficheros abiertos.
.SH NOTAS
Los errores regresados por
.B dup2
son distintos de aquellos dados por 
.BR F_DUPFD .
.SH "CONFORMA CON"
SVID, AT&T, POSIX, X/OPEN, BSD 4.3
.SH "VÉASE"
.BR open "(2), "
.BR F_DUPFD "(2), " F_GETFD "(2), " F_GETFL "(2), " F_GETLK "(2), "
.BR socket "(2). "
