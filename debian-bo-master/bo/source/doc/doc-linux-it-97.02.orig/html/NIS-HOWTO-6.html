<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Draft//EN">
<HTML>
<HEAD>
<TITLE>Linux NIS(YP)/NIS+/NYS HOWTO: Di cosa avete bisogno per configurare NYS?</TITLE>
</HEAD>
<BODY>
<A HREF="NIS-HOWTO-5.html">Precedente</A>
<A HREF="NIS-HOWTO-7.html">Successivo</A>
<A HREF="NIS-HOWTO.html#toc6">Indice</A>
<HR>
<H2><A NAME="s6">6. Di cosa avete bisogno per configurare NYS?</A></H2>

<H2><A NAME="ss6.1">6.1 Determinare se siete Server, Slave o Client.</A></H2>

<P>
<P>Per rispondere a questa domanda tenete in considerazione questi due punti:
<P>
<UL>
<LI> La vostra macchina fa parte di una rete che ha gi&agrave; dei NIS servers</LI>
<LI> Per il momento non esiste nessun NIS server nella rete.</LI>
</UL>
<P>Nel primo caso avete due possibilit&agrave;:
<P>
<UL>
<LI> O eseguite il ricollegamento di tutti i programmi client e dei demoni
con il codice della libreria NYS <CODE>libnsl.so</CODE> (o staticamente con la
libreria <CODE>libnsl.a</CODE>). Questo significa che dovrete aggiungere la
linea:

<BLOCKQUOTE><CODE>
<PRE>
            LIBS=-lnsl
        
</PRE>
</CODE></BLOCKQUOTE>


al vostro Makefile il che significa che volete collegare il programma
alla libreria dei servizi di rete. Fondamentalmente tutti i demoni di
rete ed i programmi di ``login'' necessitano di essere ricompilati.
</LI>
<LI> Oppure potrete ricompilare la libreria standard C libc per includervi
le funzioni della libreria client NYS, e successivamente ricollegare
tutti i programmi collegati staticamente (quelli collegati
dinamicamente vedono automaticamente la nuova versione della libreria
libc). Vedi la sezione 6.5 per ulteriori informazioni circa questa
opzione.</LI>
</UL>
<P>Similarmente, come nel caso del NIS tradizionale, se non avete un server
NIS, allora avrete bisogno di un programma server NIS (normalmente ypserv) e
dovete assegnare una delle macchine della rete come server NIS master. E
nuovamente, dovrete, come minimo, installare un server slave.
<P>
<P>

<H2><A NAME="ss6.2">6.2 Il Software</A></H2>

<P>
<P>Dovrete procurarvi e compilare la libreria con i servizi NYS libnsl.so. Se
non avete i ``DLL tools'' dovrete procurarvi le librerie (condivise,
statiche e sorgenti) dallo stesso sito di cui sotto. Nota, tuttavia, che la
versione precompilata potrebbe essere (e probabilmente lo &egrave;) pi&ugrave; vecchia
dell'ultima release formato sorgente.
<P>Le librerie NYS (sogenti e compilati) si trovano a:
<P>
<BLOCKQUOTE><CODE>
<PRE>
  Site                Directory                    File Name

  ftp.lysator.liu.se  /pub/NYS/libs                nys-0.27.4.tar.gz
  ftp.lysator.liu.se  /pub/NYS/binaries/lib        libnsl.so.1.0.a26

  ftp.funet.fi        /pub/Linux/BETA/NYS/libs     nys-0.27.?.tar.gz
</PRE>
</CODE></BLOCKQUOTE>
<P>I programmi ``login'' e ``su'' precompilati si trovano a:
<P>
<BLOCKQUOTE><CODE>
<PRE>
  Site                Directory                    File Name

  ftp.lysator.liu.se  /pub/NYS/binaries/bin        login
  ftp.lysator.liu.se  /pub/NYS/binaries/bin        su

  ftp.funet.fi        /pub/Linux/BETA/NYS/bin      login
  ftp.funet.fi        /pub/Linux/BETA/NYS/bin      su
</PRE>
</CODE></BLOCKQUOTE>
<P>Allo stesso modo, file di esempio di configurazione possono essere trovati a:
<P>
<BLOCKQUOTE><CODE>
<PRE>
  Site                Directory                   File Name

  ftp.lysator.liu.se  /pub/NYS/binaries/etc       *conf
  ftp.funet.fi        /pub/Linux/BETA/NYS/etc     *conf
</PRE>
</CODE></BLOCKQUOTE>
<P>Per la compilazione delle librerie nsl, seguite le istruzioni provviste con
il software. Se volete compilare le librerie condivise DLL dovete avere
installato il programma ``DLL tools'' nella directory standard (/usr/dll). I
``DLL tools'' (il pacchetto tools-2.11.tar.gz o successivo) si possono
trovare su diversi siti ftp.
<P>
<P>

<H2><A NAME="ss6.3">6.3 Configurare un "NYS Client" usando NYS</A></H2>

<P>
<P>A differenza del NIS tradizionale, non ci sono settaggi per il client NIS.
Tutto ci&ograve; che serve &egrave; che il file di configurazione NIS (/etc/yp.conf) punti
al(ai) server corretto(i) per ottenere le sue informazioni. Perci&ograve;, il file
di configurazione dei ``Name Services Switch'' (/etc/nsswitch.conf) deve
essere installato correttamente.
<P>Consultate gli esempi provvisti con il sorgente.
<P>
<P>

<H2><A NAME="ss6.4">6.4 Il file nsswitch.conf</A></H2>

<P>
<P>Il file dei ``Network Services switch'' /etc/nsswitch.conf determina
l'ordine dei controlli eseguiti quando viene richiesto un certo tipo di
informazione, come nel file /etc/host.conf che determina il modo in cui
vengono controllati i nomi delle macchine. Di nuovo, controllate il file di
esempio incluso nella distribuzione del sorgente. Per esempio, la linea
<P>
<BLOCKQUOTE><CODE>
<PRE>
    hosts: files nis dns
</PRE>
</CODE></BLOCKQUOTE>
<P>specifica che la funzione di controllo dei nomi di macchina deve prima
controllare il file /etc/hosts, seguita da un controllo del NIS ed alla fine
attraverso i "domain name service" (/etc/resolv.conf e named), a quel punto
se non c'&egrave; nessuna risposta verr&agrave; mostrata una stringa di errore.
<P>
<P>

<H2><A NAME="ss6.5">6.5 Rendere disponibili a tutti i binari le librerie NYS</A></H2>

<P>
<P>Invece di ricollegare tutti i binari con la libreria NYS (libnsl.so), una
soluzione pulita &egrave; stata raggiunta provvedendo all'utente la possibilit&agrave; di
costruire un NYS consapevole della libc esistente. Questo preveder&agrave; di
ricompilare una nuova libc e rimpiazzare le esistenti /lib/libc.so.x.y.z per
tutti i programmi (compilati non staticamente) al fine di renderli
consapevoli della presenza del NYS.
<P>Questa fusione vi d&agrave; il vantaggio sulla implementazione del NIS tradizionale
nella libc di linux, nel senso che vi permette un supporto trasparente alle
``shadow passwords'' (tramite il file /etc/nisswitch.conf).
<P>Seguite i seguenti passi per ricostruire una libreria libc con il supporto
NYS.
<P>
<UL>
<LI> Controllate di avere installato l'ultima versione dei ``DLL tools''. 
Consultate le GCC-FAQ per maggiori informazioni su dove reperirli.
</LI>
<LI> Procuratevi gli ultimi sorgenti delle libc. (controllate le GCC-FAQ)
</LI>
<LI> Procuratevi gli ultimi sorgenti nys da:

<BLOCKQUOTE><CODE>
<PRE>
          ftp.lysator.liu.se:/pub/NYS/libs
      
</PRE>
</CODE></BLOCKQUOTE>


e scompattateli sotto questa directory dei sorgenti ``libc-linux''. La
distribuzione corrente del NYS &egrave; ``nys-0.27.4.tar.gz''.
</LI>
<LI> Eseguite ./configure come prima e rispondete ``n'' alla domanda:

<BLOCKQUOTE><CODE>
<PRE>
          Values correct (y/n) [y] ?
      
</PRE>
</CODE></BLOCKQUOTE>


Poi proseguite attraverso le altre domande e l'ultima sar&agrave; diventata:

<BLOCKQUOTE><CODE>
<PRE>
          Build a NYS libc from nys-0.27 (y default) ?
      
</PRE>
</CODE></BLOCKQUOTE>


rispondete ``y'' a questa.
</LI>
<LI> Poi eseguite il comando:

<BLOCKQUOTE><CODE>
<PRE>
          % make
      
</PRE>
</CODE></BLOCKQUOTE>

</LI>
</UL>
<P>La libreria generata dopo la compilazione avr&agrave; un nome tipo
<P>
<BLOCKQUOTE><CODE>
<PRE>
    libc.so.4.5.26
</PRE>
</CODE></BLOCKQUOTE>
<P>e sar&agrave; inserita nella directory jump/libc-nys. Per installarla il nostro
consiglio &egrave; di copiarla in /lib con un nome lessicograficamente maggiore del
numero di versione. Semplicemente aggiungendo una lettera ``a'' si risolve
l'arcano. Per esempio:
<P>
<BLOCKQUOTE><CODE>
<PRE>
    % cp jump/libc-nys/libc.so.4.5.26 /lib/libc.so.4.5.26a
</PRE>
</CODE></BLOCKQUOTE>
<P>Alternativamente, aggiungete ``nys'' per poterla identificare facilmente.
Adesso eseguite il comando
<P>
<BLOCKQUOTE><CODE>
<PRE>
    % ldconfig
</PRE>
</CODE></BLOCKQUOTE>
<P>che azzera la cache per permettervi di usare la nuova libreria. La strategia
del collegamento dinamico pu&ograve; essere esaminata con il comando ``ldconfig
-p''.
<P>Questo &egrave; quanto. Tutti i vostri programmi, adesso, sapranno che c'&egrave; il NYS.
Ricordate che normalmente il programma ``login'' &egrave; compilatao staticamente e
perci&ograve; non pu&ograve; accedere alle funzioni del NYS tramite la nuova libc con il
supporto del NYS. Dovrete quindi ricompilare il programma ``login'' senza il
flag -static, oppure collegarlo staticamente alla libreria libnsl.a.
<P>
<P>

<HR>
<A HREF="NIS-HOWTO-5.html">Precedente</A>
<A HREF="NIS-HOWTO-7.html">Successivo</A>
<A HREF="NIS-HOWTO.html#toc6">Indice</A>
</BODY>
</HTML>
