<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Draft//EN">
<HTML>
<HEAD>
<TITLE>Linux NIS(YP)/NIS+/NYS HOWTO: Cosa serve per installare il NIS?</TITLE>
</HEAD>
<BODY>
<A HREF="NIS-HOWTO-4.html">Precedente</A>
<A HREF="NIS-HOWTO-6.html">Successivo</A>
<A HREF="NIS-HOWTO.html#toc5">Indice</A>
<HR>
<H2><A NAME="s5">5. Cosa serve per installare il NIS?</A></H2>

<P>
<P>
<P>
<H2><A NAME="ss5.1">5.1 Il programma ``RPC Portmapper''</A></H2>

<P>
<P>Per permettere al software, di cui parleremo pi&ugrave; avanti, di funzionare,
dovrete eseguire il programma /usr/sbin/rpc.portmap. Alcune distribuzioni di
Linux hanno gi&agrave; installato il codice in /etc/rc.d/rc.inet2 per far partire
questo demone. Tutto ci&ograve; che dovrete fare sar&agrave; di togliere il commento ed
eseguire il reboot della macchina Linux per attivarlo.
<P>L'RPC portmapper (portmap(8c)) &egrave; un software che converte i numeri dei
programmi RPC in protocolli TCP/IP (o UDP/IP). Deve essere attivo per
eseguire chiamate RPC (che &egrave; quello che fa il client NIS) al server RPC
(tipo un server NIS) su quella macchina. Quando il server RPC parte,
comunica al portmap quale numero di porta lo sta ascoltando, e quale numero
di programma RPC si prepara a servire. Quando un client vuole fare una
chiamata RPC ad un determinato numero di programma, contatter&agrave; prima il
portmap sulla macchina server per determinare il numero di porta attraverso
la quale spedire i pacchetti RPC.
<P>Normalmente, i server  RPC standard vengono avviati da inetd(8C), cosicch&eacute;
il portmap deve essere attivato prima di "inetd".
<P>
<P>

<H2><A NAME="ss5.2">5.2 Determiniamo se siete un Server, uno Slave o un Client.</A></H2>

<P>
<P>Per rispondere a questa domanda ci sono due possibilit&agrave;:
<P>
<OL>
<LI> La vostra macchina far&agrave; parte di una rete dotata di server NIS</LI>
<LI> Per il momento non esiste nessun server NIS nella rete.</LI>
</OL>
<P>Nel primo caso, vi servono solo i programmi client (ypbind, ypwhich, ypcat,
yppoll, ypmatch). Il programma pi&ugrave; importante &egrave; ypbind. Questo programma
deve essere sempre attivo, deve sempre apparire nella lista dei processi. &Egrave;
un cosiddetto ``processo demone'' e deve essere inizializzato dai file di
avvio del sistema (esempio /etc/rc.local). Dal momento in cui ypbind &egrave;
attivo, il vostro sistema &egrave; diventato un client NIS.
<P>Nel secondo caso, se non esistono server NIS, avete bisogno di un programma
server NIS (normalmente ypserv). La sezione&nbsp6 descrive come configurare
un NIS server sulla vostra macchina Linux usando l'implementazione
``ypserv'' di Peter Eriksson (<CODE>&lt;peter@ifm.liu.se></CODE>). Notate che
dalla versione 0.14 questa implementazione supporta il concetto di
master-slave discusso nella sezione&nbsp3.
<P>C'&egrave;, per&ograve;, un altro NIS server free a disposizione, chiamato ``yps'',
scritto da Tobias Reber in Germania che supporta il concetto di
master-slave, ma ha altre limitazioni.
<P>
<P>

<H2><A NAME="ss5.3">5.3 Il Software</A></H2>

<P>
<P>La libreria di sistema ``/usr/lib/libc.a'' (version 4.4.2 e successive) o le
librerie condivise ``/usr/lib/libc.sa'' e le loro relative DLL contengono le
necessarie chiamate di sistema per poter compilare con successo il software
sia per il client che per il server NIS.
<P>Alcuni utenti hanno riportato che il NIS funziona solo con
``/usr/lib/libc.a'' versione 4.5.21 e successive quindi se volete andare sul
sicuro non usate vecchie libc. Il software NIS client si trova su:
<P>
<BLOCKQUOTE><CODE>
<PRE>
  Site                  Directory                        File Name
  
  ftp.uni-paderborn.de  /linux/local/yp                  yp-clients-2.2.tar.gz
  ftp.funet.fi          /pub/Linux/BETA/NYS/clients      yp-clients-?.?.tar.gz
  ftp.lysator.liu.se    /pub/NYS/clients                 yp-clients-?.?.tar.gz
  sunsite.unc.edu       /pub/Linux/system/Network/admin  yp-clients-2.2.tar.gz
</PRE>
</CODE></BLOCKQUOTE>
<P>Dal momento che avrete a disposizione il software, seguite le istruzioni
incluse nello stesso.
<P>
<P>

<H2><A NAME="ss5.4">5.4 Configurare un NIS Client usando il NIS tradizionale</A></H2>

<P>
<P>Diamo per scontato il fatto che avete compilato il software con successo
siete pronti ad installarlo. Un posto consigliabile per il demone ypbind &egrave;
la directory /usr/sbin.
<P>Chiaramente, eseguite l'installazione come utente root. Gli altri binari
(ypwhich, ypcat, yppoll, ypmatch) devono essere posti in una directory
accessibile da tutti gli utenti, per esempio /usr/etc or /usr/local/bin.
Sar&agrave; buona cosa testare ypbind prima di inserirlo nel file
/etc/rc.d/rc.inet2.
<P>Per testare ypbind:
<P>
<UL>
<LI> Assicuratevi di aver settato il vostro domain name. Se non &egrave; settato
eseguite il comando:

<BLOCKQUOTE><CODE>
<PRE>
            /bin/domainname-yp nis.domain
        
</PRE>
</CODE></BLOCKQUOTE>


dove <CODE>nis.domain</CODE> pu&ograve; essere qualsiasi cosa, _NON_ normalmente
associato con il nome del dominio della vostra macchina! La ragione di
ci&ograve; consiste nel rendere la vita difficile ad un cracker esterno, e
impedirgli di appropriarsi del database delle password dei vostri
server NIS.  Se non conoscete quale sia il nome del dominio NIS della
vostra rete, contattate il vostro amministratore di sistema o di rete.
</LI>
<LI> Avviate ``/usr/sbin/rpc.portmap'' a meno che non sia gi&agrave; attivo.
</LI>
<LI> Create la directory ``/var/yp'' se non esiste.
</LI>
<LI> Eseguite ``/usr/sbin/ypbind''
</LI>
<LI> Usate il comando ``rpcinfo -p localhost'' per controllare se ypbind
riesce a registrare i suoi servizi con il portmapper. rpcinfo dovrebbe
produrre un messaggio del genere:

<BLOCKQUOTE><CODE>
<PRE>
       program vers proto   port
        100000    2   tcp    111  portmapper
        100000    2   udp    111  portmapper
        100007    2   udp    637  ypbind
        100007    2   tcp    639  ypbind
        300019    1   udp    660
      
</PRE>
</CODE></BLOCKQUOTE>

</LI>
<LI> Inoltre dovrete eseguire ``rpcinfo -u localhost ypbind''. Questo
comando produrr&agrave; un risultato del genere:

<BLOCKQUOTE><CODE>
<PRE>
        program 100007 version 2 ready and waiting
      
</PRE>
</CODE></BLOCKQUOTE>
</LI>
</UL>
<P>Infine, non dimenticate che per la ricerca delle macchine dovete aggiungere
``nis'' alla riga di precedenze di ricerca nel vostro file /etc/host.conf.
Consultate la manpage ``resolv+.8'' per ulteriori dettagli.
<P>A questo punto dovete essere in grado di usare i programmi client NIS tipo
ypcat, ecc... Per esempio, ``ypcat passwd'' vi fornir&agrave; per intero il
database NIS delle password.
<P>IMPORTANTE: Se saltate le procedure di test assicuratevi di aver settato il
nome di dominio e creato la directory:
<P>
<BLOCKQUOTE><CODE>
<PRE>
    /var/yp
</PRE>
</CODE></BLOCKQUOTE>
<P>Questa directory DEVE esistere per permettere a ypbind di partire
correttamente.
<P>Se il test ha funzionato vorrete cambiare i files /etc/rc.d/rc.M e
/etc/rc.d/rc.inet2 del vostro sistema onde permettere a ypbind di essere
inizializzato all'avvio ed al vostro sistema di diventare un NIS client.
Modificate il file /etc/rc.d/rc.M e controllate i comandi che settano il
nome del dominio. Cambiate il nome del dominio nel nome del vostro dominio.
Poi, modificate il file /etc/rc.d/rc.inet2, togliete il commento alle linee
che inizializzano il demone rpc.portmap, e aggiungete le linee seguenti
subito dopo quelle che fanno partire l'rpc.portmap:
<P>
<BLOCKQUOTE><CODE>
<PRE>
    #
    # Start the ypbind daemon
    #
    if [ -f ${NET}/ypbind -a -d /var/yp ]; then
        echo -n &quot; ypbind&quot;
        ${NET}/ypbind
    fi
</PRE>
</CODE></BLOCKQUOTE>
<P>A differenza dell'implementazione del NIS su Sun non vi servir&agrave; editare i
file /etc/passwd ed /etc/group per dotarvi delle funzionalit&agrave; del NIS.
L'implementazione Sun prevede una linea "+:*:0:0:::" nel file /etc/passwd ed
una linea "+:*:0:" in /etc/group per comunicare al NIS di cercare i database
NIS password e NIS group.
<P>IMPORTANTE: Noterete che il comando finger riporta "no such user" se non
aggiungete la linea "+:*:0:0:::" al file /etc/passwd. Inserendo la linea
"+:*:0:0:::" nel file /etc/passwd correggerete il finger.
<P>Bene, questo &egrave; quanto. Eseguite il reboot e osservate i messaggi per vedere
se ypbind &egrave; partito.
<P>IMPORTANTE: Noterete che la funzionalit&agrave; di netgroup viene implementata a
partire dalla libreria libc 4.5.26. Netgroup permette il controllo d'accesso
per tutte le macchine e per tutti gli utenti nel dominio NIS, che
richiederanno una voce del tipo:
<P>
<BLOCKQUOTE><CODE>
<PRE>
    +@this_machine_users
</PRE>
</CODE></BLOCKQUOTE>
<P>nel file /etc/passwd. Ma se avete una versione libc antecedente la 4.5.26,
qualsiasi utente registrato nel database NIS delle password pu&ograve; accedere
alla vostra macchina Linux se avete attivato ``ypbind''.
<P>
<P>

<HR>
<A HREF="NIS-HOWTO-4.html">Precedente</A>
<A HREF="NIS-HOWTO-6.html">Successivo</A>
<A HREF="NIS-HOWTO.html#toc5">Indice</A>
</BODY>
</HTML>
