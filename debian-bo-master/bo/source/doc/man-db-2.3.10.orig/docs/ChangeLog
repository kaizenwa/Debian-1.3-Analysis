Thu Jul 13 11:29:32 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3.10

	* src/apropos.c: fix for #undef REGEX regarding int regex

	* src/lexgrog.l: default to new version.

	* src/README.lexgrog: new.

	* configure.in: all echo's through MAN_ECHO() for --quiet.

	* various: apply patch from Carl Edman (cedman@princeton.edu),
	port to NeXTstep and misc small fixes.

Fri Jun 16 11:12:08 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3.9

Wed Jun 14 17:08:41 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/man.c (make_display_command): fix command when ascii==1

	* src/man.c (display): don't return 1 on skip if local_man_file==1

	* man/Makefile.in: force make to resolve the program name strings
	(which are sed commands) once only.

	* configure.in: don't exec pager (too many side effects)

Sun Jun  4 13:51:22 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3.8

	* various: apply patch from CERN to allow globbed support for
	HPUX, OSF and SOLARIS system manual page hierarchies.

	* GNUmakefile.in: add hook for `make check'

Mon May 29 18:57:24 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/whatis.c (main): if $POSIXLY_CORRECT is in effect, 
	default to case-less extended regex searches for apropos 
	as specified by POSIX 1

	* man/man1/apropos.man1: document above change.

	* src/whatis.c (apropos, parse_name): ensure case-less
	matching on manual page name aswell as it's whatis for apropos.

	* all manual pages: replace instances of program with %program%
	and arrange to do a sed replacement with the actual name of the
	program, chosen by the installer.

	* zsoelim/zsoelim.l: fix recursion detector.

	* src/lexgrog.l (newline_found): new.

Mon May 22 20:07:17 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* nls/de_DE.88591/*.m: from Lars Fenneberg (li@gimli.comlink.de)

	* src/Makefile, libdb/Makefile: fix -DNLS

	* src/man.c (LESS_PROMPT): Make " Manual page" a translatable 
	message.

	* man/de_DE.ISO_8859-1: rename as man/de_DE.88591
	
	* nls/THANKS, man/THANKS: new.
	
	* src/whatis.c: If $POSIXLY_CORRECT, force apropos to do extended 
	regex matching.

Sat May 20 12:27:47 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/man.c: if -f or -k, simply execv() the program, passing
	the entire argv[] to it.

	* man/man1/man.man1: document change.

	* src/whatis.c: ignore -f, --whatis, -k and --apropos

Sat May 13 18:10:50 BST 1995  Markus Armbruster

	* Version: 2.3.7

	* lib/cleanup.c (pop_all_cleanups): new
	* src/man.c, src/security.c: use pop_all_cleanups() in children.

	* general: use fork() instead of vfork() in situations where
	vfork() could cause problems.

Tue May  9 23:30:58 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* manual pages: aesthetic/grammer changes.

	* flex files: process with flex-2.5.2

Mon May  8 11:15:07 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* include/manconfig.h.in: #define some exit codes.
	* all sources: use the codes.
	* English manual pages: add EXIT STATUS section where
	appropriate

	* src/man.c (make_display_command): back out execing the pager
	as PAGER does not have to be a simple program name.

	* configure.in: prepend "exec " to the default pager.

	* src/mandb.c: fix stupid bug where global databases remain
	owned by the creator in all circumstances. Clean up.

	* src/straycats.c, src/check_mandirs.c: homogenized and
	re-worded messages emitted by mandb.
 
Mon May  8 11:15:07 BST 1995  Markus Armbruster

	* lib/cleanup.c, lib/cleanup.h: new functions.  Install
	sighandler, initialise and operate a stack of cleanup funcs
	callable on exit().

	* src/mandb.c, src/man.c: modify to use cleanup functions.

Tue Apr 25 20:21:51 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3.6

	* src/whatis.c: new, replaced with edited version from 2.4 alpha 
	source tree. Apropos now does _real_ word matches.

	* man/man1/apropos.man1: remove description of option -e.

Mon Apr 24 17:26:54 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/man.c (get_section_list): Ignore empty $MANSECT.
	* src/man.c (main): if (!*pager) pager = CAT;

	* libdb/db_storage.h, include/manconfig.h.in, src/check_mandirs.c,
	  src/straycats.c: small modifications to fix broken
	FAVOUR_STRAYCATS behaviour and properly handle situation when 
	STRAYCAT and WHATIS_CAT share namespace. Move definition of
	FAVOUR_STRAYCATS to include/manconfig.h.in. From Zoltan.

	* zsoelim/zsoelim.c: exit 1 on command line file open failure.
	
	* src/man.c (man_getopt): consolidate incompatible option parsing.
	* src/man.c (usage): update wrt. option parsing.

	* src/man.c (display): only prompt/attempt display if found==1.

	* src/man.c (make_display_command): exec the pager.
 
Fri Apr 21 15:16:59 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3.5 (public release)

	* src/whatis.c: fix a couple of problems caused by whatis/apropos
	split.

	* configure.in: remove determination of viable gencat program,
	always use our own.

Wed Apr 19 09:53:27 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* GNUmakefile.in: renamed Makefile to differentiate between
	GNU make and others.

	* configure.in: create bogus ./makefile to catch non GNU make
	programs.

Mon Apr 17 11:06:32 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3.4

	* src/man.c (format_display_and_save): don't save cat if 
	formatting process fails and/or produces nothing.

Sat Apr  8 18:02:52 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/mandb.c: change #ifdef SECURE_MAN_UID to 
	#if defined(SECURE_MAN_UID) && defined(MAN_DB_UPDATES) as the 
	databases should be owned by their creators if man is not
	responsible for updating them.

	* src/man.c: minor changes regarding MAN_DB_UPDATES

	* include/manconfig.h.in: update CATMODE and DBMODE w.r.t.
	recent MAN_DB_UPDATES/MAN_CATS definitions.

	* src/mandb.c: changes to operation. Work on a temporary copy of 
	the database, then rename() to actual database. Catch SIGINT,
	SIGTERM and remove the temp copy if necessary.

	* src/compression.c (decompress): kill(getpid(), SIGINT) instead of 
	exit(0) if child (decompressing man page) fails. 

	* src/straycats.c (check_for_stray): kill(getpid(), SIGINT) instead of
	exit(0) if child (decompressing cat page) fails.

	* libdb/db_lookup.c (make_content): ndbm limit is 4k not 1k.

Mon Apr  3 20:52:06 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* docs/NEWS: new

	* README: more Linux-system information.

	* configure.in, acconfig.h: #define NDEBUG if !--enable-debug

	* include/Defines.in: comment out @LEXLIB@, not required in link
	  stage.

Sun Apr  2 17:42:02 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3.3

	* README: add sections referring to default preprocessors and
	system specific notes. 

	* xcat/xcat.l, zsoelim,zsoelim.l, src/lexgrog.l: process with
	flex-2.5.1
 
Fri Mar 31 17:12:44 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/whatis.c (display): add free(string)

	* src/whatis.c, src/Makefile.in: produce separate object files for
	apropos and whatis so that the programs know which one they are
	regardless of actual program-filename.

	* All Makefile.in, include/Defines.in: append CPPFLAGS supplied to
	./configure or make to the standard $(CPPFLAGS) variable. 
	Allows configuring with unusual #include directories, eg. 
	CPPFLAGS=-I/usr/src/gdbm LDFLAGS=-L/usr/src/gdbm ./configure

	* configure.in (--with-db=LIBRARY): override the default database
	interface library on systems having a choice. Options={db,gdbm,ndbm}
	
	* configure.in: Re: sec 5.6 of the autoconf manual, replace 
	(if test a=b -o a=c) with 
	(if test a=b || test a=c) 

Tue Mar 28 16:44:46 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.3b2

	* lib/flock.c, lib/flock.h: New. flock() wrapper to fcntl() for
	systems that lack flock().

	* xcat/xcat.l: #include "manconfig.h". For systems not supporting
	__inline__

	* include/Defines.in (%.d : %.c): modify rule to account for C
	compilers other than gcc

	* All Makefiles.in (cd $dir && $(MAKE)): change to $(MAKE) -C $dir
	* nls/Makefile.sub.in: merge into nls/Makefile.in

Mon Mar 27 22:42:53 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/globbing.c (look_for_file): don't rely on GLOB_NOMATCH as
	AIX doesn't have it.

	* configure.in, include/manconfig.h.in (man_ac_version): new,
	replaces ac_version and is more robust
	* configure.in, aclocal.m4: rename non-autoconf macros so that
	future versions of autoconf won't clash

	* gencat/gencat.c, gencat/genlib.c: tidy up header includes and
	remove unused variable definitions

	* configure.in: check for gencat

Mon Mar 27 12:51:47 BST 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version 2.3b1

	* src/man.c: small HAS_TROFF/NROFF_MISSING changes from Markus.

Thu Mar 23 18:09:46 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/man.c: man will only _create_ user db's if
	MAN_DB_CREATES is #defined (It is not defined by default)

	* add ability to install programs/man pages with transformed names.
	ie --program-prefix=PREFIX, 
	   --program-suffix=SUFFIX and
	   --program-transform-name=EXP
	arguments to configure are now observed.

	* src/man.c (try_db): store an info->addr==NULL entry in the 
	hashtable if we fail to access this db. Only try to open the 
	db once. If the db access succeeds, but the lookup fails to find 
	anything, store info==NULL in the hashtable.

	* libdb/db_ver.c (dbver_rd): don't die if wrong version. Issue a
	message, return 1 and let the caller decide what to do. 
 
Mon Mar 20 16:13:23 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/whatis.c (get_whatis): new. Use the pointer member of mandata
	structure to access the whatis string.
	(display): modify to use get_whatis().
	
	* src/checkmandirs.c (splitline): don't store whatis referenced
	`whatis' lines in the db.

	* libdb/db_lookup.c (make_content): store a NULL whatis as "" rather
	than "-".

Sun Mar 19 16:37:58 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/lexgrog.l: wipe out roff comment lines (again).

	* src/whatis.c: use BSD style regex if POSIX unavailable. Ignore
	--regex if neither available. Fix failed-regex-compilation error
	message.

	* lib/regex.c, lib/regex.h: remove
	
	* configure.in: account for regex changes.

	* libdb/db_delete.c (dbdelete): don't barf on delete request of a
	multi-key that is not listed in the main key, return NO_ENTRY.

	* src/man.c (try_section): don't try to delete db entry for missing
	straycat. Return 0 and leave that to the caller.

Sat Mar 18 12:31:48 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Replaced strncasecmp() calls with strncmp(). Removed partial 
	support for man dirs named .../MAN.

	* lib/{alloca.c,putenv.c,memcmp.c}: new
	lib/{getopt.c,getopt1.c,getopt.h,error.c,xstrdup.c,xmalloc.c}:
	newer replacements

	* All Makefile.in, include/Defines.in, include/manconfig.h.in:
	use standard (GNU coding) installation variables: 
	bindir, sysconfdir, man?ext, man?dir, localedir, manroot.
	These variables, along with prefix and exec_prefix may be specified
	on the `make' command line.

	* configure.in: move definition of BINDIR and config_prefix to 
	include/Defines.in to allow dynamic evaluation. Rename config_prefix
	to sysconfdir.

	* libdb/db_lookup.c (list_extensions): fix return count.

	* libdb/db_delete.c (dbdelete): take account of situation 
	where there were multiple name entries and they are subsequently
	deleted. When deleting the last one (which still has a multi-key
	entry), delete the standard key too, rather than recomputing it's
	content (which would be nothing and cause a "corrupt db" message).

Fri Mar 17 23:36:44 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/man.c (glob_for_file, make_names): remove
	src/globbing.c: new file
	lib/glob.c, lib/glob.h, lib/fnmatch.c, lib/fnmatch.h: replacements
	from GNU glob.tar.gz
	configure.in: glob changes. 
	Use POSIX glob replacement.
	Allow --extension to be used in globbing environment. Don't search
	for cats in alternate cat directory if no index.

	* All Makefile.in: add standard (GNU coding) targets: all, clean, 
	mostlyclean, distclean, realclean, install, uninstall, TAGS, dist 
	Other configuration/goal modifications

	* Makefile.in: force config.status to do selective re-creation

	* src/zsoelim.l: cater for ".SH \f?NAME\f?"

	* acconfig.m4 (AC_FUNC_PCLOSE), src/man.c (display): small changes
	from Markus

	* Makefile.in, README: change `make all' to equal `make nls=off'
	rather than `make nls=all'

	* include/Defines.in: move -DDEFAULT_MANROFFSEQ to
	include/manconfig.h

	* include/manconfig.h: change inline parsing. Use autoconf-2.2

Thu Mar 16 12:38:15 GMT 1995  Markus Armbruster (armbru@pond.sub.org)

	* Version: 2.2a20
	
	* zsoelim/zsoelim.l: general fixes

	* configure.in: don't add -lc as library containing db routines.

	* lib/glob.c: ultrix fixes

	* lib/rename.c: replacement

	* lib/strappend.c: small fix and copyright notice

Wed Mar 15 11:17:58 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/lexgrog.l: modifications to whatis parser, mainly for
	stray cats.

	* src/man.c (main): add drop_effective_privs() and
	regain_effective_privs() around manpath configuration so that 
	users' `hidden' manpaths are found and used.

	* substantial configuration changes regarding all Makefiles to
	allow `alternate build directory' support. man_db may be built
	in *any* directory. Aids multi-architecture builds and testing 
	of various configuration options.

	* rationalised source files to #include "local_header" and
	#include <system_header>. CPPFLAGS uses -I- to limit -I paths
	to "" resolving only. Other alternate build directory mods.

	* src/comp_src.h.in: moved to ./comp_src.h.in
	src/manconfig.h, src/path.h.in: combined into ./manconfig.h.in

	* *ensure* that lib/{regex,fnmatch,getopt}.h are only #included
	if the replacement c source is used. Otherwise use system routines
	and system headers.

	* ./configure.in, acconfig.h, aclocal.m4 (AC_FUNC_PCLOSE,
	BROKEN_PCLOSE): new autoconf macro 

	* gencat is not installed by default. (cd gencat && make install)

	* tools/mkcatdirs: re-written
	tools/checkman: new utility to check for duplicate manual pages
	across manual page hierarchies.

	* docs/INSTALL, README: new
	
	* src/man.c (display): attempt to open tmp_cat_filename(), if
	unable, don't try to save cat.
	
Sun Mar 12 18:12:13 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version 2.2a19
	
	* all source (main): replace mkprogname(%s) with 
	xstrdup(basename(%s))

	* src/util.c (strappend): remove
	* lib/strappend.c: new

Mon Mar  6 20:05:27 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)
	
	* src/man.c (--local): re-enable support for compressed local
	files. eg `man -l foo.1.gz'

	* src/man.c (make_roff_command): Check in alternate catdir then 
	mandir for external format script if ALT_EXT_FORMAT #defined.

	* zsoelim/zsoelim.l: partial rewrite to mimick GNU soelim 
	`bad roff request' error behaviour.

Mon Mar  6 13:51:32 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/man.c: fix SEGV if arg --local used

	* src/man.c (gripe_system): exit with errorcode of failed command

Sun Mar  5 20:54:13 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version 2.2a18

	* src/catman.c (main): check individual cat directories for
	existence and perms.
	
	* src/man.c (commit_tmp_cat): fix SEGV 

	* src/man.c: NO_MAN_UPDATES & NO_MAN_CATS #defined code
	regions for experimental CERN use, untested and incomplete.

	* configure.in, src/Makefile, src/paths.h.in: undo bogus dependance
	on NLS for output device=latin1.
	
	* configure.in (--with-device=<device>): new option to select 
	default nroff output device. Test that nroff can handle selected
	output device (if any).

Thu Mar  2 19:30:45 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/lexgrog.l (too_big), (add_str_to_whatis), 
	(add_char_to_whatis): new functions
	(find_name): add extra argument.
	add string bounds checking, add new condition to terminate NAME
	section: <man_name>\n{W}*\n+.+ 

	* src/check_mandirs.c, src/straycats.c, src/manconfig.h: change
	callers of find_name().

	* src/man.c (try_db_section): warn of re-cache failure, but don't
	exit.
	lots of changes/simplifications w.r.t. global/user hierarchies.
	global_manpath == 1 for global hierarchy, global_manpath == 0 for 
	user. global_manpath is set once we know which hierarchy we are
	displaying from.

Tue Feb 28 13:34:15 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/man.c (display): fix SEGV.
	
	* src/util.c (strappend): allow realloc of NULL string.

	* src/man.c: replace strappend(xstrdup("string"), ...) with
			     strappend(NULL, string, ...)

	* src/straycats.c (check_for_stray): allow any supported
	straycat compression extension if COMP_SRC is #defined. 
	Replace static buffers with dynamic.

	* src/check_mandirs.c, src/whatis.c: replace static buffers 
	with dynamic.

	* src/util.c: (mkdbname): new function.
	  src/*.c: replace static database[PATH_MAX] with mkdbname() calls.

Sun Feb 26 20:58:59 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version 2.2a17

	* src/whatis.c: warn if no index or whatis db's available.

	* src/man.c: Fixes to setuid/privs code regarding user manual 
	trees and ruid==0 from Markus.

	* configure.in: add checks for AIX, USG, stdlib.h, MINIX, ISC_POSIX

	* lib/glob.c: ensure that _POSIX_VERSION can be defined

Sun Feb 19 12:38:10 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)
	
	* Version 2.2a16

	* Various portability fixes provided by Philippe Defert
	(defert@cern.ch)
	
	* FSSTND changes regarding /usr, /var/catman searching

	* Some header file re-arrangement to aid user configuration.

Sun Feb 12 15:00:44 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version 2.2a15

Sat Feb  4 10:54:21 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* man(1), manpath(5): revisions.
 
Thu Feb  2 23:36:20 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/catman.c (do_access): new

	* src/man.c (do_chown): new
	catman changes, don't do_prompt() if print_where==1

	* src/manp.c: changed an !is_directory() to is_directory() != 1

Sat Jan 28 09:39:07 1995 Markus Armbruster (armbru@pond.sub.org)

	* man.c: **changes** ??

Sun Jan 22 16:15:04 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)
	
	* Version 2.2a14+

	* configure.in, libdb/mydbm.h libdb/db_gdbm.c: if using gdbm, 
	explicitly test for gdbm_exists() rather than use header #defines.

	* man/man1/mandb.man1, man/man1/catman.man1: moved to man/man8 and
	renamed.

	* apropos(1), whatis(1), manpath(1), zsoelim(1), catman(8),
	mandb(8) manual pages: significant revisions.

Sat Jan 21 14:33:28 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* incorporate Markus' changes with my post 2.2a13 changes.
	
	* src/version.c (ver): fix, use fprintf() instead of error().

Thu 22 Dec 1994 15:12:38 +0100 1994 Markus Armbruster (armbru@pond.sub.org)

	* src/man.c (make_roff_command, make_display_command, 
		     open_cat_stream, close_cat_stream, display,
		     find_cat_file, checked_system, 
		     get_preprocessors): new functions

	* src/man.c (format_and_display, format_and_display_file,
		     display_cat_file, parse_roff_directive,
		     add_directive): removed functions
	
	* src/man.c (glob_for_file, make_name): made consistent.

	* src/util.c (strappend): new function.
		     (do_system_command): changed/renamed to do_system().

	* src/manp.c (global_catpath): replaced/fixed
	
	* src/security, src/fake_security (do_system_command_drop_privs):
	  renamed to do_system_dropped_privs().

	* lib/rename.c: new file 

Mon Jan  9 20:42:38 GMT 1995  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* nls/Makefile, man/Makefile: allow for bogus or non existent 
	native languages passed in $nls.

	* src/man.c (do_prompt): replaced with less friendly but more
	portable version.

	* inline directives replaced with __inline__ to be more ansi.  

Mon Dec 19 12:59:28 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)
	
	* Version: 2.2a14

	* aclocal.m4, configure.in: don't define variable nroff_device

	* src/Makefile, src/paths.h.in: define GNU_NROFF_DEVICE.
	If nls != off, GNU_NROFF_DEVICE=" -Tlatin1"
	else,          GNU_NROFF_DEVICE=" -Tascii"

	* src/man.c, src/catman.c, src/security.c: #include <vfork.h> if
	available. _exit() from child rather than exit().

Sun Dec 18 17:54:22 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/util.c (basename): removed
	lib/basename.c: extracted from src/util.c
	configure.in: check for/replace basename function if necessary.

	* src/catman.c (add_arg): replace strdup() with xstrdup().

	* soelim/soelim.*: renamed zsoelim/zsoelim.*
	
	* manual pages: reflect soelim - zsoelim name change.

Fri Dec 16 12:17:48 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* configure.in: correctly determine db header and required library

	* src/man.c (main, do_extern): pass manpath to whatis / apropos in
	case man was called with -M or -m.

	* src/catman.c (main): interrogate $MANSECT for manual sections.

	* man/man1/catman.man1, man/man1/man.man1 ($MANSEC): replace with
	the correct variable - $MANSECT.

	* src/man.c: new option (-7 or --ascii) passes page through minimal
	latin1 to ascii translator. Only useful for nroff written in ascii
	and formatted with -Tlatin1.

	* man/man1/man.man1: document it.

	* src/man.c (make_command): new routine to piece together man's
	system() call. 

Thu Dec 15 13:52:42 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.2a13

	* src/catman.c (parse_for_sec): only supply man with -L locale
	arguments if locale!=0x0

	* src/Makefile: fix libmandb.a rule

Wed Dec 14 22:49:59 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)
	
	* Version 2.2a12

	* major package restructure with creation of new subdirectories
	for xcat and the db routines. Allowed split up of single db source
	file into some constituent function parts.

	* some Makefile restructuring to allow arbitrary ordering of 
	subdirectory builds.

	* ./dblib/*, ./xcat/*: new or moved from src/.

	* src/db_storage.c: moved and split up into ./dblib/*.c
	  src/mydbm.h, db_storage.h: moved into ./dblib
	  src/nls.h: moved to ./nls.h
	  src/xcat.c, src/xcat.l, src/Register: moved into ./xcat

Wed Dec 14 00:17:11 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/manconfig.h: #include <stddef.h> for size_t declaration.

	* src/checkmandirs.c (reset_db_time): remove use of strerror() in
	debug line for systems without it.

	* src/manp.c: ensure no warnings given if quiet==1

Tue Dec 12 22:10:07 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* src/xcat.l: allow duplicate message id's to exist in single C
	source file, do not duplicate in the relative message file or
	src/man_db-nls.h. Warn of such duplications as they may be in error.

Tue Dec 12 19:05:21 GMT 1994  Markus Armbruster (armbru@pond.sub.org)

	* configure.in: fix definition of BINDIR when --prefix not used

	* src/man.c: replace "export foo=bar" with "foo=bar; export foo" in
	system() command
	
	* soelim/Makefile: do not backup old soelim before install

	* lib/error.h: new

	* convert all error message to the form 
		error(int exitcode, int errno, char *message)
	where exitcode!=0 causes exit(exitcode) after message and errno!=0
	causes the error text to be appended to the message. All messages
	have "<program_name>: " prepended.

	* all C source: #include "../lib/error.h" and replace prognam with
	program_name.

	* src/db_storage.c (ndbm_flopen, btree_flopen): generalised
	(ndbm_trun_open, btree_trunc_open): removed
	(ndbm_flclose): new

	* src/gripes.c: functions copied to relevant caller.
	src/gripes.c, src/gripes.h: removed

Sun Dec 11 15:16:42 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.2a11 (not released)

	* src/man.c (main): putenv("LESSCHARSET=latin1"), remove from
	less_options[]

	* src/lexgrog.l: translate \\[ ] (escaped space) to space,
			 accept '\" as *roff comment,
			 add a space at *roff end-of-line if necessary.

Sat Dec 10 21:37:41 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* man/man1/catman.man1: new
	
	* soelim/soelim.man1: new

	* src/man.c (display_cat_file): if (COMP_SRC), support straycats
	with any supported compression extension or none at all.
	src/man.c (make_cat_file): replace execle() with execve().

	* src/catman.c: added ARG_MAX support and use execve() instead of
	system(). This should now behave on systems with small execve() 
	argument capacity by batching more, but smaller, man jobs.

	* Makefile: `make all' now equates to `make nls=all'

Thu Dec  8 00:03:12 GMT 1994  Wilf. (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.2a10

	* src/catman.c: new utility.
	src/man.c (main): minor changes wrt --catman flag.

	* src/paths.h.in (MAN_BIN): add definition for catman.

	* dvi/: provide dvi files of the packages' manual pages.

Tue Dec  6 20:58:19 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* man/man.man1: addition of EXAMPLES section.

	* src/man.c (do_prompt): change message.
	src/man.c (need_to_rerun): make -u really force an update.
	src/checkmandirs.c (reset_db_time): new function.

	* src/mydbm.h, src/db_storage.c (ndbm_flopen, ndbm_trunc_flopen): 
	provide file locking mechanism for ndbm. 
	src/db_storage.c (btree_trunc_flopen): renamed (btree_trunc_open),
	add mode argument to open() call.

	* src/db_storage.c (make_content): add `static' to declaration of
	(dash).

	* src/man.c (try_db_section): ensure db found file entry is 
	consistent with the physical file, if not, update the db entry
	before proceeding. Cache consistency should be getting much better
	in a wide variety of circumstances now. This check is not performed
	for straycats.

Tue Dec  6 12:05:57 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* man/man.man1, man/mandb.man1: large changes.
	
	* aclocal.m4, configure.in (AC_PROG_GNU_ROFF): test for GNU nroff
	src/man.c: Do not use col with GNU nroff -Tlatin1 as (a) it is not
	needed: see grotty(1) and (b) it is not 8 bit clean. continuation
	dashes should now reappear.

Wed Nov 23 16:49:48 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/check_mandirs.c (test_manfile): Provide better checking for
	the existence of both foo.1 and foo.1.gz type problems. This should
	catch any problems earlier and relieve the db interface code of the
	job of identifying such problems.

	* src/man.c (manopt_to_env): cater for $MANOPT option arguments 
	that contain spaces (for -r).
	src/man.c (man_getopt): revise, change duplicate option behaviour,
	modify -[tTZ] handling and add option -D.
	src/man/man1/man.man1: document.

	* src/man.c: create LESS_OPTS and LESS_PROMPT and move their
	definitions to src/paths.h[.in].

	* configure.in: append -s by default to whatever pager is found.
	favour db.h and -ldb above gdbm.h and -lgdbm.
	N.B.
		db creates 	index.bt
		gdbm creates 	index.db
		ndbm creates	index.dir and index.pag

Wed Nov 23 16:46:59 GMT 1994  Zoltan Hidvegi (hzoli@cs.elte.hu)

	* src/man.c: changes relating to (less_options) and (prompt). Add
	command line support for less' prompt: option -r.

	* man/man1/man.man1: document it.

Sat Nov 19 20:19:39 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.2a9

	* src/mydbm.h, src/db_storage.c: incorporate completely new
	database type: a binary tree method using the Berkeley db-1.85.1
	library. Currently experimental and is not used by default, it has
	the potential of enhanced speed and easy maintenance as it allows 
	storage of identical keys, thus reducing the amount of work necessary
	to store and lookup multi sectional manual pages such as manpath.1
	and manpath.5. During initial tests, the `walk through' algorithm, 
	used in apropos searches was 65% faster and the general database 
	open function is 100% faster when compared with gdbm-1.7.3.

	* src/whatis.c (apropos): #define-optimised for btree database type.

	* src/convert_name.c (convert_name): reorder actions to stop certain
	catfiles ending up with a double compression extension, for
	instance: foo.1.gz.gz.

	* src/Makefile, src/man.c: enable -DNO_DEFAULT_TBL_OR_COL as an
	experiment.

Fri Nov 18 21:00:47 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.2a8 (not released)

	* configure.in (config_file, config_prefix): Fix behaviour.
	
	* src/*.[cl], soelim/soelim.l: 
		s,malloc,xmalloc,g
		s,realloc,xrealloc,g 
		s,strdup,xstrdup,g
	src/manconfig.h: remove redefinitions of malloc, realloc and strdup.

Thu Nov 17 22:01:11 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/lexgrog.l: changed catfile whatis extraction rules to be a
	little more forgiving. Increased char array size from 1024 to 2048.

	* mkcatdirs: shell script to create relative cat dirs.

	* src/$PROGS: replaced all occurances of `optional_argument' with
	`required_argument' in (long_options).

	* src/man.c, src/compression.c, src/straycats.c: ensure that a
	failed child process is recognised and dealt with (normally exit(0)).

	* src/man.c (make_cat_file): removed need to filter-then-copy if not
	setuid. [untested]

	* src/man.c, src/mandb.c (main): optional profiling support if 
	__profile__ defined.

	* configure.in (config_file, config_prefix): don't work unless
	--prefix=<something> is a command line option, temporarily setting
	them to /etc/man_db.config and /etc respectively.

Wed Nov 16 20:34:54 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.2a7

	* src/man.c (format_and_display_file): Fix bug which caused 
	`man -l -' to fail. Produce sensible error message when -l file
	is inaccessable. Allow compressed manual pages to be specified when
	using -l (must have correct extension)

	* soelim/soelim.l (main): ensure (progname) is the basename of
	argv[0] .

	* src/manpath.c (main): remove local declaration of (quiet).
	add `--global' option.

Wed Nov 16 20:29:20 GMT 1994  Markus Armbruster (armbru@pond.sub.org)

	* configure.in: if $prefix=/usr, put config file in /etc else
	put it in $prefix/etc
	src/manconfig.h (CONFIG_FILE): move to paths.h.in

	* src/nls.h (LC_MESSAGES): define as (LC_ALL) in all cases where
	(LC_MESSAGES) is not defined in <locale.h>

	* src/lexgrog.l: #include "manconfig.h" to redefine strdup() to
	xstrdup()

Tue Nov 15 21:38:19 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/manp.c (is_global_mandir): new
	src/man.c (locate_page): use it instead of (global_catpath)

	* src/*.h: add suitable predicates to function prototype 
	declarations
	moved all function declarations to header files
	src/compression.h.in: renamed to comp_src.h.in

Mon Nov 14 18:17:48 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* Version: 2.2a6
	
	* src/hashtable.c, src/hashtable.h (struct nlist): replaced
	(union) member with (void *) and simplified. Modified users.

	* src/man.c (make_cat_file): fixed NULL ptr reference in call to
	(execle)
	src/man.c: determined and fixed memory leaks using Checker.

Mon Nov 14 03:33:37 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/db_storage.c (replace_if_necessary, split_data, 
	list_extensions): new
	src/db_storage.c (free_content): replaced with (free_mandata_struct)
	all callers changed 
	src/db_storage.c (split_content_keep, split_content_temp): replaced
	with (split_content)

Sun Nov 13 13:50:46 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)
	
	* src/nls.h: change of macros, add (NLS_INIT, EXIT_FUNC)
	src/*.c: removed (NLS_CLOSE) macros, adjustments due to above
	src/version.c (close_catalogue): new 
	configure.in (AC_HAVE_FUNCS): (atexit, on_exit)

	* getmandbver.c: removed

Sat Nov 12 14:18:02 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/security.h: new, contains security macros from src/manconfig.h
	src/manconfig.h: removed security macros
	src/security.c, src/security.h: replaced (SYSV_SAVED_IDS) with
	(BROKEN_LINUX_SAVED_IDS) 

	* src/paths.h.in, src/compression.h.in, configure.in: changed
	compression defines
	src/paths.h.in: defined (STD_SECTIONS), got rid of (MANPATH_MAIN)
	src/*.c: removed all (MANPATH_MAIN) defines
	configure.in: added (COMP_CAT) and (COMP_SRC) definitions
	src/manconfig.h: removed (COMP_SRC) definition

	* All manual pages: Fixed to be compatible with native *roff
	implementations having a request argument limit of 6

	* src/db_storage.c (gripe_extract_data, gripe_corrupt_data):
	new routines

	* All Makefiles: add (exec_prefix, mandir, bindir) where necessary
 
Sat Nov 12 13:38:59 GMT 1994  Markus Armbruster (armbru@pond.sub.org)

	* soelim/Makefile (install): made more portable

	* src/manconfig.h: changes to (POSIX_SAVED_IDS) definition

	* src/man.c (main): removed unnecessary #ifdef conditions regading
	(SECURE_MANUID)

Sat Nov 12 13:24:17 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/ult_src.c (ult_src): no longer follow an absolute .so include
	src/ult_src.c (test_for_include): new

Fri Nov 11 10:16:32 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/man.c (manopt_to_env): generalised

	* src/man.c (do_extern): removed (gripe_alloc) call,
	modified callers
	src/manp.c: removed (gripe_alloc) calls, general tidy
	src/gripes.c (gripe_alloc): removed

	* src/ult_src.c (ult_src): fixed loop when (buf) != NULL 
	changed absolute .so include actions
	configure.in (AC_HAVE_FUNCS): removed (memmove)

	* src/mydbm.h (copy_datum): added references
	src/db_storage.c (copy_datum): added function
	Fixes for `native ndbm' data corruption by Markus Armbruster

	* src/Makefile: removed dbver.o as dependency of manpath

	* aclocal.m4 (AC_FUNC_SPRINTF_COUNT): new file and macro
	configure.in: use it
	acconfig.h: add (SPRINTF_CHARCOUNT)
	src/check_mandirs (add_dir_entries): use it
	src/whatis.c (display): use it

	* src/check_mandirs.c (test_mandirs): added a (free(exists))

	* src/straycats.c (check_for_stray): Fixes regarding straycats
	with no compression extension  

Fri Nov 11 00:29:15 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* lib/xmalloc.c, lib/xstrdup.c, lib/error.c: replaced
	lib/strdup.c: removed
	lib/strstr.c: replaced
	lib/strsep.c, lib/strspn.c, lib/strcspn.c, lib/ansidecl.h: new
	configure.in (AC_REPLACE_FUNCS): with respect to above

	* src/check_mandirs.c (testmandirs): (free_hashtab) only if 
	necessary

Thu Nov 10 11:07:52 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)
	
	* Version: 2.2a5

	* src/man.c (usage, man_getopt, parse_roff_directive, ditroff): 
	add `-Z' option
	man/man1/man.man1: document it

Wed Nov  9 20:16:35 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* configure.in (prefix, nroff, neqn, groff, soelim, CFLAGS, 
	LDFLAGS): portability changes.
        Suggestions from Markus Armbruster <armbru@pond.sub.org>
	gencat/Makefile (CFLAGS, LDFLAGS): definitions removed

	* soelim/Makefile (install): procedural changes

	* src/ult_src.c (ult_softlink): changes regarding S_ISLNK

	* src/manconfig.h: #define __inline

	* src/man.c, src/whatis.c, src/nls.c (LC_MESSAGES): define 
	as LC_ALL if necessary

Tue Nov  8 23:17:22 GMT 1994  Wilf.  (G.Wilford@ee.surrey.ac.uk)

	* src/version.c (ver): aesthetic changes 
	* src/man.c, src/whatis.c, src/manpath.c, src/mandb.c (usage, ver): 
	calling changes

	* src/version.h, src/update_db: removed

	* src/convert_name.c (conver_name): argument changes
	src/man.c (format_and_display): caller of above changed
	(need_to_rerun, locate_page): new functions to split (man) 
	(format_and_display_nosave): renamed to format_and_display_file

	* soelim/soelim.l (usage, ver): new functions 
	removal of NLS dependence

	* Version: 2.2a4
