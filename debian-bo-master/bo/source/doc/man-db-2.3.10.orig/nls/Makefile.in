# nls Makefile for the man package.
#
# Copyright (C) 1994, 1995, Graeme Wilford.
#
# You may distribute under the terms of the GNU General Public
# License as specified in the COPYING file that comes with this
# distribution. 
#
# Sat Aug  6 15:46:44 BST 1994 Wilf. (G.Wilford@ee.surrey.ac.uk):

srcdir = @srcdir@
VPATH = @srcdir@
top_srcdir = @top_srcdir@
INSTALL = @INSTALL@

ifeq ($(msgdir),)
  include ../include/Defines

  ifeq ($(nls),on)
all:
	$(make_in_root)
  else
    ifeq ($(nls),all)
      NLS := $(notdir $(wildcard $(srcdir)/*_*))
    else
      ifneq ($(nls),off)
        NLS := $(notdir $(wildcard $(srcdir)/$(nls)))
      endif
    endif
  endif

  dirs = $(wildcard *_*)

  CAT = $(message_catalogue)
  local_gencat = ../../gencat/gencat
endif

.PHONY:	$(DEFAULT_TARGETS) $(NLS) $(dirs)

# The default build 
all: $(NLS)

MESSAGE_FILES = $(wildcard $(msgdir)/*.m)

$(NLS):
	$(MKINSTALLDIRS) $@
	$(MAKE) -C $@ -f ../Makefile $(CAT) CAT=$(CAT) \
		msgdir=../$(srcdir)/$@ gencat=$(gencat)

$(CAT): $(MESSAGE_FILES)
	test -f $(gencat) || $(MAKE) -C ../../gencat
	$(gencat) -new $@ $(MESSAGE_FILES)

# The standard targets
install: all
	$(MKINSTALLDIRS) $(addprefix $(localedir)/, $(NLS))
	@for lang in $(NLS); do \
  		echo $(INSTALL_DATA) $$lang/$(CAT) $(localedir)/$$lang/$(CAT); \
  		$(INSTALL_DATA) $$lang/$(CAT) $(localedir)/$$lang/$(CAT); \
	done

uninstall:
	-rm -f $(foreach lang, $(NLS), $(localedir)/$(lang)/$(CAT))

mostlyclean clean:
	-rm -f $(addsuffix /$(CAT), $(dirs))
	rm -f *~

distclean: clean
	rm -f Makefile.sub Makefile

# Be paranoid: use addsuffix expansion so that $(MSG_DIR)/* can never be /*
realclean: distclean
	rm -f $(addsuffix /*, $(MSG_DIR))

TAGS:
