.TH drvmidi 1 "February 25, 1997"
.LO 1
.SH NAME
drvmidi \- AWE32 MIDI player
.br
.SH SYNOPSIS
drvmidi [-options] midifile[.gz]..
.SH DESCRIPTION
.B drvmidi
is a MIDI player program which supports AWE32 sound driver
by Takashi Iwai.
Before using this program, you have to load sound
samples onto the driver (see sfxload(1)).
.P
You can pass the compressed or gzipped files on command line.
These files are expanded automatically inside the program.
To read from standard input, specify '-' as a midi file name.
.P
If drvmidi finds the file of the same file name with an extension ".id",
it loads this file as an index file.
You can specify its own settings regardless of the command line.
In the future release, this index can be editted from
the drvmidi player itself.  (Now drvmidi can only read it.)

.SH OPTIONS
.TP
.B \-i " interface"
Specify the user interface mode.
.I k
for Tcl/Tk interface, and 
.I d
for dumb interface.
.I n
means ncurses interface.
The default is Tcl/Tk interface.
.TP
.B \-D " channel"
Change drum channels.
If
.I channel
is a positive value, this channel is treated as a drum channel.
If a negavive value, minus of this value is treated as a normal channel.
For example,
.in +4

% drvmidi -D -10 -D 16 foo.mid

.in -4
will set channel 10 as a normal channel, and channel 16 as
a drum one.
As default,
.B drvmidi
uses only channel 10 (and 26) as drum channels.
.TP
.B \-c " chorus"
Specify the chorus mode.  The AWE32 card has eight chorus modes, and
each argument is
.in +4

0: chorus 1
.br
1: chorus 2
.br
2: chorus 3
.br
3: chorus 4
.br
4: feedback
.br
5: flanger
.br
6: short delay
.br
7: short delay 2
.in -4

On Tcl/Tk interface, these values can be changed from menu even during
playing samples.
.TP
.B \-r " reverb"
Specify the reverb mode.  The AWE32 card has eight reverb modes, and
each argument is
.in +4

0: room 1
.br
1: room 2
.br
2: room 3
.br
3: hall 1
.br
4: hall 2
.br
5: plate
.br
6: delay
.br
7: panning delay
.in -4

On Tcl/Tk interface, these values can be changed from menu even during
playing samples.
.TP
.B \-O
Accept
.I "all notes off"
and
.I "all sounds off"
events.
Some MIDI file contains these events.
.TP
.B \-C
Suppress the note-off event check.  The sequencer device can
handle events only in 1/100 sec unit, so often both the note
on and off events occur at the same time.  To prevent this
problem, drvmidi checks the time of each note off event, and
send it after 1/100 sec later if necessary.
.TP
.B \-G
Suppress GS part check.  As default, drvmidi changes the drum
channels according to the GS part change sysex message.
.TP
.B \-m " modes"
Set playing mode.  Some modes are valid only on Tcl/Tk interface.
The following mode identifiers may be available:
.RS
.TP
.B \-mt
Turn tracing mode on.  It shows realtime bar graph and program number of
each channel in the trace window.
.TP
.B \-ms
Shuffle play mode.  The order of the playing songs is shuffled and selected
randomly.
.TP
.B \-mn
Normal play mode.  The songs are played in the order of specified command line arguments.
.TP
.B \-mp
Start play automatically.
.TP
.B \-mq
Exit drvmidi automatically after finishing all songs.
.TP
.B \-mr
Loop the playing song.
.RE

.TP
.B \-t
Turn tracing mode on.  Equivalent with
.B \-mt.
.TP
.B \-d " display"
Set window display.  Valid only on Tcl/Tk interface.
.TP
.B \-g " geometry"
Set window geometry.  Valid only on Tcl/Tk interface.

.SH "ID FILE FORMAT"
.TP
.B "title string"
Set title of this midi file.  Displayed on behalf of the file name.
.TP
.B "chorus mode"
Set chorus mode.  The argument is identical with the command line options,
from 0 to 7.
.TP
.B "reverb mode"
Set reverb mode.  The argument is identical with the command line options,
from 0 to 7.
.TP
.B "volume percent"
Total volume in percent unit.
.TP
.B "drumflag bits"
Set drum channels.  The argument is a digit number indicating
drum channels.  For example, to set both channel 10 and 16 as
drums, the value become 0x8200.
The argument starting from 0x means a heximal number.
.TP
.B acceptall
Accpet all notes/sounds off events.
.TP
.B "tracks num"
Set track number of multi part.
.TP
.B samecsec
Suppress the note off event check.
.TP
.B gsmacro
Suppress the GS part change check.
.TP
.B "subsf arguments.."
Load optional SoundFont file automatically.
The arguments are passed to sfxload internally together with
"-I -s -b1" options.  For example, to load sfx.sf2 for sample.mid,
set "subsf sfx.sf2" in sample.id file.

.SH "SUPPORTED MIDI CONTROLS"
.TP
.I #0
bank select
.TP
.I #6
data entry
.TP
.I #7
main volume
.TP
.I #10
panning position
.TP
.I #11
expression volume
.TP
.I #32
bank select
.TP
.I #38
NRPN data entry
.TP
.I #64
sustain
.TP
.I #91
reverb effects send
.TP
.I #93
chorus effects send
.TP
.I #98
NRPN LSB
.TP
.I #99
NRPN MSB
.TP
.I #100
RPN LSB
.TP
.I #101
RPN MSB
.TP
.I #120
all sounds off
.TP
.I #121
reset controllers
.TP
.I #123
all notes off

.SH "SYSEX AND NRPN CONTROLS"

.B drvmidi
accepts the following sysex messages.
Other sysex messages are ignored.

.TP
Reverb sysex macro
.I F0 41 10 42 12 40 01 30 XX 00 F7
.br
where XX denotes the reverb mode above (from 0 to 7).
.TP       
Chorus sysex macro
.I F0 41 10 42 12 40 01 38 XX 00 F7
.br
again, XX denotes the chorus mode above (from 0 to 7).
.TP
GS part change macro
.I F0 41 10 42 12 40 1X 15 YY ?? ?? F7
.br
where X denotes the channel and YY denotes a drum flag.
.P
Also
.B drvmidi
accepts special NRPN controls for AWE32.
See ADIP document by CreativeLabs for NRPN control messages.

.SH "SEE ALSO"
sfxload(1).

.SH COPYRIGHT
Copyright (C) 1996,1997 Takashi Iwai.
.P
The AWE32 driver and utilities are free software; you can redistribute them
and/or modify them under the terms of the \fIGNU General Public
License\fP as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later version.
