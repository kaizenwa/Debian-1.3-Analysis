<HTML>

<HEAD>

<TITLE>                       The CNIDR Isite Information System
</TITLE>
<CENTER>
<STRONG>Untested Version</STRONG>
</CENTER>
<META NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.0z Beta">
</HEAD>

<BODY>

<P>

<CENTER>
<FONT SIZE=6>The</FONT>
</CENTER>

<P>

<CENTER>
<FONT SIZE=10>Isite</FONT>
</CENTER>

<P>

<CENTER>
<FONT SIZE=6>Information System</FONT>
</CENTER>

<P>

<CENTER>
<I><FONT SIZE=2><A HREF="mailto:kgamiel@vinca.cnidr.org">Kevin Gamiel (Kevin_Gamiel@cnidr.org)</A></FONT></I>
</CENTER>

<P>

<CENTER>
<FONT SIZE=4>The Clearinghouse for Networked Information Discovery
and Retrieval</FONT>
</CENTER>
<H1>Table of Contents</H1>
<A HREF=#_Toc346017084>
1.  Isite Information System</A>
<UL>
<A HREF=#_Toc346017085>
<LI>1.1  Overview</A>
<A HREF=#_Toc346017086>
<LI>Figure 1:  Isite Information System Architecture </A>
<A HREF=#_Toc346017087>
<LI>1.2  Obtaining the System </A>
<A HREF=#_Toc346017088>
<LI>1.3  Maintenance 
</A>
</UL>
<A HREF=#_Toc346017089>
2.  Search API System Administrator's Guide 
</A>
<UL>
<A HREF=#_Toc346017090>
<LI>2.1  Overview 
</A>
<A HREF=#_Toc346017091>
<LI>2.2  Installation 
</A>
<A HREF=#_Toc346017092>
<LI>2.3  General Configuration 
</A>
<A HREF=#_Toc346017093>
<LI>2.4  Database-specific Configuration 
</A>
<UL>
<A HREF=#_Toc346017094>
<LI>2.4.1  SCRIPT Databases 
</A>
<A HREF=#_Toc346017095>
<LI>2.4.2  ISEARCH Databases 
</A>
</UL>
</UL>
<A HREF=#_Toc346017096>
3.  zserver System Administrator's Guide 
</A>
<UL>
<A HREF=#_Toc346017097>
<LI>3.1  Overview 
</A>
<A HREF=#_Toc346017098>
<LI>3.2  Installation 
</A>
<A HREF=#_Toc346017099>
<LI>3.3  The Server Configuration File 
</A>
<UL>
<A HREF=#_Toc346017100>
<LI>3.3.1  Overview 
</A>
<A HREF=#_Toc346017101>
<LI>3.3.2  Server Configuration File Directives 
</A>
<UL>
<A HREF=#_Toc346017102>
<LI>3.3.2.1  AccessLog 
</A>
<A HREF=#_Toc346017103>
<LI>3.3.2.2  DBList 
</A>
<A HREF=#_Toc346017104>
<LI>3.3.2.3  DebugLevel 
</A>
<A HREF=#_Toc346017105>
<LI>3.3.2.4  MaxSessions 
</A>
<A HREF=#_Toc346017106>
<LI>3.3.2.5  Port 
</A>
<A HREF=#_Toc346017107>
<LI>3.3.2.6  SAPI 
</A>
<A HREF=#_Toc346017108>
<LI>3.3.2.7  ServerType 
</A>
<A HREF=#_Toc346017109>
<LI>3.3.2.8  TimeOut 
</A>
</UL>
</UL>
<A HREF=#_Toc346017110>
<LI>3.4  Running the Server 
</A>
<UL>
<A HREF=#_Toc346017111>
<LI>3.4.1  Running Under inetd 
</A>
<A HREF=#_Toc346017112>
<LI>3.4.2  Running from the Command Line 
</A>
</UL>
</UL>
<A HREF=#_Toc346017113>
4. Stateful http to Z39.50 Gateway 
</A>
<UL>
<A HREF=#_Toc346017114>
<LI>4.1  Overview 
</A>
<A HREF=#_Toc346017115>
<LI>4.2 Architecture 
</A>
<A HREF=#_Toc346017116>
<LI>Figure 2:  Http to Z39.50 Stateful Gateway Architecture 
</A>
<A HREF=#_Toc346017117>
<LI>4.3 Installation 
</A>
<A HREF=#_Toc346017118>
<LI>4.4 Using the Stateful Gateway 
</A>
</UL>
<BR>
<A HREF=#_Toc346017119>
Appendix A.  Copyright Statements 
</A>
<BR>
<A HREF=#_Toc346017120>
Appendix B.  Default Field Map (bib-1)
</A>

<H1><A NAME="_Toc346017084">1.  Isite Information System</A></H1>

<H2><A NAME="_Toc346017085">1.1  Overview</A>
</H2>

<P>
The Clearinghouse for Networked Information Discovery and Retrieval
(CNIDR), through the National Science Foundation Cooperative Agreement
NCR-9216963 and support from MCNC, formerly the Microelectronics
Center of North Carolina, continues development and maintenance
of Isite, a complete Internet information system. Isite integrates
database systems with other open Internet systems and protocols
such as the World Wide Web, Gopher, electronic mail and, primarily,
ANSI/NISO Z39.50.  The primary protocol, Z39.50, offers a variety
of search and retrieval facilities suitable for complex database
operations.  Isite includes all Z39.50 communications applications
as well as an http to Z39.50 gateway and a complete text search
system, Isearch.  See figure 1 for an overall architectural view.
<P>
<A NAME="_Toc346017086">
<IMG SRC="istefig1.gif">
</A><BR>
<FONT SIZE=2 FACE="Arial">Figure 1:  Isite
Information System Architecture</FONT>
<H2><A NAME="_Toc346017087">1.2  Obtaining the System</A></H2>

<P>
Isite is freely available for all use subject to the copyright
statements in Appendix A.
<P>
The software may be downloaded from the Internet via the file
transfer protocol (FTP) from the host ftp.cnidr.org.  After connecting,
change to the /pub/NIDR.tools/Isite directory and read the README
file.  Change to binary mode and download the latest copy of either
the source code or the binaries. If you're viewing this document with
a web browser, click here for an <A HREF="ftp://ftp.cnidr.org/pub/NIDR.tools/Isite/">Isite directory listing</A>.
<P>
After downloading, you must unzip the compressed package.  If
the filename ends in .gz, the file was compressed with GNU's gzip
package.  To unzip a gzipped package, enter the command 'gunzip
Isite-x.xx.tar.gz'.  If the filename ends in .Z, the file was
compressed with the standard UNIX compression utility. In that
case, unzip with the command 'uncompress Isite-x.xx.tar.Z'.
<P>
You should then have a file of the form Isite-x.xx.tar.  To untar
the file, enter the command 'tar xvf Isite-x.xx.tar'.  A subdirectory
will be created named Isite-x.xx and all Isite-related files will
reside in that subdirectory.
<P>
The source code requires a C++ compiler (GNU g++ preferred) to
build.  For more information on building the source code, read
the README file in the Isite-x.xx directory.
<H2><A NAME="_Toc346017088">1.3  Maintenance</A></H2>

<P>
Maintenance of an Isite information system requires the maintenance
of the CNIDR Search API and the CNIDR Z39.50 server, zserver.
<H1><A NAME="_Toc346017089">2.  Search API System Administrator's
Guide</A></H1>

<H2><A NAME="_Toc346017090">2.1  Overview</A>
</H2>

<P>
Many applications require access to text searching facilities
and database systems.  In response to this general need, CNIDR
has developed a Search API (SAPI) which attempts to generalize
access to arbitrary database systems via a common API.  Any application
that links with this API, therefore, inherits the
<P>
functionality of any database system that may reside &quot;behind&quot;
the API.
<P>
To the system administrator, this means that you must maintain
one or more text files that describe which databases are currently
available, their location on the file system, etc.  By keeping
this information up to date, all applications on your system designed
to use the Search API will always have dynamic access to those
databases.
<H2><A NAME="_Toc346017091">2.2  Installation</A></H2>

<P>
Installation of the SAPI involves creating a single text file,
known as the SAPI Configuration File, in a convenient location
on your file system.  Name the file &quot;sapi.ini&quot; and store
in a location accessible by any SAPI-compliant applications (such
as zserver).  You will later need to inform each SAPI-compliant
application of the sapi.ini file's location in the manner prescribed
by each application.
<P>
The remainder of this chapter describes the format of the SAPI
configuration file.
<H2><A NAME="_Toc346017092">2.3  General Configuration</A></H2>

<P>
In general, the SAPI Configuration File describes each database
available through the API to SAPI compliant applications.  Among
other information, this file identifies the type of database and
the location of the database on the file system.  This file has
the general form:
<PRE>
[Group1]
Directive1=Value
Directive2=Value

[Group2]
Directive1=Value
Directive2=Value

...
</PRE>
The file is separated into named Groups of information.  Each
Group has a series of Directives and associated Values.
<P>
Let's take a quick, high-level look at an example sapi.ini file.
 We will discuss this file in more detail later.
<PRE>
[Default]
DBList=ERIC,CATALOG

[ERIC]
Type=SCRIPT
Location=/usr/local/bin/ManPageSearch
Results=/tmp/results

[CATALOG]
Location=/local/databases
</PRE>
The first mandatory Group, named &quot;Default&quot;, is where
general information about the Search API itself is described.
 Currently, there is only a single directive defined for that
Group, the &quot;DBList&quot; directive.  The DBList directive
lists all databases accessible via the SAPI by name.
<P>
In the example, the DBList directive indicates that two databases
are available for searching; CATALOG and ERIC.  
<P>
For each database name in the DBList, you must create a Database
Information Group.  In each Database Information Group, you must
specify at least a database Type and Location and, depending on
the search engine type, a Results directive.
<H2><A NAME="_Toc346017093">2.4  Database-specific Configuration</A>
</H2>

<P>
There are currently two Types of search engines supported by the
SAPI: ISEARCH and SCRIPT.
<P>
ISEARCH is the default search engine written and maintained by
CNIDR.  It provides relevance ranked, full text searching as well
as Boolean, fielded searching.
<P>
The SCRIPT &quot;search engine&quot; is really a mechanism for
calling scripts or other external applications for search and
retrieval.  
<P>
In our example above, the first Database Information Group defines
ERIC to be a database of type SCRIPT.  More information on the
SCRIPT directives are discussed in the section on the SCRIPT search
engine below.
<P>
In the second Database Information Group, CATALOG has no Type
defined and is, by default, an ISEARCH database.  Again, we will
discuss the other directives in the section on the ISEARCH search
engine below.
<H3><A NAME="_Toc346017094">2.4.1  SCRIPT Databases</A></H3>

<P>
The SCRIPT search engine was initially developed simply to test
the Search API.  However, we felt that others might find it useful,
so we left it in.  
<P>
The purpose of the SCRIPT search engine is to allow system administrators
to offer new, interesting databases quickly and easily without
having a specific database system or tool and without having to
extend the source code of Isite.
<P>
We chose to implement this by describing a simple interface between
the Search API and external applications.  There are three components
involved in this interface:  The Database Information Group, the
external application and the results file.
<P>
A Database Information Group is an entry in a sapi.ini file that
describes a database.  For SCRIPT-type databases, the database
information group must have the directives &quot;Type&quot;, &quot;Location&quot;
and &quot;Results&quot;.  Consider:
<PRE>
[ManPages]
Type=SCRIPT
Location=/usr/bin/ManPageSearch.sh
Results=/tmp/results
</PRE>
In this example, the database name is ManPages and the database
type is SCRIPT.  For SCRIPT type databases, the Location directive
is mandatory and specifies a fully-qualified pathname of an external
application or shell script.  The Results directive is also mandatory
and acts as a prefix
<P>
for a temporary storage file for the results of the search.  When
the Search API receives a request to search the ManPages database
for a term of 'strcmp', for example, it constructs a command of
the form:
<PRE>
/usr/bin/ManPageSearch /tmp/results.&lt;pid&gt; strcmp
</PRE>
and executes that command with a system() call.  Therefore, the
calling of a SCRIPT search engine is quite simple, however the
results file must be structured to allow the Search API to read
the search results.
<P>
The Results file must be adhere to the following format:
<PRE>
[Default]
HitCount=3
Diagnostic=0
Separator=##separator string - your choice##
[Data]
Record data for record number 1
##separator string - your choice##
Record data for record number 2
##separator string - your choice##
Record data for record number 3
</PRE>
If the Results file is not of this format, you can expect unexpected
results! The file begins with a group named &quot;Default&quot;.
 Within the Default group, &quot;HitCount&quot; is the number
of documents matching the user's query and available for retrieval.
 As of this writing, &quot;Diagnostic&quot; can be one of two
values, 0 or 1.  A value of 0 indicates success and 1, failure.
 The &quot;Separator&quot; directive should be a unique string
(unique among the data records) that will be used to separate
the data records themselves.  This provides the 
<P>
Search API with a dynamic mechanism for retrieving records based
on a caller's request.
<P>
Next, we have a group named &quot;Data&quot;.  The actual data
records (HitCount of them) are listed sequentially after the Data
group name, separated by a single line containing only the Separator
value.
<P>
Therefore, if you wish to write a SCRIPT type search engine to
be used with the Search API (hence any applications that use the
Search API), you need to do the following:
<P>
<UL>
<LI>Write a script or program that accepts 2 command line arguments, a temp file name and query term.
<LI>In the script, perform whatever operation you wish and then write the results of your operation into the temp file you received on the command line.  You must adhere to the file format described above!
<LI>Edit your sapi.ini file and add your new database by adding the database name to the DBList directive and add a Database Information Group as described above.
</UL>
Any applications (zserver, for example) that use the Search API
should be made aware of the Search API's new databases.  Refer
to the documentation for each application for more details.  That
should be all!
<H3><A NAME="_Toc346017095">2.4.2  ISEARCH Databases</A></H3>

<P>
Isearch is the default search engine.  An ISEARCH type database
requires Type and Location directives.
<P>
The Location directive specifies the directory in which your Iindex-ed
database exists.  The actual database filename is constructed
internally by concatenating the Location with a slash and the
database name (CATALOG).  A trailing slash, therefore, should
never be included in the Location.  The database name <I><B>is</B></I>
case sensitive.
<P>
For example:
<PRE>
[Default]
DBList=CATALOG

[CATALOG]
Location=/local/databases
</PRE>
In this example, the Iindex-ed database named CATALOG should reside
in the /local/databases directory on the file system.  Any SAPI-compliant
application, then, can search the CATALOG database.  For more
information on building databases with Iindex, refer to the Isearch
documentation.
<P>
Optionally, ISEARCH databases may include a directive named FieldMaps.
 In order for Z39.50 clients to search your Isearch database in
a standardized manner, you must provide a mapping from Z39.50
database information to Isearch style information.  This currently
involves mapping Z39.50 Use attributes (combination Attribute
Set Id and integer Use value representing a field name) to your
field names as indexed by Iindex.  The default attribute set is
bib-1.  By default, the bib-1 field names listed in Appendix C
are recognized and mapped appropriately.  For example, if the
client sends a search request specifying the bib-1 Attribute Set
with the Use attribute value 4, zserver will attempt to search
a field named &quot;title&quot; in your Iindexed database.  If
no field named &quot;title&quot; exists in your database, the
search will fail.  To override the default field name with one
of your own, you must create a file with custom mappings.  A 
single mappings file can be used for as many different databases
as needed and can be combined with other mapping files, each overlaying
the values of the previous one.
<P>
Let us assume you index a collection of files of the following
form:
<PRE>
&lt;TITLE&gt;Document Number 1&lt;/TITLE&gt;
&lt;H1&gt;The subject of my document&lt;/H1&gt;
&lt;BODY&gt;blah blah&lt;/BODY&gt;
</PRE>
By default, clients attempting to search with an Attribute Set
of bib-1 and Use attribute of 4 will successfully search the &lt;title&gt;
field.  In order to allow clients to search the &lt;h1&gt; field,
however, we must provide a custom mapping.  First, decide which
bib-1 Use attribute is most appropriate.  In this case, a Use
value of 21, Subject Heading, seems most appropriate.  Next, create
a custom mapping file called, for example, mymap.ini.  This file
might look like this:
<PRE>
[Default]
bib1/21=h1
</PRE>
Now you must inform the Search API of the existence of this mapping
file.  To do so, add the FieldMaps directive to the appropriate
database information group in the sapi.ini file.  For example:
<PRE>
[Default]
DBList=CATALOG

[CATALOG]
Location=/local/databases
FieldMaps=mymap.ini
</PRE>
When the server starts, it will read the mymap.ini file and override
the value of bib1/21 and map it to the Isearch field name of &lt;h1&gt;.
<H1><A NAME="_Toc346017096">3.  zserver System Administrator's
Guide</A></H1>

<H2><A NAME="_Toc346017097">3.1  Overview</A>
</H2>

<P>
Isite provides access to database systems via the ANSI/NISO Z39.50
search and retrieval protocol.  The Z39.50 communications server,
zserver, is linked with the CNIDR Search API in order to accomplish
this task.
<P>
This document assumes that you have obtained a copy of the Isite
software and have the binaries at your disposal.
<H2><A NAME="_Toc346017098">3.2  Installation</A></H2>

<P>
There are two files involved in the installation of zserver: the
zserver binary and the zserver configuration file.  
<P>
The zserver binary is the communications server itself.  It accepts
Z39.50 TCP connections and accepts requests to search and retrieve
from databases available through the CNIDR Search API.  Copy the
zserver binary to a suitable location such as /usr/local/bin.
<P>
The characteristics of the server are defined in the server configuration
file, typically named zserver.ini.  This file should be in a location
accessible to the zserver application, preferably in the same
directory.
<P>
The remainder of this chapter describes the format of the zserver
configuration file and usage of the server.
<H2><A NAME="_Toc346017099">3.3  The Server Configuration File</A>
</H2>

<H3><A NAME="_Toc346017100">3.3.1  Overview</A></H3>

<P>
The zserver Server Configuration File is a simple text file that
can be created and maintained with your favorite text editor.
 The file contains all information needed by zserver for operation.
 The file should be named zserver.ini.  A zserver.ini file is
made up of Groups and Directives.  
<P>
A Group begins with a group name in square brackets and continues
until the end of the file or until another group name is encountered.
 A group provides a mechanism for grouping directives under a
common name for an intended set of functionality. 
<P>
Within each group are a series of Directives, each with an associated
Value.  A Directive is text string with no spaces immediately
followed by an equal sign. The Value associated with a particular
directive should immediately follow the equals sign.
<P>
There is currently only one Group within a zserver.ini, the Server
Information Group.
<P>
The Server Information Group should be named [Default].
<H3><A NAME="_Toc346017101">3.3.2  Server Configuration File Directives</A>
</H3>

<P>
The following is the list of directives recognized by zserver
from its configuration file, zserver.ini, under the [Default]
group.
<P>
<H4><A NAME="_Toc346017102">3.3.2.1  AccessLog</A></H4>

<PRE>
Syntax:

	AccessLog=/tmp/zserver_access.log

Description:

	Specifies a file to which client access information is written.

Default:

 	AccessLog=/tmp/zserver_access.log
<P>
<H4><A NAME="_Toc346017103">3.3.2.2  DBList</A></H4>

Syntax:

	DBList=DBNAME1,DBNAME2

Description:

	Lists database names accessible to Z39.50 clients from
	zserver.  These names must correspond to and be a subset
	of those in the DBList directive within the SAPI configuration
  	file.

Default:

	DBList=
<P>
<H4><A NAME="_Toc346017104">3.3.2.3  DebugLevel</A></H4>

Syntax:

	DebugLevel=9

Description:

	Specifies the level of debugging information to be printed to
	standard error during server operation.  Values range from 0 to 
	9 from less verbose to more verbose.

Default:

	DebugLevel=3
<P>
<H4><A NAME="_Toc346017105">3.3.2.4  MaxSessions</A></H4>

Syntax:
 
	MaxSessions=50

Description:

	If ServerType is set to STANDALONE, up to MaxSessions may be
 	active at any time.  If MaxSessions is reached, clients will
  	be refused Z39.50 initialization.
 
Default:
	MaxSessions=50
<P>
<H4><A NAME="_Toc346017106">3.3.2.5  Port</A></H4>

Syntax:
  
	Port=210

Description:

	Indicates the TCP port on which connections will be accepted.
  	Port 210 is the official port for Z39.50.

Default:

	Port=210
<P>
<H4><A NAME="_Toc346017107">3.3.2.6  SAPI</A></H4>

Syntax:

	SAPI=/usr/local/etc/sapi/sapi.ini

Description:

	Specifies which file to use as the Search API configuration
  	file.  See documentation on the SAPI for more information
  	on the format of that file.

Default:

	SAPI=sapi.ini
<P>
<H4><A NAME="_Toc346017108">3.3.2.7  ServerType</A></H4>

Syntax:

	ServerType=INETD
	
		or

	ServerType=STANDALONE

Description:

	Running in INETD mode will run a single copy of the server and
  	the process exits upon termination of the Z39.50 session.  
  
  	In STANDALONE mode, the server runs as a forking daemon, 
  	forking a separate process for each Z39.50 client connection.
 
  	Up to MaxSessions processes can be active simultaneously if
  	in STANDALONE mode.

Default:

	ServerType=STANDALONE
<P>
<H4><A NAME="_Toc346017109">3.3.2.8  TimeOut</A></H4>

Syntax:

	TimeOut=3600

Description:

	Specifies the number of seconds the server should wait for 
	client interaction before closing the session due to 
	inactivity.

Default:

	TimeOut=3600
</PRE>
<H2><A NAME="_Toc346017110">3.4  Running the Server</A></H2>

<H3><A NAME="_Toc346017111">3.4.1  Running Under inetd</A></H3>

<P>
Read the man pages for your particular inetd.conf file.  Read
section 3.4.2 below for more information on the command line syntax
for zserver.
<H3><A NAME="_Toc346017112">3.4.2  Running from the Command Line</A>
</H3>

<P>
To run zserver from the command line:
<PRE>
	zserver [[-i[IniFile][,Group]]] [-oOption=Value] [...]
</PRE>
Examples:
<PRE>
	zserver
</PRE>
This example assumes that zserver is in your path and
that a file named zserver.ini is in the current working
directory. 
<PRE>
	/usr/local/bin/zserver -i/usr/local/bin/zserver.ini
</PRE>
This example assumes that the zserver executable and 
  zserver.ini files reside in the /usr/local/bin directory.  
 /usr/local/bin/zserver -i/usr/local/bin/zserver.ini,MyGroup
  This example assumes that the zserver executable and 
  zserver.ini files reside in the /usr/local/bin directory
  and that the server should read its configuration information
  from the group named MyGroup instead of the usual group
  named Default.
<PRE>
	zserver -oPort=8888 -oDebugLevel=9
</PRE>
This example assumes that zserver is in your path and
  that a file named zserver.ini is in the current working
  directory.  It also overrides the Port and DebugLevel 
  directives defined in zserver.ini.  Any valid directive
  from the zserver.ini may be overridden in the same manner
  on the command line.
<H1><A NAME="_Toc346017113">4. Stateful http to Z39.50 Gateway</A>
</H1>

<H2><A NAME="_Toc346017114">4.1  Overview</A>
</H2>

<P>
Using several utilities included with Isite, one can establish
a stateful session between a standard http (World Wide Web) server
and any remote Z39.50 server.  By stateful, we mean that a Z39.50
session is initialized only once and is interactively used by
a stateless WWW browser.  The gateway has an inactivity timer
that automatically closes the session after a pre-configured period
of time with no user input.
<H2><A NAME="_Toc346017115">4.2 Architecture</A></H2>

<P>
<A NAME="_Toc346017116">
<IMG SRC="istefig2.gif">
</A><BR>
<FONT SIZE=2 FACE="Arial">Figure 2:  Http
to Z39.50 Stateful Gateway Architecture</FONT>
<P>
In figure 2, the combination of http server, zgate and zcon represents
the gateway running on a single machine.  A WWW browser connects
to the http server and posts an HTML form containing information
related to a new or existing Z39.50 session.  The zgate CGI application
parses that form and either starts a new zcon process or connects
to an existing zcon process.  The user's request is then passed
from zgate to the appropriate zcon which in turn communicates
with the remote Z39.50 server.  The results are passed back from
the Z39.50 server to zcon, back to zgate, back to the http server
and back to the WWW browser for display to the user.  The zgate
CGI process then exits, but the associated zcon process stays
alive, holding open the Z39.50 connection.  If a zcon process
receives no input for a pre-configured period of time, the process
exits.
<H2><A NAME="_Toc346017117">4.3 Installation</A></H2>

<P>
Installation of the gateway requires a CGI-capable http server,
such as NCSA's httpd <A HREF="http://hoohoo.ncsa.uiuc.edu">(hoohoo.ncsa.uiuc.edu.)</A>  Copy the
zgate and zcon executables to the cgi-bin directory used by your
http server.  
<P>
Next, start with the <A HREF="/gateway.html">HTML form template</A>,
customize it to suit your needs and install under the DocumentRoot directory
of your http server (make the document accessible to WWW browsers.)
 We refer to this HTML form as the Gateway Initialization Form.
<P>
The CGI variable named &quot;FORM_HOST_PORT&quot; is the most
crucial to the operation of the stateful gateway.  Set this variable
to the full path and filename of your HTML search form (described
later), the hostname and port of the desired Z39.50 server.  Separate
each value with a comma.  When such a form is posted to zgate,
zgate attempts to initiate a Z39.50 connection to the specified
server and if successful, presents the search form to the user.
 These CGI variables are mandatory in the gateway initialization form:
<P>
<TABLE BORDER>
<TR>
<TH>CGI Variable Name</TH><TH>Value</TH><TH>Description</TH>
</TR>
<TR>
<TD>ACTION</TD><TD>INIT</TD><TD>Indicates the action the gateway is to take</TD>
</TR>
<TR>
<TD>FORM_HOST_PORT</TD><TD><I>filename</I>,<I>host</I>,<I>port</I></TD><TD>
The filename of an HTML search form (described later), the Internet hostname and port of the desired Z39.50 server.</TD>
</TR>
<TR>
<TD>GROUPID</TD><TD><I>Groupname</I> or <PRE>anonymous</PRE></TD>
<TD>The Group authenticated to access the specified server.</TD>
</TR>
<TR>
<TD>USERID</TD><TD><I>Username</I> or <PRE>anonymous</PRE></TD>
<TD>The User authenticated to access the specified server.</TD>
</TR>
<TR>
<TD>PASSWORD</TD><TD><I>Password</I> or <PRE>e-mail_address</PRE></TD>
<TD>The Password for the Groupname/Username combination required to access the specified server.  If USERID is anonymous, PASSWORD should be the user's e-mail address</TD>
</TR>
</TABLE>
<P>
For each server described in the gateway initialization form, you must include 
a search form.  The search form is not automatically generated in order to allow
you to customize it to suit your needs.  You must, however, include
the following mandatory CGI variables (<A HREF="search.html">download</A> an example search form):
<P>
<TABLE BORDER>
<TR>
<TH>CGI Variable Name</TH><TH>Value</TH><TH>Description</TH>
</TR>
<TR>
<TD>ACTION</TD><TD>SEARCH</TD><TD>Indicates the action the gateway is to take.
</TD>
</TR>
<TR>
<TD>DBNAME</TD><TD><I>database_name</I></TD><TD>Name of Z39.50 database</TD>
</TR>
<TR>
<TD>ESNAME</TD><TD><I>element_set_name</I></TD><TD>Element set name for
the headline documents.  Defaults to &quot;B&quot; for Brief.</TD>
</TR>
<TR>
<TD>RECSYNTAX</TD><TD><I>record_syntax</I></TD><TD>Record syntax for the
headline documents.  Defaults to USMARC (1.2.840.10003.5.10).</TD>
</TR>
<TR>
<TD>TERM_1</TD><TD><I>query_term</I></TD><TD>First query term</TD>
</TR>
<TD>USE_1</TD><TD><I>field_to_search</I></TD><TD>First Z39.50 Use attribute.
 The default attribute set is bib-1.  The default Use attribute is 1035 (Anywhere.)  For Isearch databases, this is mapped to full text.</TD>
</TR>
<TR>
<TD>TERM_2</TD><TD><I>query_term</I></TD><TD>Second query term (optional)</TD>
</TR>
<TR>
<TD>USE_2</TD><TD><I>field_to_search</I></TD><TD>Second Z39.50 Use attribute
(optional)</TD>
</TR>
<TR>
<TD>BOOLEAN_OP</TD><TD><I>Boolean_operator</I></TD><TD>If second query term
is included, performs this Boolean operation.  The default is AND.  Choices are AND and OR.</TD>
</TR>
<TR>
<TD>MAXRECORDS</TD><TD><I>maximum_records</I></TD><TD>Maximum number of
records to display per page.  Default is 10.</TD>
</TR>
<TR>
<TD>SESSION_ID</TD><TD><I>gateway_session_id</I></TD><TD>This variable is
required and is automatically inserted into the search form by the zgate application. <B> It should not be included in the static copy of your search form! </B>In other words, don't worry about it, I just wanted to let you know it was there</TD>
</TR>
</TABLE>
<H2><A NAME="_Toc346017118">4.4 Using the Stateful Gateway</A>
</H2>

<P>
To use the gateway, you must always begin a session by loading
the Gateway Initialization Form described in section 4.3 into
your WWW browser.  You will be presented a list of services (Z39.50
servers) from which to choose.  Select one of the services and
press the &quot;Connect to Service&quot; button.  The form will
be posted to your http server which will start the zgate CGI application.
 The zgate application will parse the form and start a new zcon
process which will attempt to initialize to the specified Z39.50
server.  If successful, you will be presented with the specified
search form.  From that form, you may interact with the server,
searching and retrieving records.
<H1><A NAME="_Toc346017119">Appendix A.  Copyright
Statements</A></H1>
<HR>
Copyright (c) MCNC, Clearinghouse for Networked Information Discovery
and
Retrieval, 1994. 
<P>
Permission to use, copy, modify, distribute, and sell this software
and
its documentation, in whole or in part, for any purpose is hereby
granted
without fee, provided that
<UL>
<LI>1. The above copyright notice and this permission notice appear
in all
copies of the software and related documentation. Notices of copyright
and/or attribution which appear at the beginning of any file included
in
this distribution must remain intact. 
<LI>2. Users of this software agree to make their best efforts (a)
to return
to MCNC any improvements or extensions that they make, so that
these may
be included in future releases; and (b) to inform MCNC/CNIDR of
noteworthy
uses of this software. 
<LI>3. The names of MCNC and Clearinghouse for Networked Information
Discovery
and Retrieval may not be used in any advertising or publicity
relating to
the software without the specific, prior written permission of
MCNC/CNIDR. 
</UL>
THE SOFTWARE IS PROVIDED &quot;AS-IS&quot; AND WITHOUT WARRANTY
OF ANY KIND,
EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
WARRANTY
OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 
IN NO EVENT SHALL MCNC/CNIDR BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES
WHATSOEVER
RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED
OF THE
POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING
OUT OF OR
IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. 
<HR>
This material is based on work sponsored by the National Science
Foundation under Cooperative Agreement No. NCR-9216963.  The Government
has certain rights in this material. 
<P>
Any opinions, findings and conclusions or recommendations expressed
in
this publication are those of the author(s) and do not necessarily
reflect
the views of the National Science Foundation.
<HR>
(c)1992 OCLC Online Computer Library Center, Inc., 6565 Frantz
Road, Dublin,
<P>
Ohio 43017-0702.  OCLC is a registered trademark of OCLC Online
Computer
Library Center, Inc.
<P>
NOTICE TO USERS:  The BER Utilities (&quot;Software&quot;) has
been developed by OCLC
Online Computer Library Center, Inc.  Subject to the terms and
conditions set
forth below, OCLC grants to user a perpetual, non-exclusive, royalty-free
license to use, reproduce, alter, modify, and create derivative
works from
Software, and to sublicense Software subject to the following
terms and
conditions:
<P>
SOFTWARE IS PROVIDED AS IS.  OCLC MAKES NO WARRANTIES, REPRESENTATIONS,
OR
GUARANTEES WHETHER EXPRESS OR IMPLIED REGARDING SOFTWARE, ITS
FITNESS FOR ANY
PARTICULAR PURPOSE, OR THE ACCURACY OF THE INFORMATION CONTAINED
THEREIN.
<P>
User agrees that OCLC shall have no liability to user arising
therefrom,
regardless of the basis of the action, including liability for
special,
consequential, exemplary, or incidental damages, including lost
profits,
even if it has been advised of the possibility thereof.
User shall cause the copyright notice of OCLC to appear on all
copies of
Software, including derivative works made therefrom.
<HR>
<PRE>
/*
 * Copyright (c) 1992 The Regents of the University of California.
 * All rights reserved.
 *
 * Author: Ray Larson, ray@sherlock.berkeley.edu
 *  School of Library and Information Studies, UC Berkeley
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 * This product includes software developed by the University of
 * California, Berkeley.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND THE AUTHOR ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */
</PRE>
<H1><A NAME="_Toc346017120">Appendix B.  Default Field Map (bib-1)</A>
</H1>
<PRE>
[Default]
bib1/1=Name-personal
bib1/2=Name-corporate
bib1/3=Name-conference
bib1/4=Title
bib1/5=Title-series
bib1/6=Title-uniform
bib1/7=Identifier-ISBN
bib1/8=Identifier-ISSN
bib1/9=Control-number-LC
bib1/10=Control-number-BNB
bib1/11=Control-number-BNF
bib1/12=Control-number-local
bib1/13=Classification-Dewey
bib1/14=Classification-UDC
bib1/15=Classification-Bliss
bib1/16=Classification-LC
bib1/17=Classification-NLM
bib1/18=Classification-NAL
bib1/19=Classification-MOS
bib1/20=Classification-local
bib1/21=Subject
bib1/22=Subject-RAMEAU
bib1/23=Subject-BDI
bib1/24=Subject-INSPEC
bib1/25=Subject-MESH
bib1/26=Subject-PA
bib1/27=Subject-LC
bib1/28=Subject-RVM
bib1/29=Subject-local
bib1/30=Date
bib1/31=Date-publication
bib1/32=Date-acquisition
bib1/33=Title-key
bib1/34=Title-collective
bib1/35=Title-parallel
bib1/36=Title-cover
bib1/37=Title-added-title-page
bib1/38=Title-caption
bib1/39=Title-running
bib1/40=Title-spine
bib1/41=Title-other-variant
bib1/42=Title-former
bib1/43=Title-abbreviated
bib1/44=Title-expanded
bib1/45=Subject-PRECIS
bib1/46=Subject-RSWK
bib1/47=Subject-subdivision
bib1/48=Identifier-national-bibliography
bib1/49=Identifier-legal-deposit
bib1/50=Classification-government-publication
bib1/51=Identifier-publisher-for-music
bib1/52=Control-number-DB
bib1/53=Identifier-local-call
bib1/54=Code-language
bib1/55=Code-geographic-area
bib1/56=Code-institution
bib1/57=Name-and-title
bib1/58=Name-geographic
bib1/59=Name-geographic-place-publication
bib1/60=Identifier-CODEN
bib1/61=Code-microform-generation
bib1/62=Abstract
bib1/63=Note
bib1/1000=Author-name-and-title
bib1/1001=Code-record-type
bib1/1002=Name
bib1/1003=Author-name
bib1/1004=Author-name-personal
bib1/1005=Author-name-corporate
bib1/1006=Author-name-conference
bib1/1007=Identifier-standard
bib1/1008=Subject-LC-children's
bib1/1009=Subject-name-personal
bib1/1010=Body-of-text
bib1/1011=Date/time-added-to-database
bib1/1012=Date/time-last-modified
bib1/1013=Identifier-authority/format
bib1/1014=Concept-text
bib1/1015=Concept-reference
bib1/1016=Any
bib1/1017=Server-choice
bib1/1018=Name-publisher
bib1/1019=Record-source
bib1/1020=Name-editor
bib1/1021=Bib-level
bib1/1022=Geographic-class
bib1/1023=Indexed-by
bib1/1024=Map-scale
bib1/1025=Music-key
bib1/1026=Related-periodical
bib1/1027=Identifier-report
bib1/1028=Identifier-stock
bib1/1030=Identifier-thematic
bib1/1031=Material-type
bib1/1032=Identifier-document
bib1/1033=Host-item
bib1/1034=Content-type
bib1/1035=Anywhere		<I>This maps to an Isearch full text search</I>
bib1/1036=Author-Title-Subject
</BODY>
</HTML>
