<html> <head>
<title>Readme for the analog program</title>
</head>

<body>
<h1>Readme for
<a href="http://www.statslab.cam.ac.uk/~sret1/analog/">analog2.0</a></h1>

<h2>Contents</h2>
<ul>
  <li><a href="#INTRO">Introduction</a>
  <li><a href="#NEW">What's new?</a>
  <li><a href="#RUN">Compiling and running</a>
  <li><a href="#CUSTOM">Customising analog</a>
      <ul>
	<li><a href="#CUSGEN">General summary</a>
	<li><a href="#CUSTIM">Time reports</a>
	<li><a href="#CUSOTH">Other reports</a>
	<li><a href="#CUSERR">Error and status code reports</a>
	<li><a href="#CUSLOG">What to analyse</a>
	<li><a href="#CUSALI">Aliases etc.</a>
	<li><a href="#CUSCAC">Cache files</a>
	<li><a href="#CUSDNS">DNS lookups</a>
	<li><a href="#CUSMISC">Miscellaneous options</a>
      </ul>
  <li><a href="#DOM">The domains file</a>
  <li><a href="#PREOUT">Preformatted output</a>
  <li><a href="#FORM">The form interface</a>
  <li><a href="#REF">Glossary and reference</a>
  <li><a href="#FAQ">Frequently asked questions</a>
  <li><a href="#WARN">Warnings</a>
  <li><a href="#BUGS">Bugs</a>
  <li><a href="#WISH">Mailing list</a>
  <li><a href="#ACKNOW">Acknowledgements</a>
  <li><a href="#LICENCE">Licence</a>
</ul>

<hr>
<h2><a name="INTRO">Introduction</h2>

<p>This Readme describes analog2.0. For the latest version of analog,
see the
<a href="http://www.statslab.cam.ac.uk/~sret1/analog/">analog
home page</a>.

<p>This program analyses logfiles from WWW servers.
It works on most Unix, DOS, Mac and VMS machines.
It is designed to be fast and to produce attractive statistics.
For more details, see the
<ul>
  <li><a href="http://www.statslab.cam.ac.uk/~sret1/analog/">analog home page</a>.
</ul>
For examples of the output see
<ul>
  <li><a href="http://www.statslab.cam.ac.uk/~sret1/stats/stats.html">our local statistics.</a>
  <li><a href="http://www.statslab.cam.ac.uk/~sret1/stats/statsme.html">statistics for my pages.</a>
</ul>

<p>
Sorry about the length of this Readme. It includes documentation on everything
the program can do. It's not as complicated as it looks, and you don't have
to read all of it before using the program anyway!

<p>
This program is freeware, but its use is covered by a <a
href="#LICENCE">licence</a> which is at the bottom of this file. You must agree
to the terms of the licence before using the program.

<hr>
<h2><a name="NEW">What's new?</h2>

This section describes the main new features in each version of analog.
If you are using analog
for the first time, you can <a href="#RUN">skip this section</a>.
If you are upgrading from an old version of analog, you might also like to look
at the file Update (which should have come with the program) to see what
options have been deleted or have changed in an incompatible way.

<dl>
  <dt><b>2.0</b> (10-Feb-97)
  <dd>New native Win32 version.
      <br>Wildcards allowed in filenames on Mac.
      <br>Ignores browser "-".
  <dt><b>1.93beta</b> (18-Jan-97)
  <dd>New commands <kbd>BROWALIAS</kbd>, <kbd>CONFIGFILE</kbd> and
      <kbd>PROGRESSFREQ</kbd>.
      <br>Form program can now call configuration files.
      <br>Form program now uses the default choices if none specified.
      <br>Domain report prints correctly in preformatted output.
      <br>Specifying +1 and +V2 doesn't crash the program.
      <br>+v reports dates correctly.
      <br>Trailing dots on hostnames removed.
      <br>Second argument to <kbd>LOGFILE</kbd> command can't be obliterated
      by <kbd>/../</kbd>
  <dt><b>1.92beta</b> (08-Oct-96)
  <dd>DNS lookups added on Mac.
      <br>Netpresenz format understood on Mac.
      <br>New languages: Spanish, Italian and Danish.
      <br>Extra information when <a href="#DEBUG">debugging</a> turned on.
      <br><code>*.htm</code> are now pages on all machines.
      <br>A few small bugs fixed.
  <dt><b>1.91beta4</b> (13-Jul-96)
  <dd>Cache file now includes page request information.
      <br>DNS bug fixed.
      <br>New command <kbd>DNSHASHSIZE</kbd>.
      <br>Bug in browser reports fixed.
  <dt><b>1.91beta3</b> (09-Jul-96)
  <dd>BSD/OS compilation bug believed fixed.
      <br>Fixed HOSTALIAS which I broke yesterday.
      <br>DNS bug (causing too many lookups) identified,
      although not yet fixed.
  <dt><b>1.91beta2</b> (08-Jul-96)
  <dd>Some bug fixes (including: <kbd>HOSTEXCLUDE</kbd> and <kbd>CASE
      INSENSITIVE</kbd> didn't work properly; selecting &quot;no links&quot;
      failed on the form; less fussy about what can appear on the form).
      <br>Mac version no longer includes source code, so is much shorter.
  <dt><b>1.91beta1</b> (05-Jul-96)
  <dd>Now DNS code doesn't look up a name twice, even if one is a failed
      request.
  <dt><b>1.91beta</b> (05-Jul-96)
  <dd>Will now output in any of several languages.
      <br>Preformatted output introduced.
      <br>New File Type Report.
      <br>Can limit the number of rows in the time reports.
      <br>Number of requests for pages (as opposed to raw requests) now
      calculated throughout.
      <br>DNS lookup returns, with cacheing across runs.
      <br>Logfiles can include wildcards.
      <br>Wildcards can include multiple *'s.
      <br>Can process case insensitive logfiles.
      <br><kbd>OUTPUTALIAS</kbd> commands introduced.
      <br>New commands to specify exactly what is included, and what linked, in
      the request report and referrer report.
      <br><tt>FILEALIAS a a</tt> and <tt>FILEALIAS a b; FILEALIAS b c</tt>
      now work.
      <br>New ALLOW options to cancel INCLUDES.
      <br>REPSEPCHAR and DECPOINT introduced.
      <br>DIRSUFFIX introduced.
      <br>Debugging reports number of corrupt lines in other logs.
      <br>Hash sizes can now be allocated at run time.
      <br>stdin can now be used for any input file, but not for two.
      <br>Macintosh version now quits automatically if no warnings have been
      issued.
      <br>Form interface made more secure.
      <br>&quot;Mozilla (compatible)&quot; separated out in Browser Summary.
      <br>Major internal changes should improve speed.
      <br>Code for non-Unix platforms integrated into main code.
      <br>&quot;Referrer&quot; spelled correctly.
      <br><a href="#LICENCE">Licence</a> introduced.
      <br>Update file introduced.
      <br>Readme updated to include non-Unix instructions.
  <dt><b>(19-Apr-96)</b>
  <dd>First Mac version.
  <dt><b>1.9beta6</b>
  <dd>Two bug fixes (number of bytes was incorrectly reported in some cases,
      and <kbd>-v</kbd> would overwrite the <kbd>OUTFILE</kbd>).
      <br>Documentation improved.
  <dt><b>1.9beta5</b>
  <dd>More bug fixes...
  <dt><b>1.9beta4</b>
  <dd>One important bug fix (I broke <kbd>GRAPHICAL OFF</kbd> in 1.9beta3).
      <br>New form cgi options: <kbd>ch</kbd>, <kbd>gr</kbd> and
      <kbd>ou=3</kbd>.
      <br>Code shortened.
  <dt><b>(05-Mar-96)</b>
  <dd>First DOS version.
  <dt><b>1.9beta3</b>
  <dd>Mainly bug fixes and improved documentation.
      <br>Browser and referer reports now include failed requests.
      <br>The <kbd>WARNINGS</kbd> option can now be specified on the form.
  <dt><b>1.9beta2</b>
  <dd>Small bug fixes
  <dt><b>1.9beta</b> (06-Feb-96)
  <dd>Lots of changes. The most important new features are
      <ul>
	<li>Six new reports (hourly report, browser report, browser summary,
	    referer report, status code report and error report).
	<li>Analysis of NCSA/Apache referer log, agent log and combined log
	    formats.
	<li>Graphical time reports that still work on text-based browsers.
	<li>Configurable columns in the time reports.
	<li>Time reports can run backwards.
	<li>Time graphs can be plotted by bytes instead of by requests.
	<li>Can cache old data so that old logfiles need not be kept.
	<li>Can process several logfiles.
	<li>Can combine logfiles from several different hosts.
	<li>Will uncompress compressed logfiles.
	<li>All configuration options can now be specified on the commandline.
	<li>Mandatory configuration file added.
	<li>Lots of new options in the form processing program.
	<li>Wildcards greatly improved throughout.
	<li>Alphabetical host report right-aligned.
	<li>Bytes now quoted as MBytes etc. instead of long number.
	<li>Produces HTML2.0 compliant output.
	<li>New sort method <kbd>RANDOM</kbd> (saves time for long reports).
	<li>Floors for reports now work properly.
	<li>Can now specify a report <kbd>FROM</kbd> 100 or more days ago.
	<li>Option to turn off warnings.
	<li>Considerable savings in code length over previous versions.
      </ul>
      As far as possible the options are backwards compatible with previous
      versions, but some changes have been necessary.
      <ul>
	<li>Commandline options <kbd>+1</kbd>, <kbd>+c</kbd>,
	    <kbd>+f</kbd>, <kbd>+F</kbd>, <kbd>+G</kbd> and
	    <kbd>+H</kbd> removed or given new meanings.
	<li>Options to <kbd>+d</kbd>, <kbd>+D</kbd>, <kbd>+h</kbd>,
	    <kbd>+i</kbd>, <kbd>+m</kbd>, <kbd>+o</kbd>,
	    <kbd>+r</kbd>, <kbd>+S</kbd> and <kbd>+W</kbd> changed.
	<li><kbd>BACKGROUND</kbd> and <kbd>NUMLOOKUP</kbd> removed.
	<li><kbd>FILEINCLUDE</kbd> and <kbd>FILEEXCLUDE</kbd> must
	    now be used in place of <kbd>FILEONLY</kbd> and
	    <kbd>FILEIGNORE</kbd>; similarly for <kbd>HOST</kbd> options.
	<li>Syntax for wild <kbd>ALIAS</kbd> matching changed.
	<li>Use <kbd>DOMMINREQS</kbd> and <kbd>DOMMINBYTES</kbd>
	    instead of <kbd>DOMFLOOR</kbd>; similarly for the other reports.
	<li>Use <kbd>REQUESTS</kbd> and <kbd>BYTES</kbd> instead of
	    <kbd>BYREQUESTS</kbd> and <kbd>BYBYTES</kbd> in the
	    <kbd>SORTBY</kbd>s.
	<li>The configuration files and commandline arguments are now
	    read in a different order. This shouldn't cause any trouble for
	    most people. The system configuration file is now always read
	    unless explicitly excluded with <kbd>-G</kbd>.
      </ul>
</dl>
<hr>
<dl><dt><b>1.2.6</b>
  <dd>Minor bug fix; will only affect those with corrupt logfiles.
  <dt><b>1.2.5</b>
  <dd>Minor bug fix for weekly report.
  <dt><b>1.2.4</b>
  <dd>Patch for Spyglass server logfile format.
  <dt><b>1.2.3</b>
  <dd>A couple of bug fixes (wild subdomains sometimes caused crashes).
      <br><kbd>-v</kbd> option now gives the version number.
  <dt><b>1.2.2</b>
  <dd>Patch for proxy servers: <kbd>http://</kbd> not translated to
      <kbd>http:/</kbd>
  <dt><b>1.2</b> (11-Nov-95)
  <dd>Can configure columns in reports to give percentage requests and number
      of bytes.
      <br>Wild subdomains (e.g., *.com).
      <br>Nameless subdomains.
      <br>Subdomains now listed in alphabetical order.
      <br>Proper support for numerical hostnames in <kbd>HOSTIGNORE</kbd>,
      <kbd>HOSTONLY</kbd>, <kbd>SUBDOMAIN</kbd> and alphabetical sorting.
      <br>New <kbd>BASEURL</kbd> command allowing statistics to be
      displayed on other servers.
      <br>Output always says how things are sorted.
      <br>"Last 7 days" now behaves sensibly with <kbd>TO</kbd>.
      <br>Filenames containing <kbd>/../</kbd>, <kbd>/./</kbd> and
      <kbd>//</kbd> translated.
      <br>Header and footer options removed from form (for security reasons).
  <dt><b>1.1</b> (02-Oct-95)
  <dd><a href="#FORM">Form interface</a> introduced.
      <br>ASCII output now possible as well as HTML.
      <br>Output file can now be specified in the configuration file.
      <br><kbd>FROM</kbd> and <kbd>TO</kbd> commands more powerful.
      <br><kbd>DEBUG</kbd> and <kbd>BACKGROUND</kbd> introduced.
      <br>One bug fix: alphabetical sorting doesn't now swap some hostnames.
      <br>List of primes included in distribution.
  <dt><b>1.0</b> (12-Sep-95)
  <dd>Only minor changes since 0.94beta.
  <dt><b>0.94beta</b> (30-Aug-95)
  <dd>New configuration variables <kbd>SEPCHAR</kbd> and <kbd>REPORTORDER</kbd>.
      <br>New configuration commands <kbd>WITHARGS</kbd> and <kbd>WITHOUTARGS</kbd>.
      <br>New commandline options <kbd>+-A</kbd> and <kbd>+-x</kbd>. (Config.: <kbd>ALL</kbd> and <kbd>GENERAL</kbd>).
      <br>Logfile entries with - as the return code are now regarded
      as successes, not corrupt entries.
      <br>Fixed bugs in host report when aliases or numerical hosts are present.
      <br>Documentation rewritten.
  <dt><b>0.93beta</b> (27-Jul-95)
  <dd>Approximate hostname counting now possible in fixed memory.
      <br>New configuration commands <kbd>ISPAGE</kbd> and
      <kbd>ISNOTPAGE</kbd>.
      <br>New commandline option <kbd>-v</kbd>.
      <br>New configuration command <kbd>WEEKBEGINSON</kbd>.
      <br>Proper error message when memory exceeded.
      <br>Program split into several files.
  <dt><b>0.92beta</b> (11-Jul-95)
  <dd>New reports introduced: hostname, full daily, and weekly.
      <br><kbd>FROM</kbd> and <kbd>TO</kbd> commands introduced.
      <br>Header and footer files introduced.
      <br>More helpful warning messages.
      <br>Ability to read configuration instructions from stdin.
      <br>Subdomain commands moved from domains file to configuration file.
      <br>Makefile provided.
  <dt><b>0.91beta</b> (04-Jul-95)
  <dd>Configuration file introduced, enabling many new options.
      <br>Some bug fixes and speed improvements.
      <br>Ability to print "top n" reports (rather than
      "everything higher than n").
      <br>Request report can print only pages.
      <br>Ability to try and resolve numerical addresses.
      <br>Now less fussy about the format of the <a HREF="#DOM">domains
      file</a>.
      <br>Logo added.
      <br>Readme converted to HTML.
  <dt><b>0.9beta</b>
  <dd>More speed improvements, and some bug fixes.
      <br>Introduced <kbd>-u</kbd> option.
      <br>Introduced subdomain analysis.
      <br>Included "not modified" replies as successes, not redirects.
      <br>First public release at 0.9beta3. (29-Jun-95)
  <dt><b>0.89beta</b> (21-Jun-95)
  <dd>Commandline arguments.
      <br>Efficiency improvements.
      <br>Host count and "last 7 day" statistics.
  <dt><b>0.8beta</b> (14-Jun-95)
  <dd>Initial program, just default options.
</dl>

<hr>
<h2><a name="RUN">Compiling and running the program</h2>

<p>
This section describes how to compile analog on Unix and VMS. If you've got
the Mac or DOS version, the program comes already compiled, so you can <a
href="#CUSTOM">skip to the next section</a>.

<p>
If you want to get on with trying out the program straight away, you can
leave most of this Readme until another time. The one thing you need to do
is to look at the file analhead.h. These are all user-settable options, but
most of them you can leave alone for the moment. You will probably want to
check the first few options in the file, but you can even leave most of them
until later.

<p>
Next you must move the images that came with the analog program (in the
directory images) into the IMAGEDIR specified in analhead.h.

<p>
When you have done that, compile the program by typing
<pre>
make
</pre>
under Unix, or
<pre>
MMS
</pre>
using MMS under VMS. If that doesn't work, and you're on Unix,
have a look in the Makefile to see if there's anything
that you need to change to suit your configuration, and try again.
In particular, Solaris 2 users need to change the <kbd>LIBS=</kbd> line.
If you haven't got gcc, you will need to change the compiler - try acc or cc
instead. If it still doesn't compile, try <kbd>DEFS=-DNODNS</kbd> to ignore the
DNS lookup code.

<p>
Then just type
<pre>
analog
</pre>
to run the program. To send the output to a particular file instead of to
the screen, type, e.g.,
<pre>
analog > outfile.html
</pre>
(This assumes that . is in you <kbd>$PATH</kbd>, but it should be. Otherwise
try <kbd>./analog</kbd> instead of just <kbd>analog</kbd>).

<hr>
<h2><a name="CUSTOM">Customising analog</h2>

Pretty soon you will want to customise the output of analog to your personal
preferences. How to do that is explained in this section. There are lots of
options, so this section is rather long. But you won't want all the options
straight away, so don't panic!

<p>
Many options can be set in the file <b>analhead.h</b>. If you're on Unix
or VMS (or compiling your own version on another platform), these can be
changed before compiling the program. They are explained in that file, so
they will not be documented again here.

<p>
Otherwise, analog takes its options from <b>configuration files</b>.
Many of the configuration commands also have abbreviations as <b>commandline
arguments</b>. Don't get configuration commands mixed up with #define
statements in the header file!
(There aren't any commandline arguments on the Mac; you have
to use the configuration commands. Ignore all talk of commandline arguments
below). 

<p>
So, for example, the configuration command
<pre>
DAILY OFF
</pre>
tells analog not to include a daily summary in the output. But this can also
be specified by the command
<pre>
analog -d
</pre>
because the <kbd>-d</kbd> option is an abbreviation for <kbd>DAILY
OFF</kbd>.
<p>
<a name="PLUSC">In fact</a> any configuration command can be
specified on the
commandline by means of the <kbd>+C</kbd> option; you could write
<pre>
analog +C"DAILY OFF"
</pre>
(This is most useful for running analog from a script or cron job).

<p>
Analog comes with a small configuration file to get you started.
To specify a configuration file, you use the commandline argument
<kbd>+g</kbd> followed by the name of the file. (Mac users have no commandline
arguments, so can only use the
<a href="#OCONFIG">default configuration file</a>). For example,
<pre>
analog +gextra.conf
</pre>
tells analog to read configuration commands from the file
<kbd>extra.conf</kbd>. (Note that there is no space between <kbd>+g</kbd>
and the filename; this is true of all commandline arguments).
(You can also specify standard input as the configuration file by
the option <kbd>+g-</kbd>).

<p>
The configuration
file can contain several commands on separate lines; any text after a hash
(<kbd>#</kbd>) on a line is ignored as a comment. So the following is an
example of a configuration file.
<pre>
DAILY      OFF   # We don't want a daily summary
FULLDAILY  ON    # We want a full daily report instead 
</pre>
An argument to a command can be placed in single or double quotes, and it must
be if the argument contains a hash or a space. Note that configuration commands
are not generally the same as those in analhead.h, although many have the same
name.

<p>
Commandline arguments are read in the order in which they occur, and
configuration files are read when the <kbd>+g</kbd> argument is reached.
If commands conflict, later commands override earlier ones, so the order
does matter.

<p>
<a name="OCONFIG">There</a> are also two special configuration files which
can be specified in
analhead.h. The <b>default configuration file</b> is run before all other
configuration files. You can put in there configuration commands that you
normally want to include but which you can override. You can stop analog
running the default configuration file by the commandline option
<kbd>-G</kbd>.

<p>
The <b>mandatory configuration file</b> is run <i>after</i> all other
configuration commands have been read, and overrides them all. If the
mandatory configuration file
cannot be found, the program exits immediately. This can be used by system
administrators to stop users analysing certain files or producing certain
reports, for example. (Note, however, that the only way to stop it completely
is to deny users read access to the logfile. Otherwise there is nothing to
stop them analysing it by another copy of analog or another program).

<p>
If this is all a bit confusing, just run
<pre>
analog -v [other options]
</pre>
That will tell you what the values of all the variables will be, based on
analhead.h, the configuration options and the commandline options. 

<p>
We shall now look at all the configuration commands and their commandline
equivalents under the following headings. There is a summary list of all of
them in the <a href="#REF">reference</a> section.
<ul>
  <li><a href="#CUSGEN">General summary</a>
  <li><a href="#CUSTIM">Time reports</a>
  <li><a href="#CUSOTH">Other reports</a>
  <li><a href="#CUSERR">Error and status code reports</a>
  <li><a href="#CUSLOG">What to analyse</a>
  <li><a href="#CUSALI">Aliases etc.</a>
  <li><a href="#CUSCAC">Cache files</a>
  <li><a href="#CUSDNS">DNS lookups</a>
  <li><a href="#CUSMISC">Miscellaneous options</a>
</ul>

<hr width=80% align=left>
<h3><a name="CUSGEN">General Summary</a></h3>

Program started at Mon-26-Jun-1995 17:09 local time.
<br>Analysed requests from Thu-28-Jul-1994 20:31 to Mon-26-Jun-1995 17:09
(332.8&nbsp;days).
<br><b>Total successful requests:</b> 368 063 (12 872)
<br><b>Average successful requests per day:</b> 1 219 (2 121)
<br><b>Total successful requests for pages:</b> 142 422 (4 971)
<br><b>Total failed requests:</b> 4 089 (139)
<br><b>Total redirected requests:</b> 35 277 (1 838)
<br><b>Number of distinct files requested:</b> 966 (336)
<br><b>Number of distinct hosts served:</b> 28 589 (1 589)
<br><b>Number of new hosts served in last 7 days:</b> 1 037
<br><b>Corrupt logfile entries:</b> 869
<br><b>Total data transferred:</b> 1 766 Mbytes (83 743 kbytes)
<br><b>Average data transferred per day:</b> 5 415 kbytes (11 963 kbytes)
<br>(Figures in parentheses refer to the last 7 days).

<p>
See the <a href="#REF">Glossary</a> for the meaning of these data.
<p>
The general summary can be turned off by the command
<pre>
GENERAL OFF
</pre>
(or the commandline argument <kbd>-x</kbd>) or on by <kbd>GENERAL ON</kbd>
(or <kbd>+x</kbd>). If the general summary is
off, all the `Go To' links in the output are also omitted.

<p>
The figures in parentheses refer to the last 7 days. They can be turned on
and off with
<pre>
LASTSEVEN ON    # or OFF
</pre>
or with the commandline arguments <kbd>+7</kbd> and <kbd>-7</kbd>.
Note that the last 7 days refers to the last 7 days before the program is run,
not before the last entry in the logfile. (If a
<kbd><a href="#FROMTO">TO</a></kbd> command is
specified, however, the last 7 days will be until that date).

<p>
<a name="COUNTHOSTS">Counting</a> hosts is something which can take a lot of
memory (we have to remember
the name of every host that has accessed our server). If memory is a problem,
you can turn the host counting off with the commandline option
<kbd>-s</kbd> or the configuration command
<pre>
COUNTHOSTS OFF
</pre>
Alternatively, you can do an approximate host count in a fixed (pre-specified)
amount of memory. You do this by using <kbd>+ss</kbd> or
<pre>
COUNTHOSTS APPROX
</pre>
and you can specify the amount of memory to be used by
<pre>
APPROXHOSTSIZE 100000  # or whatever number, in bytes
</pre>
About 3 bytes per host seems to give a very good estimate. Even 1 byte per
host will give a fair estimate. If statistics for the last 7 days are on,
twice this amount of space will be used. <kbd>COUNTHOSTS APPROX</kbd> uses
much less memory than an accurate count, but can be a bit slower. If the
host report is on, <kbd>COUNTHOSTS</kbd> will always be turned on
automatically, so to turn <kbd>COUNTHOSTS</kbd> to off or approximate, you also
need to turn the host report off.


<hr width=80% align=left>
<h3><a name="CUSTIM">Time reports</a></h3>
<p>Each unit (<tt><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar1.gif" alt="+"></tt>) represents 4 000 requests, or part thereof.

<pre width=65><tt>
   month:  #reqs: 
--------  ------  
Nov 1995: 119865: <img src="http://www.statslab.cam.ac.uk/~sret1/images/bar16.gif" alt="++++++++++++++++++++++++++++++"><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar8.gif" alt=""><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar4.gif" alt=""><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar2.gif" alt="">
Dec 1995: 121214: <img src="http://www.statslab.cam.ac.uk/~sret1/images/bar16.gif" alt="+++++++++++++++++++++++++++++++"><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar8.gif" alt=""><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar4.gif" alt=""><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar2.gif" alt=""><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar1.gif" alt="">
Jan 1996: 144960: <img src="http://www.statslab.cam.ac.uk/~sret1/images/bar32.gif" alt="+++++++++++++++++++++++++++++++++++++"><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar4.gif" alt=""><img src="http://www.statslab.cam.ac.uk/~sret1/images/bar1.gif" alt="">
</tt></pre>

<p>
The above display is of a monthly report. In this category, we also have
the weekly report (one line for each week), daily summary (one line for
Sundays, one for Mondays etc.), daily report (one line for each
day ever), hourly summary (one line for midnight, one for 1am etc.) and
hourly report (one line for each hour ever).

<p>
The following configuration commands show how to turn these reports on and off.
<pre>
MONTHLY ON
WEEKLY  ON
DAILY   ON
FULLDAILY OFF
HOURLY ON
FULLHOURLY OFF
</pre>
You can also use the corresponding commandline arguments <kbd>+m</kbd>,
<kbd>+W</kbd>, <kbd>+d</kbd>, <kbd>-D</kbd>, <kbd>+h</kbd>,
<kbd>-H</kbd> (use <kbd>+</kbd> to turn the corresponding reports on,
<kbd>-</kbd> to turn them off).

<p>
You can specify the maximum number of rows in one of these reports by a
line like
<pre>
FULLHOURROWS 72   # restrict the hourly report to the last 72 hours
MONTHROWS 0       # 0 means no restriction
</pre>
The other commands are <kbd>WEEKROWS</kbd> and <kbd>FULLDAYROWS</kbd>.

<p>
You should use these reports sensitively. If your output is 500k long, people
won't be able to download it. In particularly, you probably don't want a
daily report or hourly report unless you have restricted it to just a few
rows.

<p>
<a name="GRAPHICAL">The</a> graphs above are designed to produce coloured bars
on graphical
browsers and ASCII graphs on non-graphical browsers. They don't use tables
or image-stretching properties, so should work on any browser. However, you
can produce plain ASCII graphs instead by the command
<pre>
GRAPHICAL OFF    # or ON to turn it back on again
</pre>
This has the advantage of producing smaller output which does not require
any images to be downloaded.

<p>
The graphs rely on having the images distributed with analog available in
the directory <kbd>IMAGEDIR</kbd> specified in analhead.h; or you
can override that choice with a command like
<pre>
IMAGEDIR /Images/
</pre>

<p>
<a name="MARKCHAR">You</a> can change the character used in the graphs on
non-graphical terminals by means of a command such as
<pre>
MARKCHAR '#'  # put in quotes so that it isn't a comment
</pre>

<p>
<a name="GRAPH">The</a> graphs can be plotted by bytes transferred or requests
for pages instead of by raw requests. This can be done by means of commands
like
<pre>
MONTHGRAPH B    # by bytes
WEEKGRAPH  R    # by requests
DAYGRAPH   P    # by page requests
</pre>
There are also commands <kbd>FULLDAYGRAPH</kbd>,
<kbd>HOURGRAPH</kbd> and <kbd>FULLHOURGRAPH</kbd>. Alternatively, you can
add the letter after the relevant commandline argument; for example,
<kbd>+hB</kbd> to turn on the hourly summary with a graph sorted by bytes.
To specify what counts as a page, see the <a
href="#ISPAGE"><kbd>ISPAGE</kbd></a> command below. These commands do not
change which columns are displayed on each line, so if you use these
commands, you might also want to use the <kbd><a href="#COLS">COLS</a></kbd>
commands explained below.

<p>
<a name="BACK">You</a> can display the graphs backwards (with most recent
requests at the top) by means of commands like
<pre>
MONTHLYBACK ON  # or OFF
</pre>
There are also the commands <kbd>WEEKLYBACK</kbd>,
<kbd>FULLDAILYBACK</kbd> and <kbd>FULLHOURLYBACK</kbd>. The hourly summary
and daily summary cannot be displayed backwards. I find it confusing to have
some of the reports going backwards and some forwards, so you can also use
<pre>
ALLBACK ON  # or OFF
</pre>
to change all four of the reports to backwards or forwards together.

<p>
<a name="COLS">You</a> can specify which columns appear in the various reports
in which order.
The <a href="#CUSTIM">above example</a> showed the number of requests being
given. You can also have the percentage of the requests, the number and
percentage of bytes, and the number and percentage of requests for pages.
For example, the command
<pre>
MONTHCOLS RBbrpP
</pre>
tells analog to include in the monthly report columns for number of requests
(R), number of bytes (B), percentage of bytes (b), percentage of requests (r),
percentage of page requests (p) and number of page requests (P) in that
order. The other commands are <kbd>WEEKCOLS</kbd>,
<kbd>DAYCOLS</kbd>, <kbd>FULLDAYCOLS</kbd>, <kbd>HOURCOLS</kbd> and
<kbd>FULLHOURCOLS</kbd>. If you use these
commands, you might also want to use the <kbd><a href="#GRAPH">GRAPH</a></kbd>
commands explained above.

<p>
<a name="WEEKBEG">For</a> some reports, analog needs to know where weeks
begin and end. You can specify
<pre>
WEEKBEGINSON WEDNESDAY
</pre>
to change it to Wednesday, for example. (I guess Sunday or Monday is more
likely).

<p>
<a name="UNIT">In</a> the graphs, analog will choose the value of the unit
(<tt><img
src="http://www.statslab.cam.ac.uk/~sret1/images/bar1.gif" alt="+"></tt>)
automatically based on the length of the largest bar and the width of the
page. You can specify the page width with, for example,
<pre>
PAGEWIDTH 70
</pre>
or the commandline option <kbd>+w70</kbd>. (I find about 65 works well).
(Note that the <kbd>PAGEWIDTH</kbd> may not be strictly obeyed with <kbd><a
href="#GRAPHICAL">GRAPHICAL ON</a></kbd>, as the graphics are measured in
pixels not characters).
Occasionally you may want to specify the value of <tt><img
src="http://www.statslab.cam.ac.uk/~sret1/images/bar1.gif" alt="+"></tt>
yourself (for example, to make it the same as on some other page). You can
do this by a command like
<pre>
MONTHLYUNIT 1000
</pre>
Setting it to 0 makes analog choose it automatically again. Of course, the
other reports have <kbd>WEEKLYUNIT</kbd>, <kbd>DAILYUNIT</kbd>,
<kbd>FULLDAILYUNIT</kbd>, <kbd>HOURLYUNIT</kbd> and
<kbd>FULLHOURLYUNIT</kbd>.

<hr width=80% align=left>
<h3><a name="CUSOTH">Other reports</a></h3>
This section discusses the following reports.

<p>
<b>Domain report</b>
<pre>
  #reqs :  %bytes : domain
--------  --------  ------
 103125 :  46.58% : .uk (United Kingdom)
( 64982):( 35.45%):     cam.ac.uk (University of Cambridge)
( 47138):( 20.55%):       statslab.cam.ac.uk
  49290 :  12.49% : .edu (USA Educational)
</pre>

<p>
<b>Host report</b>
<pre>
#reqs: %bytes: host
-----  ------  ----
   10:  0.03%:          zlsm03.arcs.ac.at
   11:  0.04%:           iki10.boku.ac.at
  158:  0.15%:       talus.maths.su.oz.au
</pre>

<p>
<b>Directory report</b>
<pre>
#reqs: %bytes: directory
------  ------  ---------
237985: 35.40%: /~sret1/
 18596: 17.60%: /~rrw1/
  3574: 11.89%: /~richard/
</pre>

<p>
<b>Request report</b>
<pre>
#reqs: %bytes: filename
-----  ------  --------
33980: 23.66%: <a HREF="http://www.statslab.cam.ac.uk/~sret1/backgammon/main.html">/~sret1/backgammon/main.html</a>
21162:  2.69%: /~sret1/backgammon/bitmaps/board.xbm
12690:  0.86%: <a HREF="http://www.statslab.cam.ac.uk/">/</a>
</pre>
<p>
<b>File Type report</b>
<pre>
 #reqs: %bytes: extension
------  ------  ---------
 25592: 35.68%: .html
 23311: 20.15%: (directories)
  1080: 17.13%: .ps
175575: 13.63%: .gif
</pre>
<p>
<b>Referrer report</b>
<pre>
#reqs: referring URL
-----  ------------
  260: http://webcrawler.com/cgi-bin/WebQuery
  239: <a HREF="http://www.yahoo.com/Computers_and_Internet/Internet/World_Wide_Web/Servers/Log_Analysis_Tools/">http://www.yahoo.com/Computers_and_Internet/Internet/World_Wide_Web/Servers/Log_Analysis_Tools/</a>
  185: http://guide-p.infoseek.com/WW/NS/Titles?qt=backgammon&amp;col=WW
  149: <a HREF="http://www.yahoo.com/Recreation/Games/Board_Games/Backgammon/">http://www.yahoo.com/Recreation/Games/Board_Games/Backgammon/</a>
</pre>

<p>
<b>Browser summary</b>
<pre>
#reqs: browser
-----  -------
16797: Mozilla
 1532: Mosaic
  693: IWENG
  492: Lynx
</pre>

<p>
<b>Browser report</b>
<pre>
#reqs: browser
-----  -------
 3105: Mozilla/1.22 (Windows; I; 16bit)
 2785: Mozilla/1.1N (Windows; I; 16bit)
  458: IWENG/1.2.003
</pre>

<p>
These reports can be turned on and off with commands like
<pre>
DOMAIN    ON
FULLHOSTS OFF
DIRECTORY ON
REQUEST   ON
FILETYPE  ON
REFERRER  OFF
BROWSER   ON
FULLBROWSER  OFF
</pre>
or with the commandline arguments <kbd>+o</kbd> (domain report),
<kbd>-S</kbd> (host report), <kbd>+i</kbd> (directory report),
<kbd>+r</kbd> (request report; see below), <kbd>+t</kbd> (file type report),
<kbd>-f</kbd> (referrer report), <kbd>+b</kbd> (browser summary) and
<kbd>-B</kbd> (browser report). (As in the date reports, use
<kbd>+</kbd> to turn the
corresponding reports on, <kbd>-</kbd> to turn them off).
Because of the widespread mis-spelling, <kbd>REFERER</kbd> is accepted as a
synonym of <kbd>REFERRER</kbd>.

<p>
Another similarity with the date reports is that you can tell analog which
columns to print on each report with the commands <kbd>DOMCOLS</kbd>,
<kbd>HOSTCOLS</kbd>, <kbd>DIRCOLS</kbd>, <kbd>REQCOLS</kbd>,
<kbd>TYPECOLS</kbd>, <kbd>REFCOLS</kbd>, <kbd>BROWCOLS</kbd> and
<kbd>FULLBROWCOLS</kbd>. Again, each command is followed by letters indicating
which columns are wanted and in which order. For example,
<pre>
DOMCOLS RrBb  # no. of reqs, %age reqs, no. of bytes, %age bytes
DIRCOLS Pp    # no. of pages, %age pages
</pre>

<p>
<a name="SORTBY">Each</a> of these reports can be sorted in five different
ways; by bytes, by requests, by requests for pages, alphabetically or randomly
(i.e., unsorted). (The only advantage
of the last one is so as not to spend time sorting very long reports). The
commands to change this look like
<pre>
DOMSORTBY BYTES  # or REQUESTS or PAGES or ALPHABETICAL or RANDOM
</pre>
The commands for the other reports are <kbd>HOSTSORTBY</kbd>,
<kbd>DIRSORTBY</kbd>, <kbd>REQSORTBY</kbd>, <kbd>TYPESORTBY</kbd>,
<kbd>REFSORTBY</kbd>, <kbd>BROWSORTBY</kbd> and
<kbd>FULLBROWSORTBY</kbd>.
You can also add a letter <kbd>b</kbd>, <kbd>p</kbd>, <kbd>r</kbd>,
<kbd>a</kbd> or <kbd>x</kbd> after the relevant commandline option; for
example, <kbd>+Sa</kbd> for a host report sorted alphabetically.

<p>
<a name="CUSFLOOR">It</a> is important to be able to specify how many entries
you want printed in each report. This is done by means of three variables for
each report, one specifying the minimum number of bytes if the sorting is by
bytes, one the minimum number of page requests if it is by pages, and the third
specifying  the minimum number of requests if the sorting is by any of the
other three methods. The following configuration commands illustrate the
possible usages.
<pre>
DOMMINREQS 20      # all items with at least 20 requests
HOSTMINREQS -20    # the first 20 items
                   # NB: useless if alphabetical or random sort
REQMINREQS 0.01%   # all items with at least 0.01% of the requests
TYPEMINPAGES 20    # at least 20 page requests; -20 and 0.01% also possible
DIRMINBYTES 100000 # all items with at least 100000 bytes
REFMINBYTES 100k   # all items with at least 100 kbytes
                   # (10M etc. also work)
BROWMINBYTES -40   # Top 40 if sorting is by bytes
FULLBROWMINBYTES 0.005%   # all with at least 0.005% of the traffic
</pre>
You can also specify the amount on the commandline by adding it after the
sort method. For example, <kbd>+Sr-50</kbd> turns on a host report, sorted
by requests, with only the top 50 items included, and <kbd>+ib20k</kbd>
gives a directory report, sorted by bytes, including all directories with at
least 20 kilobytes transferred.

<p>
<a name="OUTPUTALIAS">You</a> can translate items in the reports for the
benefit of your readers. For example, the command
<pre>
REQOUTPUTALIAS /~sret1/analog/ "Analog home page"
</pre>
would make <kbd>Analog home page</kbd> appear instead of
<kbd>/~sret1/analog/</kbd> in the request report. Wildcards can appear in
the aliases: for example
<pre>
REQOUTPUTALIAS /~sret1/* "Stephen's page (/*)"
</pre>
would translate <kbd>/~sret1/backgammon</kbd> to <kbd>Stephen's page
(/backgammon/)</kbd> etc. The commands for the other reports are
<kbd>DIROUTPUTALIAS</kbd>, <kbd>HOSTOUTPUTALIAS</kbd>,
<kbd>REFOUTPUTALIAS</kbd>, <kbd>BROWOUTPUTALIAS</kbd> and
<kbd>TYPEOUTPUTALIAS</kbd>.

<p>
<a name="HASHSIZE">Each</a> of the reports has a hash size associated with
it, which is the size of the table in which it stores the data internally. You
don't need to worry about this usually; it doesn't affect the output, but if
analog starts running slowly, you might find that making the hash sizes
larger or smaller helps. The command to do this for the request report is
<pre>
REQHASHSIZE 1009
</pre>
The command for the other reports are <kbd>DIRHASHSIZE</kbd>,
<kbd>TYPEHASHSIZE</kbd>, <kbd>HOSTHASHSIZE</kbd>, <kbd>REFHASHSIZE</kbd>,
<kbd>BROWHASHSIZE</kbd>, <kbd>FULLBROWHASHSIZE</kbd> and
<kbd>SUBDOMHASHSIZE</kbd> (for subdomains; the top-level domains don't use
this). On appropriate platforms, there is also <kbd>DNSHASHSIZE</kbd> for <a
href="#CUSDNS">DNS lookups</a>.
You must choose a prime number for the hash size
(there's a list of some primes distributed with the program). Maybe half the
number of items of that type expected is a good number, but it shouldn't be
critical.

<p>
We now describe features unique to a particular one of the reports.
<a name="CUSDOM">First</a> the <b>domain report</b>.

<p>
Subdomains can be specified for each domain. The syntax of the command is
<pre>
SUBDOMAIN subdomain subdomain_name
</pre>
If the subdomain name has spaces in, it must be enclosed in quotes.
The subdomain name can be omitted, indicating a nameless subdomain.
For example, to produce the <a href="#CUSOTH">example above</a>, I would
include the following lines in the configuration file
<pre>
SUBDOMAIN cam.ac.uk 'University of Cambridge'
SUBDOMAIN statslab.cam.ac.uk
</pre>
Numerical subdomains (which have most significant part on the left)
can also occur. They will look like
<pre>
131   The Ever-Popular 131 domain
131.111   # Nameless
</pre>
Also subdomains with wildcards in can occur; they can't have names. The
following are examples:
<pre>
SUBDOMAIN *.edu       # mit.edu, umn.edu  etc.
SUBDOMAIN 131.111.*   # 131.111.1, 131.111.2 etc.
SUBDOMAIN %           # all top-level numerical domains, from 1 to 255
</pre>
The variables <kbd>SUBDOMMINREQS</kbd> and <kbd>SUBDOMMINBYTES</kbd> can
be specified in the same way as above, except they can't be negative.
If you ask for wild subdomains, you will probably want to set the minimum
requests and minimum bytes quite high.
However, you cannot alter the sort order; within a domain, subdomains will
always be output in alphabetical order.

<p>
There is a command <kbd>NOTSUBDOMAIN</kbd> to erase a previously requested
subdomain. For example, you can write
<pre>
NOTSUBDOMAIN *.edu
NOTSUBDOMAIN cam.ac.uk
</pre>
However, if you request, for example, <kbd>*.edu</kbd>, then
<kbd>NOTSUBDOMAIN mit.edu</kbd> will not override it.

<p>
The domain report relies on having a <a href="#DOM">domains file</a> available,
listing which geographical locations correspond to which domains. Which file
is to be used as the domains file can be specified by the command
<pre>
DOMAINSFILE domainsfile
</pre>
The correct format of the domains file is explained in a
<a href="#DOM">separate section.</a>

<p>
<a name="CUSHOST">There</a> is little to say about the <b>host report</b>,
except to
note that alphabetical sorting is by domain as most significant
part. This report can be very long and so slow to sort, and should be used with
a high floor if at all.

<p>
<a name="CUSDIR">The</a> <b>directory report</b> has one further variable,
which is the level
(or depth) of the directory report. The example above is a level 1 report; a
level 3 report might look like
<pre>
#reqs: %bytes: directory
------  ------  ---------
 43772: 72.06%: /~sret1/backgammon/
173426: 19.93%: /~sret1/backgammon/bitmaps/
 11298:  4.14%: /~sret1/
</pre>
This can be specified by the commandline option <kbd>+l3</kbd> or the
configuration command
<pre>
DIRLEVEL 3
</pre>
Note that the figures for each directory do not include those for the
subdirectories of that directory, except where the directory is at the
deepest level. So in the above example,
<kbd>/~sret1/backgammon/bitmaps/dice/d1.xbm</kbd> would be reckoned in the
directory <kbd>/~sret1/backgammon/bitmaps/</kbd> (which is at the deepest
level) but not in the other two directories.

<p><a name="CUSREQ">You can</a> control which items get listed, and which
linked to, in the request report with the commands <kbd>REQINCLUDE</kbd>
and <kbd>LINKINCLUDE</kbd>. These are explained <a href="#INCLUDE">below</a>.

<p>
<a name="BASEURL">There</a> is a command <kbd>BASEURL</kbd> to
specify a URL to prepend to the links. For example, if
<pre>
BASEURL http://www.statslab.cam.ac.uk
</pre>
were specified, then <kbd>/~sret1/analog/</kbd> would be linked to
<kbd>http://www.statslab.cam.ac.uk/~sret1/analog/</kbd>. This is useful
if you want to display the statistics on a different server than the one
they belong to. (See <a href="#CUSLOG">below</a> for combining logfiles from
two different servers).

<p>
There's nothing special to say about the file type report.

<p>
<a name="CUSREF">The</a> <b>referrer report</b> only has one special command,
REFLINKINCLUDE to say what should be linked to in the report. It is explained
<a href="#INCLUDE">below</a>. (However, it is important to note that many
browsers do not pass this information to the server, and many pass it wrongly
(sending the URL of the previous page even when your page was not reached by
selecting a link from that page)).

<p>
For the referrer report and the <b><a name="CUSBROW">browser reports</a></b>
the relevant logfiles must be present on 
the system (see <a href="#OTHERLOGS">below</a> for how to specify where they
are). Note that if you are using separate logfiles, rather than the NCSA
combined log, you cannot sort these reports by bytes, or include bytes columns
in the reports. Also the browser page requests will be inaccurate.

<p>
The browser summary and browser report have no special commands, but
it is <strong>important</strong> to note the limitations of these
reports. Some browsers even lie deliberately about
what sort of browser they are, or let users configure the browser name.
I have separated out those browsers that claim to be &quot;Mozilla
(compatible)&quot; but that doesn't catch all of them.
Furthermore, there is no fixed format for browser information. (NB: I have
combined all Mosaics as a special case). In addition, graphical browsers
automatically
generate more requests than non-graphical browsers by loading the graphics, so
it is not a very good guide to browser usage. For all these reasons many people
would argue that the browser reports are so unhelpful as to be worse than
useless. At best, interpret them with extreme caution.

<hr width=80% align=left>
<h3><a name="CUSERR">Error and status code reports</a></h3>

The error report lists all the errors found in your error log:
<pre>
#occs: error type
-----  ----------
19360: Send timed out
11286: Send aborted
 7962: File does not exist
</pre>
The status code
report lists how many of each type of status code occurred in your logfile:
<pre>
#occs: no. description
-----  ---------------
35564: 200 OK
  173: 301 Document moved
    3: 302 Document found elsewhere
 5732: 304 Not modified since last retrieval
</pre>
They are turned on and off by commands like
<pre>
STATUS ON
ERROR  OFF
</pre>
or by the commandline arguments <kbd>+c</kbd> and <kbd>-e</kbd>. (<kbd>+</kbd>
for on, <kbd>-</kbd> for off). There is
a command <kbd>ERRMINOCCS</kbd> which says how many occurrences of an error
there must be before it appears on the error report. For example
<pre>
ERRMINOCCS 20
</pre>

<hr width=80% align=left>
<h3><a name="CUSLOG">What to analyse</a></h3>

<p>
The first thing to know is how to specify a different logfile to analyse. A
default one should have been specified in analhead.h, but you can also specify
one by just putting its name on the commandline; so, for example, the command
<pre>
analog logfile.log
</pre>
will use that logfile for its report. Analog will read the common log format
(which most servers write) as well as the old NCSA format and the NCSA
combined log format (which includes referrer and agent information). Detection
of which format each line of the logfile is in is automatic.
You can also write
<pre>
analog -
</pre>
to use standard input as the logfile. (This is useful in constructing pipes).
You can also specify which logfile to use in the configuration file by means of
a command like
<pre>
LOGFILE logfile.log   # or stdin for standard input
</pre>
(This is the only method Mac users can use).
You can specify several logfiles on one configuration line by separating their
names with commas (no spaces). You can also use wildcards. For example
<pre>
LOGFILE log_96*,/logs/*/access_log.*
</pre>
If you make a very long list, you might need to split it in two (or increase
<code>MAXSTRINGLENGTH</code> in analhead.h).

<p>
Sometimes it is necessary to combine logfiles from two different servers,
without getting filenames that happen to be the same on both servers confused.
(This is particular useful if you're running several virtual hosts on the
same machine).
To do this you can use a second argument to the <kbd>LOGFILE</kbd> command,
specifying a prefix for each filename. For example
<pre>
LOGFILE log1,log2  http://www.a.com   # These logfiles from a.com
LOGFILE log3       http://www.b.com   # This one from b.com
</pre>
If you use this, the directory report will need specifying to a
<a href="#CUSDIR">deeper level</a>.

<p>
Logfiles specified in the user's configuration files and commandline options
replace any specified in the default configuration file, and are in turn
overridden by any in the mandatory configuration file. In addition you can use
<kbd>none</kbd> as the name of the logfile to overwrite the specification of
all previous logfiles.

<p>
<a name="OTHERLOGS">Analog</a> can also read the NCSA/Apache referrer log,
agent log and error log
formats. Logfiles of these types can be specified by commands like
<pre>
REFLOG   referer_log
BROWLOG  agent_log.old,agent_log
ERRLOG   error_log
</pre>
The same comments about which logfiles replace which apply as in the last
paragraph.
Analog can also read the NCSA/Apache combined log. This is just
specified as a <kbd>LOGFILE</kbd> as above; analog will automatically
recognise and parse the extra fields. Do not specify a combined log as
a <kbd>REFLOG</kbd> or <kbd>BROWLOG</kbd>.

<p>
<a name="CASE">You can</a> decide whether the filenames in the logfile should
be regarded as being case sensitive or case insensitive. The default is usually
to be case sensitive on Unix and case insensitive on other machines, but you
can override it if you want to read a logfile that was created on another
machine. The commands to do this are
<pre>
CASE INSENSITIVE
CASE SENSITIVE
</pre>
A note about reading logfiles created on other machines. Different machines
have different ways of storing files, in particular with regard to ends of
lines. If you are moving logfiles from one machine to another, they should
be transferred as text, not as binary data.

<p>
<a name="UNCOMPRESS">Analog</a> on Unix can uncompress compressed logfiles. You
need to tell it how to uncompress each type of file by supplying a command that
sends the uncompressed file to standard output (rather than uncompressing it
into a file). The file can be a list of type of files, separated by commas.
For example, depending what commands are on your system,
you can use
<pre>
UNCOMPRESS *.gz      "gunzip -c"  # or
UNCOMPRESS *.gz,*.Z  gzcat
</pre>
This would be a suitable command to include in the <a href="#OCONFIG">default
configuration file</a>. Note that if you are using the form interface, the
http server needs to have execute access to the decompression program.

<p>
<a name="ISPAGE">Several</a> times I've referred to `page requests'. You can
specify in the configuration file what should be counted as a `page'. At the
beginning, only <kbd>*.html</kbd>, <kbd>*.htm</kbd> and directories
(<kbd>*/</kbd>) are pages. The command
<pre>
ISPAGE filename
</pre>
will specify that some other file is a `page'. You can give a list of
filenames, separated by commas (without spaces). For example,
<pre>
ISPAGE *.ps,*.ps.gz
</pre>
would mean that Postscript files and gzipped Postscript files are to be
regarded as pages. You can also use
<pre>
ISNOTPAGE filename
</pre>
to specify that something which would otherwise be a page is not to be
regarded as a page.

<p>
<a name="INCLUDE">There</a> are various commands which instruct the program
to analyse only part of the logfile.
First, you can instruct the program only to take into account certain files.
This is done by means of the <kbd>FILEINCLUDE</kbd> and
<kbd>FILEEXCLUDE</kbd>
commands. Each command can have a list of filenames, separated by commas (no
spaces). One asterisk and any number of question marks can appear in each of
the filenames specified, as wildcards. Each file is included and excluded as
each new command is reached. Unspecified files are included if the first
command found was an exclusion, and excluded if the first command found was an
inclusion. For example, the configuration
<pre>
FILEINCLUDE /~sret1/*
FILEEXCLUDE /~sret1/backgammon/*,/~sret1/analog/*
FILEINCLUDE /~sret1/backgammon/*.gif
</pre>
would instruct the program to examine only my files, excluding my
backgammon and analog files, but including gifs in my backgammon directory.
On the other hand,
<pre>
FILEEXCLUDE /~sret1/*/img/*
</pre>
would analyse all files except images in my various directories. (Note that
wildcards with two *'s in can be slow to process).

<p>
Remember you can always run <kbd>analog
-v</kbd> to see what the options you have specified represent.

<p>
Included files can always be excluded later, but excluded files can't always be
included easily. (For example, after <kbd>FILEEXCLUDE /dir/*</kbd> and
<kbd>FILEEXCLUDE *.gif,*.jpg</kbd>, <kbd>FILEINCLUDE *.gif</kbd> would include
all gifs, even those in <kbd>/dir/</kbd>, which is not what is wanted). For
this reason, there is an extra command <kbd>FILEALLOW</kbd> which cancels an
exclude. It must be exactly the same as a previous <kbd>FILEEXCLUDE</kbd>; in
the above example <kbd>FILEALLOW *.gif</kbd> would work, but not <kbd>FILEALLOW
*if</kbd>.

<p>
Note that although you can exclude all gifs with <kbd>FILEEXCLUDE *.gif</kbd>,
this may not
be what you want to do. This will then exclude them from all the reports,
and not count the bytes transferred due to them. More likely, you just want to
exclude them from the request report while still including them in the other
reports, which you can do by means of
<kbd>REQEXCLUDE *.gif</kbd> (or <kbd>REQINCLUDE pages</kbd>) which will be
explained in a minute.

<p>
There are similar commands <kbd>HOSTINCLUDE</kbd>, <kbd>HOSTEXCLUDE</kbd>
and <kbd>HOSTALLOW</kbd>
to analyse only the requests from certain sites. For example,
<pre>
HOSTEXCLUDE emu.pmms.cam.ac.uk
HOSTEXCLUDE *.statslab.cam.ac.uk
</pre>
would ignore accesses from emu and from the whole of the statslab.

<p>
There are also commands <kbd>REFINCLUDE</kbd>, <kbd>REFEXCLUDE</kbd>
and <kbd>REFALLOW</kbd> for referrers. You probably want to ignore referrers
from your own site. For example, I use
<pre>
REFEXCLUDE http://www.statslab.cam.ac.uk/*
</pre>
This would be a suitable command to put in your <a href="#OCONFIG">default
configuration file</a>.

<p>
There are some other include commands that are specified the same way, but
behave slightly differently because they do not actually exclude something from
the analysis. So to specify what is included in the
<a href="#CUSREQ">request report</a>, there are commands <kbd>REQINCLUDE</kbd>,
<kbd>REQINCLUDE</kbd> and <kbd>REQALLOW</kbd>.
You can use the special name `pages' to mean all pages. So
for example,
<pre>
REQINCLUDE pages
REQINCLUDE *.ps
</pre>
will only include pages and Postscript files in the request report, although
other files will still be counted for the other reports. There are also
commands <kbd>LINKINCLUDE</kbd>, <kbd>LINKEXCLUDE</kbd> and
<kbd>LINKALLOW</kbd>, and <kbd>REFLINKINCLUDE</kbd>, <kbd>REFLINKEXCLUDE</kbd>
and <kbd>REFLINKALLOW</kbd> to say what should be linked to in the <a
href="#CUSREQ">request report</a> and <a href="#CUSREF">referrer report</a>.


<p>
<a name="FROMTO">Finally</a>, there are commands to analyse only a subset of
the dates in the logfile. The simplest usage is <kbd>FROM&nbsp;yymmdd</kbd>
and <kbd>TO&nbsp;yymmdd</kbd>. So, for example, to analyse only requests in
July 1995 I would use the configuration
<pre>
FROM 950701
TO   950731
</pre>
Also each of the pairs of digits can be preceded by <kbd>-</kbd> and the
month and date can by preceded by <kbd>+</kbd> to represent time relative
to the current date. This allows constructions like
<pre>
FROM -01-00+01   # from tomorrow last year
TO -00-0131  # to the end of last month (OK even if last month
             # didn't have 31 days)
FROM -00-00-112
TO   -00-00-01  #statistics for the last 16 weeks
</pre>
There are commandline abbreviations <kbd>+F</kbd> and <kbd>+T</kbd>
for these commands; for example <kbd>+T-00-00-01</kbd> looks at statistics
until the end of yesterday. <kbd>-F</kbd> and <kbd>-T</kbd> turn off the
from and to, as do <kbd>FROM OFF</kbd> and <kbd>TO OFF</kbd>.

<p>
If a <kbd>TO</kbd> command is given, the figures for the last 7 days refer
to the time until then.

<hr width=80% align=left>
<h3><a name="CUSALI">Aliases etc.</a></h3>

There are commands to give aliases for filenames, hostnames and referrers. The
configuration line
<pre>
FILEALIAS file1 file2
</pre>
says that whenever <kbd>file1</kbd> occurs in the logfile, it is to be
replaced by <kbd>file2</kbd>. Analog already understands that
<kbd>/dir/index.html</kbd> is the same as <kbd>/dir/</kbd> and translates
`escaped' entities (e.g., <kbd>%7E</kbd> is the same as&nbsp;<kbd>~</kbd>)
so these don't need to be specified separately. It also understands that
<kbd>..</kbd> means `parent directory,' <kbd>.</kbd> means `this directory'
and <kbd>//</kbd> is the same as <kbd>/</kbd>, and translates those
filenames to their canonical forms.

<p>
Actually, it's not quite true about <kbd>index.html</kbd>. You can make that
into another file if you want, by use of the <kbd>DIRSUFFIX</kbd> command.
For example, if all your directories return indexes called default.htm, you
could write
<pre>
DIRSUFFIX default.htm
</pre>

<p>
Wildcards can occur in the aliases. For example, after
<pre>
FILEALIAS   /~sret1/*.gif   /images/*g.gif
FILEALIAS   /~sret2/a?c*    /sa/*
</pre>
<kbd>/~sret1/a.gif</kbd> would be translated to <kbd>/images/ag.gif</kbd>
and <kbd>/~sret2/abcd.txt</kbd> would become <kbd>/sa/d.txt</kbd>.

<p>
If two aliases match one filename, only the first one is applied. So after
<kbd>FILEALIAS a b; FILEALIAS b c</kbd> or <kbd>FILEALIAS a b; FILEALIAS a
c</kbd>, <kbd>a</kbd> will be translated into <kbd>b</kbd>.

<p>
There are also the commands <kbd>HOSTALIAS</kbd>, <kbd>BROWALIAS</kbd> (for
browsers) and <kbd>REFALIAS</kbd>
(for referrers) which work in the same way. <kbd>HOSTALIAS</kbd>
is particularly useful if your
server records local hostnames in the logfile
instead of full internet names. Also, if a host has two names, they
can be combined in this way. So, for example, I might find it
convenient to use
<pre>
HOSTALIAS lion lion.statslab.cam.ac.uk
HOSTALIAS bigcat lion.statslab.cam.ac.uk
HOSTALIAS bigcat.statslab.cam.ac.uk lion.statslab.cam.ac.uk
</pre>
<kbd>REFALIAS</kbd> could be used to combine several referrers from one site.
For example
<pre>
REFALIAS http://www.webcrawler.com/* http://webcrawler.com/
REFALIAS http://webcrawler.com/* http://webcrawler.com/
</pre>
<kbd>BROWALIAS</kbd> could be used to combine all similar versions of a
browser. For example
<pre>
BROWALIAS Mozilla/2* "Netscape 2"
</pre>
But be careful! The same version number often doesn't mean the same thing
on different platforms.

<p>
There are also the <a href="#OUTPUTALIAS">OUTPUTALIAS</a> commands, but
I described them <a href="#OUTPUTALIAS">above</a>.

<p>
A pair of related commands is <kbd>WITHARGS</kbd> and
<kbd>WITHOUTARGS</kbd>. Normally any arguments given as part of a URL (after
a question mark) are ignored. However, if a configuration command like
<pre>
WITHARGS /cgi-bin/prog.cgi
</pre>
is given, then the arguments to that file will form part of the filename. So
<kbd>/cgi-bin/prog.cgi?a</kbd> and <kbd>/cgi-bin/prog.cgi?b</kbd> will be
regarded as separate files, whereas without that command they would both have
been translated to <kbd>/cgi-bin/prog.cgi</kbd>. Note that the filename with
the arguments still has to fit inside the maximum length of a filename.
Asterisks and lists of files can again occur, and
there is also a parallel command <kbd>WITHOUTARGS</kbd>; for example,
<pre>
WITHARGS /cgi-bin/*
WITHOUTARGS /cgi-bin/spam.cgi
</pre>
would read the arguments for all files in <kbd>/cgi-bin/</kbd> except
<kbd>spam.cgi</kbd>.

<p>
Commands <kbd>REFWITHARGS</kbd> and <kbd>REFWITHOUTARGS</kbd> work in the
same way for referrers, except that in this case the default is to include all
the arguments (so that you can see what people are requesting from search
engines).

<hr width=80% align=left>
<h3><a name="CUSCAC">Cache files</a></h3>

Analog has the ability to archive some of the data in your logfile in a cache
file so that the logfile can be thrown away without losing the most important
data. <em><strong>Important:</strong> The information that is recorded is only
that which identifies how many successful requests there were at each time. No
information on which files the requests were for, or where the requests were
from, is kept. Neither is information on failed requests. So from the cache
file you can reconstruct the <a href="#CUSTIM">time reports</a> but not any
other reports.</em>

<p>
To produce a cache file instead of the normal output, use the command
<pre>
OUTPUT CACHE
</pre>
To read data from a cache file, use, e.g.,
<pre>
CACHEFILE cache.out
</pre>
(This will still read the ordinary logfile as well). You can also use the
commandline argument <kbd>+Ucache.out</kbd>. You can specify several cache
files by putting them in a comma-separated list, or using several
<kbd>+U</kbd> commands. Note that this doesn't write to that file. You still
write to the normal output file.

<p>
To use this feature and avoid losing entries or double counting them, I
suggest you follow the following procedure.
<ol>
  <li>Stop the server.
  <li>Move the old logfile to a new location.
  <li>Restart the server with a fresh logfile.
  <li>Make a cache file from the old logfile.
  <li>Make an ordinary report from the old logfile too.
  <li>Make a report from the cache file and no other logfile to check it works.
</ol>

<p>
<em>Although it should now be safe to throw away the old logfile, I can take no
responsibility if something goes wrong.</em> See the <a
href="#LICENCE">licence</a>. Also if you are going to use this feature please
make sure you understand what information is and is not recorded in the cache
file. You may find that the cache file is not the right feature for you.
Compressing logfiles (with <kbd>gzip -9</kbd>) is very efficient owing to
the large number of repeated strings. That in itself may solve your filespace
problems.

<hr width=80% align=left>
<h3><a name="CUSDNS">DNS lookups</a></h3>

Sometimes servers do not record the name of the host that called you in the
logfile, only its number. Analog can try and resolve these numerical addresses.
These feature is not available on DOS at the moment.

<p>
To turn DNS resolution on, use the configuration command
<pre>
NUMLOOKUP ON
</pre>
or the commandline option <kbd>+1</kbd>. (Turn it off with <kbd>NUMLOOKUP
OFF</kbd> or <kbd>-1</kbd>).

<p>
The first time you use lookups, analog may be very slow. But it will record
which addresses it looked up so that you do not need to
look them up again next time you run analog. You need to specify a file for
this purpose. This is done by the command
<pre>
DNSFILE filename
</pre>
The program will first read any old lookups that are recorded there, then
overwrite it with a new version at the end.

<p>
However, any lookups that are too old will not be trusted, and will be thrown
away. You can specify how old a lookup in hours you trust by a command like
<pre>
DNSFRESHHOURS 168  # check them once a week
</pre>
Note also that not all numbers can be resolved. Sometimes the DNS lookup will
time out, or sometimes that number just doesn't have a name corresponding to
it. In that case, the host will still be listed as an unresolved address.

<p>
There is also a variable <kbd><a href="#HASHSIZE">DNSHASHSIZE</a></kbd>; see
above.

<hr width=80% align=left>
<h3><a name="CUSMISC">Miscellaneous options</a></h3>

The final group of options is those which affect the layout of the output
and other miscellaneous options.

<p>
First, one very important option: the language for the output! You can
specify any of the following
<pre>
LANGUAGE ENGLISH
LANGUAGE US-ENGLISH
LANGUAGE FRENCH
LANGUAGE GERMAN
LANGUAGE SPANISH
LANGUAGE ITALIAN
LANGUAGE DANISH
</pre>
(If you are using a language other than English, you might also want to
produce a local version of the <a href="#DOM">domains.tab</a> file, and of
the <a href="#FORM">form interface</a>).
If anyone wants to translate the output into another language, I would be
delighted! (But contact me first, so that I can make sure that two people
aren't working on the same language).

<p>
Next, you can choose whether you want ASCII (plain text), HTML or preformatted
output. (Preformatted output is a special machine-readable format, used for
importing into spreadsheets or graphics-creation programs. It is described in a
<a href="#PREOUT">separate section</a> below). The output format is chosen
using the commandline option <kbd>+a</kbd> (ASCII) or <kbd>-a</kbd> (HTML), or
the configuration command
<pre>
OUTPUT ASCII  # or HTML, or PREFORMATTED
</pre>
If you choose ASCII or PREFORMATTED output, some of the other options are
ignored, but it should be obvious which ones they will be.

<p>
You can select the file for the output to be sent to in the configuration
file or on the commandline. So instead of
<pre>
analog > outfile.html
</pre>
you can use the configuration command
<pre>
OUTFILE outfile.html
</pre>
or the commandline option <kbd>+Ooutfile.html</kbd>.

<p>
There is a configuration command <kbd>REPORTORDER</kbd> which
specifies which order the reports should occur in. The usage is a line like
<pre>
REPORTORDER hHDdWmoSirtfbBec
</pre>
This says that the reports should occur in the order hourly summary (h),
hourly report (H), daily
report (D), daily summary (d), weekly report (W), monthly report (m), domain
report (o), host report (S), directory report (i), request report (r),
file type report (t), referrer report (f), browser summary (b), browser report
(B), error report (e) and status code report (c). It
is important to include all the above sixteen letters exactly once each.

<p>
There is a command
<pre>
ALL ON
</pre>
to include all reports except the hourly report
(particular ones can then be omitted with <kbd>-d</kbd> or whatever);
likewise <kbd>ALL OFF</kbd> omits them (and particular ones can then
be included). The equivalent commandline arguments are <kbd>+A</kbd> and
<kbd>-A</kbd>. The hourly report and general report are not turned on by
<kbd>ALL ON</kbd> or <kbd>+A</kbd>; they must be turned on separately with
<kbd>+H</kbd> and <kbd>+x</kbd>. Note also that order is important; for
example, <kbd>+i -A +r</kbd> will
include the request report but not the directory report.

<p>
The title line of the output page contains three adjustable variables. First,
the logo in the top left hand corner can be turned on or off, or any other
logo substituted (for example, your organisation's logo). This is accomplished
by the command
<pre>
LOGOURL url   # or
LOGOURL none  # for no logo
</pre>
or by the commandline arguments <kbd>-p</kbd> (no logo: mnemonic, p for
picture) and <kbd>+pURL</kbd>.
The organisation name on the title line can be specified by means of the
option <kbd>-nname</kbd>; the hostname of your server would also be an
appropriate thing to put here. The name can have a link to your server's home
page by use of the option <kbd>-uURL</kbd>; use <kbd>-u-</kbd> if you
don't want any link. The equivalent configuration options are
<pre>
HOSTNAME  name  # must be in quotes if it contains spaces
HOSTURL   URL
HOSTURL   -     # for no link
</pre>
Analog will normally translate characters in the hostname to HTML if necessary.
So to include literal HTML, such as accented characters, in the output you
need to precede them by a backslash, like this:
<pre>
HOSTNAME &quot;M\&amp;uuml;ller & S\&amp;ouml;hne&quot;
</pre>

<p>
A header file and footer file can be inserted near the top and bottom of your
output. These should be written in HTML or ASCII according to whether your
output is HTML or ASCII, and can contain anything you want.
Possible uses include providing information about your organisation or about
the way the statistics were calculated, linking to related pages, and no doubt
many other things. The commands to achieve this are
<pre>
HEADERFILE filename
FOOTERFILE none      # if you don't want one
</pre>
You can also use <kbd>HEADERFILE stdin</kbd> or <kbd>HEADERFILE -</kbd> to use
standard input.

<p>
There is a command <kbd>SEPCHAR</kbd> to say which character should separate
each group of three digits in long numbers. For example,
<pre>
SEPCHAR ,
</pre>
will give 123,456,789, whereas
<pre>
SEPCHAR ' '
</pre>
will give 123 456 789. If you want the numbers just to run together (123456789)
use
<pre>
SEPCHAR ''
</pre>
You can also specify a character for use within the
tables in the reports. This is done in the same way by means of the command
<kbd>REPSEPCHAR</kbd>.

<p>
You can also choose a character for the decimal point. For example, some
languages use a comma instead of a full stop; you would specify this by
the command
<pre>
DECPOINT ,
</pre>

<p>
You can specify whether analog prints long numbers of bytes as exact numbers
(e.g., 5,053,234) or as kilobytes, megabytes etc. (e.g., 4934k) by the command
<pre>
RAWBYTES ON  # for exact, OFF for abbreviated
</pre>

<p>
<a name="DEBUG">There</a> is a debugging command, for printing (to stderr)
problems with
your logfile. There are currently three levels of debugging: 0 for no
debugging; 1 for printing corrupt logfile lines (prepended by "C:"),
information on files opened and closed (prepended by "F:"), and some
summary data (prepended by "S:"); and 2 which also prints hosts for which the
domain is unknown (prepended by "U:"), errors which cannot be classified
(prepended by "E:") and any DNS lookups carried out (prepended by "D:"). The
command for level n debugging is
<pre>
DEBUG n
</pre>
and the equivalent commandline argument is <kbd>+Vn</kbd> (V for
verbose).
You can also use commandline options <kbd>+V</kbd> for level 1 and
<kbd>-V</kbd> for level 0.

<p>
You can also get a report on analog's progress. The command
<pre>
PROGRESSFREQ n
</pre>
prints a report after every n lines of input.

<p>
There is an option to turn off warnings. It is
<pre>
WARNINGS OFF  # or ON
</pre>
The equivalent commandline argument is <kbd>-q</kbd> to turn warnings off
(q for quiet) and <kbd>+q</kbd> to turn them on again. This is useful in
scripts or cron jobs if you really do want to give a configuration that you
know will generate a warning.

<p>
Finally, configuration files can call other configuration files, by means
of a command like
<pre>
CONFIGFILE other.cfg
</pre>

<hr>
<h2><a name="DOM">The domains file</a></h2>

The file domains.tab, to translate internet country codes to locations,
should have come with the program. It is needed to construct the <a
href="#CUSDOM">domain report</a>. If you haven't got one, you can download
one from <a href="http://www.statslab.cam.ac.uk/~sret1/analog/analog/domains.tab">http://www.statslab.cam.ac.uk/~sret1/analog/analog/domains.tab</a>.
It should be in the following format:
<pre>
ad   Andorra
ae   United Arab Emirates
[...]
</pre>
There can be arbitrary space between the code and the corresponding
location. The codes are converted to lower case. Use <kbd>?</kbd>
(or anything starting with
<kbd>?</kbd>) for the name if you want the domain
to be recognised, but don't want the name to be printed out.
The domains do not need to be in alphabetical order, though humans
may prefer it that way.

<p>
Comments can occur in the domains file. They are introduced by the
character <kbd>#</kbd>.
So you could write, for example,
<pre>
uk  United Kingdom  # God save the Queen!
</pre>

<hr>
<h2><a name="PREOUT">Preformatted output</a></h2>

This section describes a special output format called preformatted output.
It is selected using the configuration command
<pre>
OUTPUT PREFORMATTED
</pre>
This type is designed to be easy to read into spreadsheets, or post-process
with graphics creation tools. Each line is separated into columns with a
special string of characters. You can specify this string with the
<kbd>PRESEP</kbd> command; for example
<pre>
PRESEP :::
</pre>
if for some reason you wanted three colons between each column. Make sure not
to use anything that might occur in the output: a space would not be suitable.

<p>
Each line in the preformatted output begins with a letter indicating what
type of information the line contains. The possible letters are as follows:
<dl compact>
  <dt>x
  <dd>general summary
  <dt>h
  <dd>hourly summary
  <dt>H
  <dd>hourly report
  <dt>D
  <dd>daily report
  <dt>d
  <dd>daily summary
  <dt>W
  <dd>weekly report
  <dt>m
  <dd>monthly report
  <dt>o
  <dd>domain report
  <dt>O
  <dd>subdomain in domain report
  <dt>S
  <dd>host report
  <dt>i
  <dd>directory report
  <dt>r
  <dd>request report
  <dt>t
  <dd>file type report
  <dt>f
  <dd>referrer report
  <dt>b
  <dd>browser summary
  <dt>B
  <dd>browser report
  <dt>e
  <dd>error report
  <dt>c
  <dd>status code report
</dl>
Except for the general summary, there then follows which columns are included
in the report (using the letters RrBbPp as usual). There then follows the
numerical data, and finally the identification of the item. (In the case of
the time reports, this can take several columns. They are listed with most
significant time first (year - month - date - hour - minute)).

<p>
The general summary is a bit different. After the initial x, follows a
two-character code saying what the line contains. The possible codes are
<dl compact>
  <dt>HN
  <dd>HOSTNAME
  <dt>HU
  <dd>HOSTURL
  <dt>PS
  <dd>Program start
  <dt>FR
  <dd>Time of first request
  <dt>LR
  <dd>Time of last request
  <dt>L7
  <dd>Time last 7 days extends from
  <dt>SR
  <dd>Total successful requests
  <dt>S7
  <dd>Total successful requests in last 7 days
  <dt>PR
  <dd>Total successful requests for pages
  <dt>P7
  <dd>Total successful requests for pages in last 7 days
  <dt>FL
  <dd>Total failed requests
  <dt>F7
  <dd>Total failed requests in last 7 days
  <dt>RR
  <dd>Total redirected requests
  <dt>R7
  <dd>Total redirected requests in last 7 days
  <dt>NF
  <dd>Number of distinct files requested
  <dt>N7
  <dd>Number of distinct files requested in last 7 days
  <dt>NH
  <dd>Number of distinct hosts served
  <dt>AH
  <dd>Approximate number of distinct hosts served
  <dt>H7
  <dd>Number of distinct hosts served in last 7 days
  <dt>A7
  <dd>Approximate number of distinct hosts served in last 7 days
  <dt>NV
  <dd>Number of new hosts served in last 7 days
  <dt>AV
  <dd>Approximate number of new hosts served in last 7 days
  <dt>CL
  <dd>Number of corrupt lines in the logfile
  <dt>UL
  <dd>Number of unwanted lines in the logfile
  <dt>BT
  <dd>Total number of bytes transferred
  <dt>B7
  <dd>Total number of bytes transferred in last 7 days
</dl>

<p>
If you do anything interesting with the preformatted output, I should like to
hear about it.

<hr>
<h2><a name="FORM">The form interface</a></h2>

Another way to run analog is via the form interface; this allows users
to select which options they want via a Web page. <b>Important:</b> I have
attempted to block any potential security holes in the form interface.
However, cgi programs have been known to contain hidden loopholes, and I can
take no responsibility if anything goes wrong. See the <a
href="#LICENCE">licence</a>.

<p>
The form interface probably only works on Unix at the moment, though if
anyone manages to make it work on other systems, I should be interested
to hear about it.

<p>
To set up the form interface, go to the directory where the analog source
code lives, and follow these steps.
<ol>
  <li>In analhead.h, make sure that the <kbd>FORMPROG</kbd> is set to be
      the URL of the form processing program, which will be wherever cgi-bin
      programs live on your server; normally in the cgi-bin directory.
  <li>Edit the top of analform.c to indicate where the analog program lives
      (the program name within your computer's whole filespace, not a URL).
  <li>Type <kbd>make form</kbd>.
  <li>Move the program analform.cgi to the place you specified as the
      <kbd>FORMPROG</kbd>.
      Make sure it is executable by the server.
  <li>Make sure analog itself is executable by the server too, and that
      domains.tab and any configuration files are readable.
  <li>The file analogform.html is the actual form interface; move it to
      wherever you want people to get at it. Make sure it is world
      readable.
</ol>

<p>
If the third step above fails to generate a form, you can generate one
yourself by means of the command <kbd>analog -form +Oanalogform.html</kbd>.
You might also want to run this command yourself if you want to supply
different default options from normal for the form user: if you run the
command with extra commandline or configuration file options, they will be
respected in the construction of the form.

<p>
It is expected that system administrators may want to provide different
options on the forms from the default ones. (For example, the form does not by
default allow an hourly report). For this reason, the cgi program
understands various other options that are not normally on the form. These can
be added to the form by hand. For example, you may want to allow a choice of
logfiles, perhaps via a &lt;select&gt;. Or you may want form users to use
certain default options; these could be specified as &lt;input
type=hidden&gt;. Or different users could have different configuration files
set up with all their options in which could be read in via a choice of
<kbd>cg</kbd>'s or <kbd>cm</kbd>'s.

<p>
You might want to construct links directly to the analform.cgi program,
without going via the form. Because the program uses GET not POST, this is 
no problem. You can use any of the options below, including <kbd>cg</kbd> and
<kbd>cm</kbd> to read in other commands from a configuration file.

<p>
For experts, here follows a complete list of form options. [*]
marks a default value (i.e., what is sent to analog if you don't send
anything else to the cgi program. These defaults can override the analog
program defaults. Items without a [*] use the program default if nothing else
is specified).
<pre>
bq  browser summary? 0 for off, 1 for on.
ba  +ve BROWMINREQS/PAGES
bb  -ve BROWMINREQS/PAGES
bc  +ve BROWMINBYTES
bd  -ve BROWMINBYTES
bs  BROWSORTBY (0 = REQUESTS, 1 = BYTES, 2 = ALPHABETICAL,
                3 = RANDOM, 4 = PAGES)
Other reports similarly with initial B, f, i, o, r, S, t in place of b.
cg  configuration file to read in before all other options
ch  COUNTHOSTS? 0 for off, 1 for on, 2 for approx
cm  configuration file to read in after all other options
cq  status code report?
dq  daily summary?
dg  DAYGRAPH (R, B or P)
Other time reports similarly with D, h, H, m, W in place of d.
eq  error report?
fi  FILEEXCLUDE; list, separated by commas
fr  FROM
fy  FILEINCLUDE; list, separated by commas
gr  GRAPHICAL? 0 for off, 1 for on
hi  HOSTEXCLUDE; list, separated by commas
ho  HOSTURL
hy  HOSTINCLUDE; list, separated by commas
ie  DIRLEVEL
lb  BROWLOG; list, separated by commas
lc  CACHEFILE; list, separated by commas
le  ERRLOG; list, separated by commas
lf  REFLOG; list, separated by commas
lo  LOGFILE; list, separated by commas
or  HOSTNAME
ou  OUTPUT -- 0 for HTML [*], 1 for ASCII, 2 for PREFORMATTED,
              3 for program default
rl  LINKINCLUDE options -- f for ALL (files), p for PAGES, n for NONE
rt  REQINCLUDE options  -- f for ALL, p for PAGES
to  TO
TZ  timezone
Vq  Show commands sent to program
wa  WARNINGS (to error_log) -- 0 for OFF, 1 for ON [*].
xq  general report?
</pre>
<strong>Important note:</strong> Do not add options for <kbd>HEADERFILE</kbd>
and <kbd>FOOTERFILE</kbd> to the form program. This would be a potentially
serious security risk.

<p>
If the form doesn't seem to work, check the following:
<ol>
  <li>Look in the server's error_log for clues.
  <li>If you get a long wait, then no data returned, the server is probably
      timing out the request before analog has finished. The remedy is to
      increase the timeout interval.
  <li>Try including Vq=1 in the search arguments. This will show what's being
      passed to the program. (It can also be used to generate a configuration
      file representing your choices).
  <li>Do other cgi-bin programs work on your server?
  <li>Are all the files in the right places, with the right access
      permissions, as specified above?
  <li>Try the following. <kbd>setenv QUERY_STRING "xq=1"</kbd> (C Shell) or
      <kbd>export QUERY_STRING="xq=1"</kbd> (other shells), then run
      analform from the shell.
  <li>If the local time doesn't seem to be correct in the output, you may
      have to set the timezone yourself in the form. Four lines from the
      bottom, there is a line like
      <kbd>&lt;input type=hidden name=&quot;TZ&quot;
      value=&quot;&quot;&gt;</kbd>
      For the value you should insert your timezone, in standard format.
      Usually this looks like your winter timezone name, followed by hours
      west of Greenwich, followed by your summer timezone name. So the East
      Coast of the USA should have <kbd>value=&quot;EST5EDT&quot;</kbd>,
      and Germany <kbd>value=&quot;MEZ-1MESZ&quot;</kbd>.
</ol>

<p>
It is better, although not essential, if when you change the default options
for your analog, you remake the form.

<p>
Note that you probably want to restrict access to the form and form program
to certain users; if it is world readable there could be considerable load on
your server as well as potential confidentiality problems. Exactly how to do
this depends on which server you are running.

<hr>
<h2><a name="REF">Glossary and reference</a></h2>

Many people have asked exactly what counts as a request, and the meaning of
other terms used in the analog output. Here is an
explanation. Each time someone requests a file from your server, that is a
request. It may be that the page contains some inline images; then they must
be loaded separately by people with graphical browsers, which counts as
further requests.

<p>
Unfortunately, you cannot tell how many times your file has been read from
this. The user may in fact request the file from a proxy server which already
has a copy of it, or retrieve it from a local cache. In these cases no
connection is made to your server, and no request is scored.

<p>
There are three categories of request, which can be seen in the <a
href="#CUSERR">status code
report</a>. Completed (or successful) requests are those with codes in the 200s
(where the document was returned) or with code 304 (where the document was
not needed because it had not been recently modified and the user could use a
cached copy). Redirected requests are those with other codes in the 300s.
The most common cause of these requests is that the user has incorrectly
requested a directory name without the trailing slash. The server replies with
a redirection ("you probably mean the following") and the user then makes a
second connection to get the correct document (although usually the browser
does it automatically without the user's intervention or knowledge). Failed
requests are those with codes in the 400s (error in request) or 500s (server
error). They come about for a variety of reasons, but the most common are when
the requested file is not found or is read-protected.

<p>
Note that 302 requests are not counted. Most of them come about by the user
requesting a faulty URL, as explained above. However, some cgi scripts also
return a 302 code; these are not included because there is no way to tell them
apart from the first type.

<p>
The total data transferred refers only to successful requests, and does not
include the message header, only the actual data. The detailed reports also
only include successes, except for the referrer report and browser reports
which include all request types.

<p>
Requests for pages are just those requests corresponding to filenames that
analog thinks represent pages. You can tell analog what is to count as a page
by means of the <a href="#ISPAGE">ISPAGE</a> command.

<p>
Corrupt logfile lines are those we can't understand, and unwanted lines are
those that refer to files, hosts or dates that we have specifically <a
href="#INCLUDE">excluded</a>. (See the <kbd><a href="#DEBUG">DEBUG</a></kbd>
command for how to list all corrupt lines).

<p>
A host is a computer that has requested something from you. Analog gives the
number of distinct (different) hosts that have made a successful request, and
the number of distinct files they have requested.

<p>
The common logfile format is written by most servers. Its lines look like
<pre>
m45-6.gps.jussieu.fr - - [14/Mar/1996:17:45:35 +0000]
"GET /~sret1/analog/ HTTP/1.0" 200 12435
</pre>
(except all on one line). Most of the fields are obvious -- the two numbers at
the end are the status code and number of bytes transferred.

<p>
The other logfiles are not the same on different servers. Analog understands
the files written by the NCSA and Apache (and some other) servers. The browser
(or agent) log looks like
<pre>
[14/Mar/1996:17:45:08] Mozilla/2.0 (X11; I; HP-UX A.09.05 9000/735)
</pre>
The referrer log looks like
<pre>
[14/Mar/1996:17:48:10] http://guide-p.infoseek.com/Titles -> /~sret1/analog/
</pre>
In both of these the date may be omitted.
The error log looks like
<pre>
[Thu Jul 28 20:43:10 1994] httpd: successful restart
</pre>
Analog also understands the NCSA combined log. This looks like the
common log, except that it has the referrer and browser on the end, like this:
<pre>
lion.statslab.cam.ac.uk - - [18/Jan/1996:12:04:23 +0000]
"GET /~sret1/analog/ HTTP/1.0" 200 578 "http://www.statslab.cam.ac.uk/~sret1/"
"Mozilla/2.0 (X11; I; HP-UX A.09.05 9000/735)"
</pre>
(except all on one line again). Note the quotes round the referrer and browser.
In Apache, you can generate this with the mod_log_config module, using the
command
<pre>
LogFormat "%h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-Agent}i\""
</pre>
It is usually better to use the combined log than separate logs, because it
stores more information in less space.

<p>
The Mac version of analog also reads the WebSTAR and Netpresenz format log
files. The WebSTAR file <b>must</b> start with a line like
<pre>
!!LOG_FORMAT DATE TIME RESULT URL FROM TRANSFER_TIME BYTES_SENT USER HOSTNAME
</pre>
to tell us what to expect on subsequent lines. (You should add it manually
if it's got lost). We require the following fields
as a minimum: <kbd>HOSTNAME, DATE, TIME, RESULT, URL, BYTES_SENT</kbd>.
We will also read <kbd>AGENT</kbd> and <kbd>REFERER</kbd> if present. Each
line of the logfile contains the fields given in the header line, separated
by tabs: for example
<pre>
12/14/95  19:00:04  OK  :pages:Downloads.html  72  3176  indy1.indy.net.
</pre>
except all on one line.

<hr><p>
Here is a complete list of all 176 configuration commands. For their usage,
see the documentation above.
<dl>
  <dt><b>Specifying files to analyse</b>
  <dd><kbd>BROWLOG, CACHEFILE, DOMAINSFILE, ERRLOG, LOGFILE, REFLOG</kbd>
  <dt><b>Turning reports on and off</b>
  <dd><kbd>ALL, BROWSER, COUNTHOSTS, DAILY, DIRECTORY, DOMAIN, ERROR, FILETYPE,
      FULLBROWSER, FULLDAILY, FULLHOSTS, FULLHOURLY, GENERAL, HOURLY,
      LASTSEVEN, MONTHLY, REFERRER, REQUEST, STATUS, WEEKLY</kbd>
  <dt><b>Columns in reports</b>
  <dd><kbd>BROWCOLS, DAYCOLS, DIRCOLS, DOMCOLS, FULLBROWCOLS, FULLDAYCOLS,
      FULLHOURCOLS, HOSTCOLS, HOURCOLS, MONTHCOLS, REFCOLS, REQCOLS, TYPECOLS,
      WEEKCOLS</kbd>
  <dt><b>Number of rows in graphs</b>
  <dd><kbd>FULLDAYROWS, FULLHOURROWS, MONTHROWS, WEEKROWS</kbd>
  <dt><b>Graphs by requests, bytes or pages</b>
  <dd><kbd>DAYGRAPH, FULLDAYGRAPH, FULLHOURGRAPH, HOURGRAPH, MONTHGRAPH,
      WEEKGRAPH</kbd>
  <dt><b>Graphs forwards or backwards in time</b>
  <dd><kbd>ALLBACK, FULLDAILYBACK, FULLHOURLYBACK, MONTHLYBACK,
      WEEKLYBACK</kbd>
  <dt><b>Value of unit in graphs</b>
  <dd><kbd>DAILYUNIT, FULLDAILYUNIT, FULLHOURLYUNIT, HOURLYUNIT, MONTHLYUNIT,
      WEEKLYUNIT</kbd>
  <dt><b>How to sort reports</b>
  <dd><kbd>BROWSORTBY, DIRSORTBY, DOMSORTBY, FULLBROWSORTBY, HOSTSORTBY,
      REFSORTBY, REQSORTBY, TYPESORTBY</kbd>
  <dt><b>Floors for reports</b>
  <dd><kbd>BROWMINBYTES, BROWMINPAGES, BROWMINREQS, DIRMINBYTES, DIRMINPAGES,
      DIRMINREQS, DOMMINBYTES, DOMMINPAGES, DOMMINREQS, ERRMINOCCS,
      FULLBROWMINBYTES, FULLBROWMINPAGES, FULLBROWMINREQS, HOSTMINBYTES,
      HOSTMINPAGES, HOSTMINREQS, REFMINBYTES, REFMINPAGES, REFMINREQS,
      REQMINBYTES, REQMINPAGES, REQMINREQS,  SUBDOMMINBYTES, SUBDOMMINPAGES,
      SUBDOMMINREQS, TYPEMINBYTES, TYPEMINPAGES, TYPEMINREQS</kbd>
  <dt><b>Inclusions and exclusions</b>
  <dd><kbd>FILEALLOW, FILEEXCLUDE, FILEINCLUDE, FROM, LINKALLOW, LINKINCLUDE,
      LINKEXCLUDE, HOSTALLOW, HOSTEXCLUDE, HOSTINCLUDE, REFALLOW, REFEXCLUDE,
      REFINCLUDE, REFLINKALLOW, REFLINKEXCLUDE, REFLINKINCLUDE, REQALLOW,
      REQEXCLUDE, REQINCLUDE, TO</kbd>
  <dt><b>Aliases</b>
  <dd><kbd>BROWALIAS, BROWOUTPUTALIAS, DIROUTPUTALIAS, FILEALIAS, HOSTALIAS,
      HOSTOUTPUTALIAS, REFALIAS, REFOUTPUTALIAS, REQOUTPUTALIAS,
      TYPEOUTPUTALIAS</kbd>
  <dt><b>Other output configuration</b>
  <dd><kbd>BASEURL, DECPOINT, FOOTERFILE, GRAPHICAL, HEADERFILE, HOSTNAME,
      HOSTURL, IMAGEDIR, LANGUAGE, LOGOURL, MARKCHAR, OUTPUT, OUTFILE,
      PAGEWIDTH, PRESEP, RAWBYTES, REPORTORDER, REPSEPCHAR, SEPCHAR</kbd>
  <dt><b>DNS lookups</b>
  <dd><kbd>DNSFILE, DNSFRESHHOURS, NUMLOOKUP</kbd>
  <dt><b>Hash sizes</b>
  <dd><kbd>BROWHASHSIZE, DIRHASHSIZE, DNSHASHSIZE, FULLBROWHASHSIZE,
      HOSTHASHSIZE, REFHASHSIZE, REQHASHSIZE, SUBDOMHASHSIZE,
      TYPEHASHSIZE</kbd>
  <dt><b>Other commands</b>
  <dd><kbd>APPROXHOSTSIZE, CASE, CONFIGFILE, DEBUG, DIRLEVEL, DIRSUFFIX,
      ISPAGE, ISNOTPAGE, NOTSUBDOMAIN, PROGRESSFREQ, REFWITHARGS,
      REFWITHOUTARGS, SUBDOMAIN, UNCOMPRESS, WARNINGS, WEEKBEGINSON, WITHARGS,
      WITHOUTARGS</kbd>
</dl>

<p>
Here is a summary of all 39 commandline arguments. Again, for their usage, see
the full documentation. Many of them can be given a - instead of a + to turn
something off.
<pre>
 +1  Do DNS lookup
 +7  stats for last 7 days
 +a  ASCII output
 +A  all reports (except hourly report)
 +b  browser summary
 +B  browser report
 +c  status code report
 +C  configuration command
 +d  daily summary
 +D  daily report
 +e  error report
 +f  referrer report
 +form  do a form
 +F  from
 +g  configuration file
 -G  default config file off
 +help  help message
 +h  hourly summary
 +H  hourly report
 +i  directory report
 +l  dirlevel
 +m  monthly report
 +n  hostname
 +o  domain report
 +O  outfile
 +p  logo
 -q  no warnings
 +r  request report
 +s  host count
 +ss approximate host count
 +S  host report
 +t  file type report
 +T  to
 +u  host url
 +U  cache file
 +v  printvbles
 +V  debug level
 +w  pagewidth
 +W  weekly report
 +x  general summary
</pre>

<hr>
<h2><a name="FAQ">Frequently asked questions</a></h2>

<p>
See also the <a href="#REF">glossary</a> above.
<p>
<dl>
  <dt><b>When I try and compile analog, it gives me an error.</b>
  <dd>Look in the Makefile to see if you need to include any extra options.
      This applies to SunOS 5 (Solaris 2) in particular.
  <dt><b>Can analog understand my server's logfile?</b>
  <dd>The logfiles that analog understands are given in the <a
      href="#REF">glossary</a> above. Unfortunately, more and more servers are
      using proprietary formats, and I just can't write code to parse them
      all. The best thing is to write a small program, perhaps in Perl, to
      convert the lines to common format. (The Microsoft Internet Server
      comes with a program called convlog to do this). Also, tell your
      server's authors that they should be supporting the common log format.
  <dt><b>Is there a version of analog for ftp logfiles?</b>
  <dd>The same thing applies. There is no standard format. The best thing to do
      is to convert the logfiles to HTTP common format first.
  <dt><b>How can I do such-and-such with a commandline option?</b>
  <dd>Use the <kbd><a href="#PLUSC">+C</a></kbd> option to put any
      configuration command on the commandline.
  <dt><b>How do I get information on just my pages, not everybody's?</b>
  <dd>Use the <kbd><a href="#INCLUDE">FILEINCLUDE</a></kbd> command.
  <dt><b>Why don't I get such-and-such a report in the output even though I
      asked for it?
      (<i>or</i> why don't I get the subdomains I requested in the domain
      report?)</b>
  <dd>Maybe the <kbd><a href="#CUSFLOOR">MINREQS or MINBYTES</a></kbd>
      for the report is set too high. For example, if you ask
      for a host report for all hosts with at least 50 accesses and no host
      has that many, no report will be produced. See also the next question.
  <dt><b>Can I get data on individual visitors to my site?</b>
  <dd>No. This information is usually not recorded in the logfile. The
      number of hosts people came from is the best estimate. Even where it is
      available, there are too many legal as well as ethical issues for me to
      get involved in it.
  <dt><b>Well, can I generate the number of visits then?</b>
  <dd>Again, no, and any program that claims to do it is lying.
      Everyone wants to know these two things, but (in the absence of cookies
      or user identification)
      that information just isn't available in HTTP. (Some programs
      count all requests from the same machine as
      one visit until there is, say, 30 minutes gap. This is a very unsound
      method of counting visits. It goes wrong if someone leaves and then comes
      back within 30 minutes. It also goes wrong if several of your readers are
      from the same site. Both of these happen a lot).
  <dt><b>What can I and can't I find out from the logfiles then?</b>
  <dd>I can recommend some excellent articles on this subject: <cite><a
      href="http://www.naa.org/news/stehle.html">Getting Real about Usage
      Statistics</a></cite> by Tim Stehle; <cite><a
      href="http://www.piperinfo.com/piper/pl01/usage.html">Making Sense of Web
      Usage Statistics</a></cite> by Dana Noonan; and <cite><a
      href="http://gopher.nara.gov:70/0h/what/stats/webanal.html">Interpreting
      WWW Statistics</a></cite> by Doug Linder. For an even more negative view,
      see <cite><a href="http://www.cranfield.ac.uk/stats/">Why Web Usage
      Statistics are (Worse Than) Meaningless</a></cite> by Jeff Goldberg.
  <dt><b>Why does the form interface give &quot;Document Returned no
      Data&quot;?</b>
  <dd>Probably the server is giving up before the analog process has finished
      running. Increase the timeout interval on the server.
  <dt><b>Can I find out the number of hosts that have accessed each file?</b>
  <dd>No; it would require storing too much data (all host/file pairs). If
      there's a particular file you're interested in, use <a
      href="#INCLUDE">FILEINCLUDE</a> to restrict the analysis to only that
      file.
  <dt><b>How can I run analog every day?</b>
  <dd>This depends on your particular machine. On Unix, you need to run analog
      as a cron job (see &quot;man cron&quot;). This is my cron command:
      <br>20 1 * * * $HOME/misc/analog
  <dt><b>Do I have to save all my old logfiles?</b>
  <dd>This is answered in the section about <a href="#CUSCAC">cache files</a>
      above.
  <dt><b>What does &quot;Browser logs contain no file information&quot;
      mean?</b>
  <dd>The browser log doesn't say which files were requested, so analog cannot
      restrict that part of the analysis to certain files only. It will still
      produce a report though. (This is why it is better to use the combined
      log than separate logs; then the information can be extracted).
  <dt><b>How can I specify different logfiles from the <a href="#FORM">form
      interface</a>?</b>
  <dd>Just add a new field to the form with <kbd>name=lo</kbd>
  <dt><b>Can I sort the subdomains in the same way as the domains?</b>
  <dd>Unfortunately not. This would be the right thing to do if we only allowed
      one level of subdomains, but when there are several levels without all
      the intermediate levels being present, it's not clear what the correct
      order is.
  <dt><b>Why are directories listed in the request report?</b>
  <dd>They are not directories, they are pages with the same name as
      the directory. For example, I have a directory called <kbd>/analog/</kbd>
      and a page called <kbd>/analog/</kbd> (which is the same as
      <kbd>/analog/index.html</kbd>).
  <dt><b>Why do I only get "unresolved numerical addresses" in the domain report?</b>
  <dd>Your server only records the numerical IP address of the hosts that
      contact you, not their names. Read about <a href="#CUSDNS">DNS
      lookups</a> above.
  <dt><b>Can I list browsers by version number, e.g. Mozilla/2.0?</b>
  <dd>Not really. Different browsers don't report this information in the same
      way, so it can't be extracted automatically. You can use <a
      href="CUSALI">BROWALIAS</a> to do it for specific browsers, but it's
      probably not wise because the same version number doesn't mean the same
      thing on different platforms.
  <dt><b>How do I make a link on my page that runs analog?</b>
  <dd>Link to the <a href="#FORM">analform</a> program, with the desired
      options.
  <dt><b>My server lists local names in the logfile. Can you put a common
      suffix on them automatically?</b>
  <dd>This wouldn't be a good idea, because things like &quot;unknown&quot;
      would get the suffix. You can always add them using <a
      href="CUSALI">HOSTALIAS</a>.
  <dt><b>Why don't you make proper graphs or tables?</b>
  <dd>Because lots of people then couldn't read them. Analog produces
      HTML output so that people with any browser can read it. Also, I don't
      want to assume that people have any particular graphics creation tools.
  <dt><b>Can I change the background colour of my output?</b>
  <dd>No: that's not part of HTML either. Analog only writes true HTML.
  <dt><b>Can you extrapolate from the current month's partial data to produce
      a prediction for the whole month, based on the rate so far?</b>
  <dd>No. There are too many problems in trying to produce anything sensible,
      especially near the beginning of the month. Different days of the week
      and different times of day cause lots of problems. I would prefer to
      produce raw accurate data than suspect derived data.
  <dt><b>Can I make multiple reports with one pass through the logfile?</b>
  <dd>Not at the moment. I want to do this in a future version, but it will
      require some considerable work.
  <dt><b>I ran out of memory when trying to run analog. What can I do?</b>
  <dd>Try using approximate (instead of exact) hostname counting with the
      <kbd>+ss</kbd> option, or turning hostname counting off altogether
      with <kbd>-s</kbd>. (Note that you also need to have the host report off
      for this to take effect).
  <dt><b>You're processing 1,000,000 requests in under 2 minutes. Why is mine
      much slower?</b>
  <dd>If you have <a href="#CUSDNS">DNS lookups</a> on, they are very slow.
      Otherwise, it probably depends on the speed of your computer and
      disks. But you could changing the <a href="#HASHSIZE">hash sizes</a>.
  <dt><b>Why don't you sell analog?</b>
  <dd>I didn't write analog for the money, and I'm happy just to see people use
      it. Besides, I haven't got time to support it commercially, and I can't
      use my academic account for commercial purposes. (Of course, if you
      really want to send me money, or even postcards...).
</dl>

<hr>
<h2><a name="WARN">Warnings</h2>

Lines with filenames longer than a certain limit (which can be specified
in analhead.h) are regarded as corrupt lines and discarded.

<p>
If we are doing a
`top n' report and two entries tie for nth place, only one will be printed.

<p>
The reported `running time' is elapsed real time, not CPU time.

<p>
You can sort a report by requests even when you have turned off the request
columns. This may confuse your readers.

<p>
The bytes sometimes aren't reported correctly. This is really a server bug.
Servers don't actually measure the number of bytes transferred, they measure
the size of the file they are about to transfer, so if a connection is
interrupted, they may write down more bytes than were actually transferred.
(Actually, they sometimes do a bit better than that, but it's still likely to
be an overestimate). Of course any inaccuracy in the logfile will make analog
not tell the truth.

<hr>
<h2><a name="BUGS">Known bugs</h2>

Average requests per day don't take account of daylight savings time changes.

<p>
If you find any more bugs, please tell me! Thanks.

<hr>
<h2><a name="WISH">Mailing list</h2>

I always welcome mail on analog (my e-mail address is <a
HREF="mailto:sret1@cam.ac.uk">sret1@cam.ac.uk</a>); whether it works on your
system (yes, even if it does!), any bug reports, patches or requests for new
features. It's helpful to me if you include the word "analog" in the subject
of your message.

<p>
I can no longer keep everyone who writes to me informed about updates. But if
you want to be informed about updates, send me mail with "subscribe analog"
in the subject line, and I'll make sure to put you on the mailing list. (You
can write to me in the body of the message as well; I'll still read it).

<p>
I am happy to help people who have trouble with analog, but please
read the <a href="#FAQ">FAQ</a>
first. Also, you might be able to diagnose the problem yourself if you run
<pre>
analog -v [your usual options]
</pre>
which lists the value of all variables. But if you still can't get it to work,
ask me. It helps me find bugs, and to know where the documentation is unclear.
When submitting bug reports, please include the version number (which you can
find out by the command <kbd>analog -v</kbd>) and what type of computer you're
using.

<hr>
<h2><a name="ACKNOW">Acknowledgements</a></h2>

Thanks are due to the author of
<a HREF="http://www.eit.com/software/getstats/getstats.html">getstats</a>,
<a HREF="http://www.eit.com/~kevinh/">Kevin Hughes</a>.
We (and other people) have found that getstats gets buggy and very slow
when the logfile got big, but you may
notice that my output (although not my program) is based on his to some
extent.

<p>Thanks are also due to all those who helped in the early stages of writing
this program. Those who made helpful suggestions during beta testing are
numerous, but I must mention particularly
<a href="http://www.sierraclub.org/signature/dea.html">Dan
Anderson</a>, Martyn Johnson, Joe Ramey,
<a href="http://www.cs.ncl.ac.uk/~c.r.ritson/">Chris Ritson</a>,
<a href="http://www.cam-orl.co.uk/~qsf/">Quentin
Stafford-Fraser</a> and
<a href="http://www.gamesdomain.co.uk/">Dave Stanworth</a>;
and above all
<a href="http://www.pmms.cam.ac.uk/~gjm11/">Gareth McCaughan</a>
for lots of programming advice, particularly in making the code faster.

<p>For recent developments I have to thank Dave Stanworth (again!) and all the
other people who have provided mirror sites for analog. I have to thank Mark
Roedel for the DOS version, Jason Linhart for the Mac version (including lots
of new code), Dave Jones for the VMS version, and Dan Anderson for the Win32
version. Stephan Somogyi and Nigel Perry have also contributed
code for the Mac version. For the translations into other languages, I have to
thank Patrice Lafont (French), Mario Ellebrecht (German), Furio Ercolessi
(Italian), Javier Solis (Spanish) and Adrian Price (Danish).

<hr>
<h2><a name="LICENCE">Licence</a></h2>

<p>
Analog is copyright (C) Stephen R. E. Turner 1995 - 1997, except those parts
written by other people.
<p>
This licence describes the conditions under which you may use, modify and
distribute version 2.0 of analog ("the program"). Except where stated,
the conditions of this licence apply equally to the source code for the
program and to any compiled version. If you are unable or unwilling
to accept these conditions in full, then, notwithstanding the conditions in
the remainder of this licence, you may not use, modify or distribute the
program at all. Text in square brackets is intended for guidance only and does
not form part of the licence in any way.
<br>
[Analog is free software. This licence is designed not to restrict your
freedom except insofar as is necessary to ensure that the program remains free
for all. Of course, I don't refuse donations!]

<ol>
<li>Any action which is illegal under international or local law is forbidden
   by this licence. Any such action is the sole responsibility of the person
   committing the action.
  
<p>
<li> The program may be used free of charge by any person or organisation to
   whom it is made available, provided that that person accepts the conditions
   of this licence.

<p>
<li> The program may be copied and distributed by any person or organisation in
   any way whatsoever, provided that any distribution is accompanied by a copy
   of the Readme file pertaining to the program. You may not charge for
   distributing the program without first informing the person to whom it is
   distributed that analog is free software. Furthermore, you may not charge
   for distributing a modified version of the program unless the source code
   for the modified version, or a list of differences between the modified
   version and the original version, is publicly and freely available in
   machine readable form. 
<br>
   [A copy of the Readme may be downloaded from the analog home page,
   currently at http://www.statslab.cam.ac.uk/~sret1/analog/ and mirrored at
   http://www.gamesdomain.com/analog/ and other sites. You are strongly
   encouraged to distribute only complete distributions. If you distribute
   analog with a book or something like that, I'd be pleased if you wanted
   to send me a copy].

<p>
<li> You may make a reasonable charge for either of the following services,
   provided in each case that the third party is made aware that analog is free
   software and that the charge is therefore for your labour, expertise and
   costs.
    <ol>
      <li>Installing the program on a computer on behalf of a third party;
      <li> Running the program and providing output from it to a third party.
    </ol>
   You may not charge for these services in connection with a modified version
   of the program unless the source code for the modified version, or a list
   of differences between the modified version and the original version, is
   publicly and freely available in machine readable form.

<p>
<li> You may modify the program in any way you wish provided that all of the
   following conditions are met:
    <ol>
    <li> Any modification in the source code is clearly marked as such;
    <li>No modification is made to the Readme file;
     <br> [Any documentation needed on your changes must therefore be made in a
      separate file].
 <li> The VNUMBER string is changed to "2.0(modified)";
      <br>[This string can be found near the top of analhea2.h].
  <li> You ensure that the HTML2.0 logo is never produced except when the
      output is HTML2.0 conformant;
     <br>[This logo is produced near the bottom of output.c. An HTML validator
      can be found at http://www.webtechs.com/html-val-svc/]
   <li>All of the conditions of this licence, and no other conditions, apply to
      your modified version.
</ol>
You may claim copyright for the parts of the program you have written.
<br>
   [You are encouraged to submit your changes to me for inclusion in subsequent
   versions of analog].

<p>
<li> No warranty of any sort, expressed or implied, is provided in connection
   with the program, including, but not limited to, implied warranties of
   merchantibility or fitness for a particular purpose. Any cost, loss or
   damage of any sort incurred owing to the malfunction or misuse of the
   program or the inaccuracy of the documentation or connected with the program
   in any other way whatsoever is the responsibility of the person who incurred
   the cost, loss or damage. By using this program you give up any right to
   seek any damages against me in connection with this program. 
<br>[I don't guarantee that the program doesn't contain bugs].
    
<p>
<li> I, Stephen Turner, reserve the right to make exceptions to any of these
   conditions, or alter these conditions, at any time. However, you may always
   use these conditions instead of any altered version if you prefer.
<br>
   [Note that this licence explicitly applies only to one version of
   analog. Therefore, if I make new conditions in connection with a future
   version, you do not then have the right to apply these conditions to that
   version instead].
</ol>
<p>
<address>
                                              Stephen R. E. Turner
<br>                                              Statistical Laboratory,
<br>                                              University of Cambridge
<br>                                              sret1@cam.ac.uk
<br>                                              5th February 1997
</address>
<hr>
<address><a HREF="http://www.statslab.cam.ac.uk/~sret1/home.html">Stephen Turner</a><br>
University of Cambridge Statistical Laboratory<br>
E-mail: <a HREF="mailto:sret1@cam.ac.uk">sret1@cam.ac.uk</a>
</address>
<p>
<!-- hhmts start -->
Page last modified: 05-Feb-97
<!-- hhmts end -->
</body> </html>
