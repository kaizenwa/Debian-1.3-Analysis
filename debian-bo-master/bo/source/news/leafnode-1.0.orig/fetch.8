.TH fetch 8 "30 Oct 1995" "Troll Tech AS" \" -*- nroff -*-
.\"
.\" Written by Arnt Gulbrandsen <agulbra@troll.no> and copyright 1995-96 Troll
.\" Tech AS, Postboks 6133 Etterstad, 0602 Oslo, Norway, fax +47 22646949.
.\"
.\" Use, modification and distribution is allowed without limitation,
.\" warranty, or liability of any kind.
.\"
.\" $Id: fetch.8,v 1.7 1996/06/23 21:33:52 agulbra Exp $
.\"
.\" hilit19 is stupid: "
.SH NAME
fetch \- fetch news via NNTP

.SH SYNOPSIS
.B fetch [-v] [-x number]

.SH DESCRIPTION
.B Leafnode
is a USENET package intended for small sites, where there are few
users and little disk space, but where a large number of groups is
desired.
.PP
The design of
.B leafnode
is intended to self-repair after problems, and to require no
manual maintenance.
.PP
.B Fetch
is the program which submits and retrieves new articles to or from the
upstream NNTP server.

.SH OPTIONS
.TP
.I -v
Be verbose.  More than one
.I -v
can be used.  Don't expect all the output to make sense.
.TP
.I "-x number"
Go
.I number
articles back and try to re-fetch what's missing.  Chiefly useful for
debugging.

.SH "FILES AND CONFIGURATION"
See
.BR leafnode (8)
for the list of files affected, and for information on configuring
.B fetch.

.SH ALGORITHM
Here is a brief description of what
.B fetch
does.
.PP
First, after connecting to the upstream NNTP server,
all articles in
.I /var/spool/news/out.going
are posted using POST.  If a posting fails, that article is moved to
.I /var/spool/news/failed.postings
which an administrator has to clean up once in a while.  Moving a file
back to
.I /var/spool/news/out.going 
is sufficient to resubmit it.
.PP
Second, the upstream server's list of newsgroups (obtained using LIST
ACTIVE) is merged into
.BR leafnode "'s"
(this step is most often optimized away).
.PP
Third,
.B fetch
iterates over the list of newsgroups, performing a GROUP, an XHDR
Message-ID and a number of ARTICLE commands for each group which has
been read during the past week.

.SH NOTES
.B Fetch
does not use NEWNEWS or XOVER.  NEWNEWS is not used because it is
often very expensive, XOVER is not used because the information it
obtains is also present in the article headers.
.PP
After some experiments, I decided that it was better to fetch all the
articles in a group than to optimize away some; users would complain
too loudly when the optmizer guessed wrongly.
.B Leafnode
is not intended to be all things to all men, and I have sacrificed the
ability to read news from two upstream servers.  (There is some support
for it, but it is incomplete and undocumented at the time of writing.)
.PP
.B Fetch
happens to support local groups, even though the rest of
.B leafnode
doesn't.
.PP
The only way to control what newsgroups are accessible to local users
is to control what the upstream server lets
.B fetch
read, and that will not keep out all crossposts (endemic in e.g. the
alt.sex groups).  If your site is big enough that you need to control
newsgroup access, consider using a news server which is designed for a
big site.
.PP
.B Fetch
sets its real and effective uid to "news", because almost all of the
problems I have had with
.B leafnode
are due to files which aren't writable for user news.

.SH BUGS
.B Fetch
ignores the "Supersedes" and "Also-Cancel" headers.  This needs to be
fixed, or news.answers will suffer.
.PP
Never deletes a group from the list of active newgroups.

.SH "AUTHOR AND LICENCE"
Written by Arnt Gulbrandsen <agulbra@troll.no> and copyright 1995-96
Troll Tech AS, Postboks 6133 Etterstad, 0602 Oslo, Norway, fax +47
22646949.
.PP
Use, modification and distribution is allowed without limitation,
warranty, or liability of any kind.

.SH SEE ALSO
.BR tcpd (8),
.BR hosts.allow (5),
.BR leafnode (8),
.BR texpire (8),
.B "RFC 977"
