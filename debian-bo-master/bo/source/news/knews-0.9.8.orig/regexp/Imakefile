#include "../knews.tmpl"

REGSRC		= regcomp.c regexec.c regerror.c regfree.c

OBJPRODN	= regcomp.o regexec.o regerror.o regfree.o

SRCS		= $(REGSRC)

OBJS		= $(OBJPRODN)

EXTRA_INCLUDES = -I.

/*
EXTRA_DEFINES = -DPOSIX_MISTAKE -DREDEBUG
*/

NormalLibraryTarget(regexp, $(OBJS))

DependTarget($(SRCS))

squeakyclean:
	rm -f *.ih

MKHFLAGS =
REGEXH=regex.h
REGEXHSRC=regex2.h $(REGSRC)

headers:
	sh ./mkh $(MKHFLAGS) -i _REGEX_H_ $(REGEXHSRC) >regex.tmp
	cmp -s regex.tmp regex.h 2>/dev/null || cp regex.tmp regex.h
	rm -f regex.tmp
	sh ./mkh $(MKHFLAGS) -p regcomp.c  >regcomp.ih
	sh ./mkh $(MKHFLAGS) -p engine.c   >engine.ih
	sh ./mkh $(MKHFLAGS) -p regerror.c >regerror.ih

# dependencies

regcomp.o:	cclass.h cname.h regex.h regex2.h
regexec.o:	engine.c engine.ih
regerror.o:	regerror.ih
