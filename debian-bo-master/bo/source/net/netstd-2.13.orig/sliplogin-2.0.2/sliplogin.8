.\" Copyright (c) 1990, 1991 The Regents of the University of California.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     from: @(#)sliplogin.8	5.4 (Berkeley) 8/5/91
.\"	$Id: sliplogin.8,v 1.6.1 1995/01/08 14:18:04 cgd Exp $
.\"
.Dd August , 1995
.Dt SLIPLOGIN 8
.Os
.Sh NAME
.Nm sliplogin
.Nd attach a serial line network interface
.Sh SYNOPSIS
.Nm sliplogin
.Op Ar loginname
.Sh DESCRIPTION
.Nm Sliplogin
is used to turn the terminal line on standard input into
a Serial Line IP
.Pq Tn SLIP
link to a remote host.  To do this, the program
searches the file
.Pa /etc/slip.hosts
for an entry matching
.Ar loginname
(which defaults to the current login name if omitted).
The loginname '*' in slip.hosts matches every user so everyone
who can execute sliplogin and is not listed in slip.hosts will use
this default entry. If you really need a default user, please put this
entry at the last line in slip.hosts, so it will be used if the sliplogin
user is not listed in slip.hosts. If you put the default user as
first entry in slip.hosts all other entries will be ignored.
.Pp
Another symbolic loginname is '+'. If a loginname starts with '+'
sliplogin will try to read the NIS map slip.hosts instead of slip.hosts.
You can override the local IP found in the NIS map by entering it after
the '+' sign.
If a matching entry is found, the line is configured appropriately
for slip (8-bit transparent i/o) and converted to
.Tn SLIP
line
discipline.  Then a shell script (slip.login) is invoked to initialize
the slip interface with the appropriate local and remote
.Tn IP
address,
netmask, etc.
.Pp
A line in slip.hosts usually consists of the fields loginname, local address,
remote address, netmask, slipmode, timeout and perhaps up to 3 more
options which will be passed to slip.login.
.Pp
The usual initialization script is
.Pa /etc/slip.login
but, if particular hosts need special initialization, the file
.Pa /etc/slip.login. Ns Ar loginname
will be executed instead if it exists.
If you use the default user '*' sliplogin looks for slip.login.*,
but '*' is not used as a wildcard. If no slip.login.* exists,
the usual slip.login will be used.
The script is invoked with the parameters
.Bl -tag -width slipunit
.It Em slipunit
The unit identifier of the slip interface assigned to this line.  E.g.,
.Sy sl0 .
.It Em speed
The speed of the line.
.It Em pid
The process id of sliplogin.
.It Em args
The arguments from the
.Pa /etc/slip.hosts
entry:
.Ar loginname, local address, remote address, netmask and the options.
.El
.Pp
Only the super-user may attach a network interface.  The interface is
automatically detached when the other end hangs up, the
.Nm sliplogin
process dies or the client didn't send a packet while the specified
timeout in /etc/slip.hosts.  If the kernel slip
module has been configured for it, all routes through that interface will
also disappear at the same time.  If there is other processing a site
would like done on hangup, the file
.Pa /etc/slip.logout
or
.Pa /etc/slip.logout. Ns Ar loginname
is executed if it exists.  It is given the same arguments as the login script.
For default user '*' sliplogin looks for slip.logout.* and if it doesn't
exist, it uses slip.logout.
.Ss Format of /etc/slip.hosts
Comments (lines starting with a `#') and blank lines are ignored.
Other lines must start with a
.Ar loginname
Arguments are separated by white space and follow normal
.Xr sh 1
quoting conventions (however,
.Ar loginname
cannot be quoted).
Usually, lines have the form
.Bd -literal -offset indent
loginname local-address remote-address netmask slipmode timeout opt-args
.Ed
.Pp
where
.Em local-address
is the IP host name or address of the local end of the slip line.
.Em remote-address
is the IP host name or address of the remote end of the slip line or the DYNAMIC keyword which will be translated into an address from the slip.tty file.
.Em netmask
is the appropriate IP netmask. 
These arguments are passed
directly to
.Xr ifconfig 8 .
.Em slipmode
is either normal, compressed, ax25, 6bit or auto where auto uses the
kernel auto detection to find out if the client uses normal or
compressed (Van Jacobson) slip.
.Em timeout
is ignored if negative or else used as value in seconds to wait for
packets to be sent from the client before
.Nm
sliplogin
terminates.
.Em Opt-args
are optional arguments used to configure the line.
.Ss The Format of /etc/slip.tty
is simple. A line that starts with '#' is treated as a comment otherwise
.Nm sliplogin
expects in column 1 the name of the slipdevice and in column 2 the 
IP host name or adress that you wish to assign to this device.
.Sh EXAMPLE
The normal use of
.Nm sliplogin
is to create a
.Pa /etc/passwd
entry for each legal, remote slip site with
.Nm sliplogin
as the shell for that entry.  E.g.,
.Bd -literal
Sfoo:ikhuy6:2010:1:slip line to foo:/tmp:/sbin/sliplogin
.Ed
.Pp
(Our convention is to name the account used by remote host
.Ar hostname
as
.Em Shostname . )
Then an entry is added to
.Pa slip.hosts
that looks like:
.Pp
.Bd -literal -offset indent -compact
Sfoo	`hostname`	foo	netmask
.Ed
.Pp
where
.Em `hostname`
will be evaluated by
.Xr sh
to the local host name and
.Em netmask
is the local host IP netmask.
.Pp
Note that
.Nm sliplogin
must be setuid to root and, while not a security hole, moral defectives
can use it to place terminal lines in an unusable state and/or deny
access to legitimate users of a remote slip line.  To prevent this,
a site can create a group, say
.Em slip ,
that only the slip login accounts are put in then make sure that
.Pa /sbin/sliplogin
is in group
.Em slip
and mode 4550 (setuid root, only group
.Em slip
can execute binary).
.Sh DIAGNOSTICS
.Nm Sliplogin
logs various information to the system log daemon,
.Xr syslogd 8 ,
with a facility code of
.Em daemon .
The messages are listed here, grouped by severity level.
.Pp
.Sy Error Severity
.Bl -tag -width Ds -compact
.It Sy ioctl (TCGETS): Em reason
A
.Dv TCGETS
.Fn ioctl
to get the line parameters failed.
.Pp
.It Sy ioctl (TCSETS): Em reason
A
.Dv TCSETS
.Fn ioctl
to set the line parameters failed.
.Pp
.It Sy /etc/slip.hosts: Em reason
The
.Pa /etc/slip.hosts
file could not be opened.
.Pp
.It Sy access denied for Em user
No entry for
.Em user
was found in
.Pa /etc/slip.hosts .
.El
.Pp
.Sy Notice Severity
.Bl -tag -width Ds -compact
.It Sy "attaching slip unit" Em unit Sy for Ar loginname
.Tn SLIP
unit
.Em unit
was successfully attached.
.El
.Pp
.Sh BUGS
No bugs found yet.
.Pp
.Sh SEE ALSO
.Xr slattach 8 ,
.Xr syslogd 8 ,
.Xr dip 8
.Sh HISTORY
The
.Nm
command
.Bt
