# CFINGERD by Ken Hollis
# Released under the GPL

MAKE= $0
CC= gcc
CFLAGS= -O2 -Wall -m486
VERSION= 1.3.1

ewps:
		@echo
		@echo "Options are:"
		@echo
		@echo "make clean    - clean all remaining object/make files"
		@echo "make install  - make and install cfingerd"
		@echo "make instdocs - make and only install the documentation"
		@echo "make all      - make cfingerd, install, and check"
		@echo

src:		cfingerd

cfingerd:
		@echo
		@echo "Compiling cfingerd, one moment."
		@echo
		cd src ; $(MAKE) cfingerd

do_cfingerd:
		@if [ -e src/config.h ]; then \
		$(MAKE) cfingerd; \
		else \
		echo; \
		echo "You need to type Configure before compiling."; \
		echo; \
		exit; \
		fi

clean:
		@echo
		@echo "Cleaning out directories..."
		@echo
		cd src ; $(MAKE) clean
		cd userlist ; $(MAKE) clean
		rm -f Makefile
		cp Makefile.clean Makefile

install:	do_cfingerd
		./Install

instdocs:
		./Install -docs

archive:
		@make clean
		@echo
		@echo -n "Archiving cfingerd $(VERSION) ... "
		@cd .. ; tar -czf cfingerd-$(VERSION).tar.gz cfingerd-$(VERSION)
		@echo "completed."
		@echo

all:		do_cfingerd
		$(MAKE) install
		cd userlist ; $(MAKE) install
		cd docs ; $(MAKE) install
