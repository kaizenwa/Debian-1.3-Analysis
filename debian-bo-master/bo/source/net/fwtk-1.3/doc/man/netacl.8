.\" Marcus J. Ranum, 1993
.\" Copyright (C) Trusted Information Systems, Inc.
.\" All rights reserved
.TH NETACL 8 "23 August 1993"
.SH NAME
netacl - TCP network access control
.SH SYNOPSIS
.B netacl servicename
[invoked from inetd]
.SH DESCRIPTION
.IX  "netacl"  ""  "\(em network access control"
.LP
.B netacl
provides a degree of access control for TCP-based services
invoked from
.B inetd(8).
When a server is started,
.B inetd
invokes netacl with the name of the service requested, instead
of the actual server.
.B netacl
then searches its permissions information (read from
.B netperm-table
) to see if the host initiating the connection is authorized.
If the host is authorized, the real server process is invoked.
Otherwise,
.B netacl
exits. Acceptance or rejection of the service is logged via the
.B syslog
facility.
.LP
.B netacl
duplicates functionality found in other tools such as
.B log_tcp
by Wietse Venema, but is included with the toolkit
because it is a simpler implementation, contains no 
support for UDP services, and shares a common configuration
file with the rest of the toolkit components.
.SH OPTIONS
.LP
.B netacl
takes one parameter: the name of the service it is to
provide. This service name is appended to the string "netacl-"
to generate the name by which rules are read from the
.B netperm-table
configuration file. If invoked with no parameters,
the service is assumed to be the program name - in
case one needs to replace the executable of some daemon
with a copy of
.B netacl.
For example, if
.B netacl
is invoked as:
.br
.I netacl in.telnetd
.br
it will retrieve all the configuration rules for
.I netacl-in.telnetd.
.LP
The following configuration rules are recognized:
.TP
.B hosts [options]
specifies a host permission rule. Host permission rules are
in the form of:
.sp
.na
netacl-in.telnet permit-hosts host1 host2 -options
netacl-in.telnet deny-hosts host1 host2 -options
.ad
.sp
Following the
.B permit-hosts
or
.B deny-hosts
clause is a list of host names or IP-addresses, which can
contain wildcards. Host names are searched in order
until the first option (starting with a '-') is encountered,
at which point, if there is a match for that rule, it will
be accepted. If the rule is a deny-hosts rule, the program
will log the denial of service and exit. If it is a
permit-hosts rule, the options will be processed and
executed in order.
If there is no rule explicitly permitting or deny a service,
the service is denied. Options are:
.IP
.B \-exec executable [args]
specifies a program to invoke to handle the service. This
option
.B must
be the final option in the rule. A -exec
option
.B must
be present in every rule.
.IP
.B \-user userid
where userid is the numeric UID or the name from a login in
.B /etc/passwd which the program should be invoked as.
.IP
.B \-chroot rootdir
specifies a directory to which
.B netacl
should chroot(2) prior to invoking the service program. This
requires that the service program be present, and the pathname
for the executable be relative to the new root.
.SH EXAMPLES
.LP
In this example, the \\ line wraps have been added to fit
lines on the page. \\-escapes are not permitted in 
.B netperm-table,
they are here as part of the example only
.sp
.na
netacl-in.telnetd: permit-hosts 192.33.112.* \\
       -exec /usr/etc/in.telnetd
.br
netacl-in.ftpd: permit-hosts unknown \\
       -exec /bin/cat /usr/local/etc/noftp.txt
.br
netacl-in.ftpd: permit-hosts 192.33.112.* \\
       -exec /usr/etc/in.ftpd
.br
netacl-in.ftpd: permit-hosts * -chroot /home/ftp \\
       -exec /bin/ftpd -f
.ad
.LP
In the example above,
.B netacl
is configured to permit telnet only for hosts in a particular
subnet.
.B ftpd
is configured to accept all connections from systems that do
not have a valid DNS name ("unknown") and to invoke
.B cat
to display a file when a connection is made. This provides an
easy and flexible means of politely informing someone that they
are not permitted to use a service. Hosts in the specified
subnet are connected to the real FTP server in
.B /usr/etc/in.ftpd
but all connections from other networks are connected to a
version of the FTP server that is already chrooted to the
FTP area, effectively making all FTP activity "captive".
.SH INSTALLATION
.LP
To install
.B netacl
first place the executable in a system area, then modify
.B /etc/inetd.conf
as desired, replacing entries for the servers that will be
controlled via
.B netacl.
For example (syntax may differ slightly depending on O/S version)
the FTP service might be configured as:
.sp
.nf
ftp stream tcp nowait root /usr/local/etc/netacl in.ftpd
.fi
.sp
Once inetd.conf has been modified, restart or reload
.B inetd.
Verify installation by attempting a connection, and
monitoring the system logs.
.SH FILES
.PD 0
.TP 20
.B /etc/inetd.conf
.B netperm-table
.SH SEE ALSO
.BR netperm-table (5)
.BR inetd (8)
.SH BUGS
