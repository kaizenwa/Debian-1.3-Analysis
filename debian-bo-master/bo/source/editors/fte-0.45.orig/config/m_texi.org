#
#                         TeXinfo mode for FTE
#
#  $Id: M_TEXI.FTE 1.2 1996/11/24 17:06:57 KHM Exp $ 
# ----------------------------------------------------------------------------
#                      (c) Karl Heinz Marbaise 1996
# ----------------------------------------------------------------------------
#
# $Log: M_TEXI.FTE $
# Revision 1.2  1996/11/24 17:06:57  KHM
# - @contents forgotten.
#
# Revision 1.1  1996/11/24 13:23:07  KHM
# Initial revision
#
#
#
# Description:
#     This Syntax Highlight mode based on TeXinfo Edition 2.18
#     Alle extensions to Texinfo Edition 2.23 were marked with
#     a comment like "## Texinfo  2.23"
#     I hope I don't forget some.
#
# Known Bugs:
#     o This version of the TeXinfo Mode does not
#       correctly handle a situation like this:
#       @footnote{A @code{B}}
#       This is a problem of FTE syntax analyser which
#       the Author of FTE is working on.
#     o If you use a keyword behind @end which was not
#       allowed you already got it highlight, because
#       I don't check all the valid keywords.
#       Might be done in a future version.
#
# If you found a Bug:
#     o If you think you found a bug within this highlight mode
#       or find something what does not work like you expected
#       or If I forgot some reserverd words so write to me
#       
#       e-mail: KHMarbaise@p69.fs.fido.de
#
#menu Tools {
#    item "&Compile...\tF9" { Compile "mktex " } ## CMD File TeXinfo => DVI
#    item "&View..." { Compile "vp " }           ## DVIPM emTeX
#    item "&Grep..." { Compile "grep -n " }
#    item;
#    item "&Shell\tAlt+F9" { RunProgram "" }
#    item "&Run...\tCtrl+F9" { RunProgram }
#    item;
#    item "&Previous error\tF11" { CompilePrevError }
#    item "&Next error\tF12" { CompileNextError }
#    item;
#    item "&Messages\tS+F9" { ViewMessages }
#    item "C&lear Messages" { ClearMessages }
#}


colorize TEXINFO {
    SyntaxParser        = 'SIMPLE';
    
    color {
        { 'Normal',      '-7' },
        { 'Tag',         '-B' },
        { 'Comment',     '-A' },
        { 'Special',     '-3' },
        { 'Quotes',      '-E' },
        { 'Function',    '-C' },
        { 'Keyword',     '-F' },
    };
    
    h_state 0 { 'Normal' }

    ## Different definitions for comments
    h_trans { 0, '$', '\@c', 'Comment' }
    h_trans { 1, '','\@comment ', 'Comment' }
    h_trans { 1, '', '\@c ', 'Comment' }

    h_trans { 0, '', '\@asis', 'Keyword' }     ## Texinfo 2.23 

    h_trans { 2, '^', '\@appendix ', 'Keyword' }
    h_trans { 2, '^', '\@appendixsec ', 'Keyword' }
    h_trans { 2, '^', '\@appendixsections ', 'Keyword' }
    h_trans { 2, '^', '\@appendixsubsec ', 'Keyword' }
    h_trans { 2, '^', '\@appendixsubsubsec ', 'Keyword' }
    h_trans { 2, '^', '\@author ', 'Keyword' }
    # Special handling cause "@bye" ends working of texinfo mode.
    # So no texinfo macros are allowed behing "@bye"
    h_trans { 0, '^$', '\@bye', 'Keyword' }
    h_trans { 2, '^', '\@center ', 'Keyword' }
    h_trans { 2, '^$', '\@contents', 'Keyword' }
    h_trans { 2, '^', '\@centerchap ', 'Keyword' }  ## Texinfo 2.23
    h_trans { 2, '^', '\@chapheading ', 'Keyword' }
    h_trans { 2, '^', '\@chapter ', 'Keyword' }
    h_trans { 2, '^', '\@cindex ', 'Keyword' }
    h_trans { 2, '^', '\@clear ', 'Keyword' }
    h_trans { 2, '^', '\@defcodeindex ', 'Keyword' }
    h_trans { 2, '^', '\@defcv ', 'Keyword' }
    h_trans { 2, '^', '\@deffn ', 'Keyword' }
    h_trans { 2, '^', '\@defindex ', 'Keyword' }
    h_trans { 2, '^', '\@defivar ', 'Keyword' }
    h_trans { 2, '^', '\@defmac ', 'Keyword' }
    h_trans { 2, '^', '\@defmethod ', 'Keyword' }
    h_trans { 2, '^', '\@defop ', 'Keyword' }
    h_trans { 2, '^', '\@defopt ', 'Keyword' }
    h_trans { 2, '^', '\@defspec ', 'Keyword' }
    h_trans { 2, '^', '\@deftp ', 'Keyword' }
    h_trans { 2, '^', '\@deftypfn ', 'Keyword' }
    h_trans { 2, '^', '\@deftypefun ', 'Keyword' }
    h_trans { 2, '^', '\@deftypevr ', 'Keyword' }
    h_trans { 2, '^', '\@deftypevar ', 'Keyword' }
    h_trans { 2, '^', '\@deffun ', 'Keyword' }
    h_trans { 2, '^', '\@defvar ', 'Keyword' }
    h_trans { 2, '^', '\@defvr ', 'Keyword' }
    h_trans { 2, '^', '\@dircategory ', 'Keyword' } ## Texinfo 2.23
    h_trans { 0, '^$', '\@direntry', 'Keyword' }    ## Texinfo 2.23
    h_trans { 2, '^', '\@display ', 'Keyword' }

    ## Here we don't check every valid keyword behind
    ## @end.
    h_trans { 2, '^', '\@end ', 'Keyword' }

    ## first stand alone in line
    ## second followed by text
    h_trans { 0, '^$', '\@enumerate', 'Keyword' }
    h_trans { 2, '^', '\@enumerate ', 'Keyword' }

    h_trans { 2, '^', '\@evenfooting ', 'Keyword' }
    h_trans { 2, '^', '\@evenheading ', 'Keyword' }
    h_trans { 2, '^', '\@everyfooting ', 'Keyword' }
    h_trans { 2, '^', '\@everyheading ', 'Keyword' }
    h_trans { 0, '^$', '\@example', 'Keyword' }     ## Special handling
    h_trans { 2, '^', '\@exdent ', 'Keyword' }
    h_trans { 0, '^$', '\@finalout', 'Keyword' }
    h_trans { 2, '^', '\@findex ', 'Keyword' }
    h_trans { 0, '^$', '\@flushleft', 'Keyword' }
    h_trans { 0, '^$', '\@flushright', 'Keyword' }
    h_trans { 2, '^', '\@footnotestyle ', 'Keyword' }
    h_trans { 0, '^$', '\@format', 'Keyword' }
    h_trans { 2, '^', '\@ftable ', 'Keyword' }
    ## It is not allowed to put something behind @group
    h_trans { 0, '^$', '\@group', 'Keyword' }
    h_trans { 2, '^', '\@heading ', 'Keyword' }
    h_trans { 2, '^', '\@headings ', 'Keyword' }
    h_trans { 2, '^', '\@ifclear ', 'Keyword' }
    ## Should stay alone on line
    h_trans { 0, '^$', '\@ifinfo', 'Keyword' }
    h_trans { 0, '^$', '\@ifhtml', 'Keyword' }  ## Texinfo 2.23
    h_trans { 2, '^', '\@ifset ', 'Keyword' }
    ## Should stay alone on a line
    h_trans { 0, '^$', '\@iftex', 'Keyword' }
    ## Could stay allone on a line
    ## Might changed so that the ignored text is colored
    ## until @end ignore
    h_trans { 0, '^$', '\@ignore', 'Keyword' } 
    h_trans { 2, '^', '\@include ', 'Keyword' }

    ## Here we have to check if this works well.
    h_trans { 2, '^', '\\input ', 'Keyword' } 

    ## Could stay alone
    ## and also in combinations with something
    h_trans { 0, '^$', '\@item', 'Keyword' }
    h_trans { 2, '^', '\@item ', 'Keyword' }
    
    h_trans { 2, '^', '\@itemize ', 'Keyword' }
    h_trans { 0, '^$', '\@itemize', 'Keyword' }

    h_trans { 0, '^$', '\@itemx', 'Keyword' }
    h_trans { 2, '^', '\@itemx ', 'Keyword' }
    
    h_trans { 2, '^', '\@kindex ', 'Keyword' }
    ## Could stay alone I'm not sure about (check the manual)
    h_trans { 0, '^$', '\@lisp', 'Keyword' }
    h_trans { 2, '^', '\@majorheading ', 'Keyword' }
    ## Should stay alone
    ## I'm thinking about a special behaviour to
    ## color the whole definition of the menu.
    ## until "@end menu" reached
    h_trans { 0, '^$', '\@menu', 'Keyword' }
    h_trans { 2, '^', '\@need ', 'Keyword' }
    h_trans { 2, '^', '\@node ', 'Keyword' }
    ## Could stay within text.
    h_trans { 0, '^$', '\@noindent', 'Keyword' }
    h_trans { 2, '^', '\@oddfooting ', 'Keyword' }
    h_trans { 2, '^', '\@oddheading ', 'Keyword' }
    ## Page break, I don't know if there is something allowed
    ## behind it.
    h_trans { 0, '^$', '\@page', 'Keyword' }
    h_trans { 2, '^', '\@paragraphindent ', 'Keyword' }
    h_trans { 2, '^', '\@pindex ', 'Keyword' }
    ## Two styles allowed @printindex cp
    ## @printindex
    h_trans { 2, '^', '\@printindex ', 'Keyword' }
    h_trans { 0, '^$', '\@printindex', 'Keyword' }

    h_trans { 0, '^$', '\@quotation', 'Keyword' }
    
    ## Could be a part of the text.
    h_trans { 0, '', '\@refill', 'Keyword' }


    h_trans { 2, '^', '\@section ', 'Keyword' }
    h_trans { 2, '^', '\@set ', 'Keyword' }
    h_trans { 2, '^', '\@setchapternewpage ', 'Keyword' }
    h_trans { 2, '^', '\@setfilename ', 'Keyword' }
    h_trans { 2, '^', '\@settitle ', 'Keyword' }
    h_trans { 2, '^', '\@shortcontens ', 'Keyword' }
    h_trans { 0, '^$', '\@smallbook', 'Keyword' }
    h_trans { 0, '^$', '\@smallexample', 'Keyword' }
    h_trans { 0, '^$', '\@smalllisp', 'Keyword' }
    h_trans { 2, '^', '\@sp ', 'Keyword' }
    h_trans { 2, '^', '\@strong ', 'Keyword' }
    h_trans { 2, '^', '\@subheading ', 'Keyword' }
    h_trans { 2, '^', '\@subsection ', 'Keyword' }
    h_trans { 2, '^', '\@subsubheading ', 'Keyword' }
    h_trans { 2, '^', '\@subsubsection ', 'Keyword' }
    h_trans { 2, '^', '\@subtitle ', 'Keyword' }
    h_trans { 0, '^$', '\@summarycontents', 'Keyword' }
    h_trans { 2, '^', '\@syncodeindex ', 'Keyword' }
    h_trans { 2, '^', '\@synindex ', 'Keyword' }
    h_trans { 2, '^', '\@table ', 'Keyword' }

    ## Here we have to go to new state which
    ## handles tex-mode until @end tex found
    h_trans { 0, '^$', '\@tex', 'Keyword' }
    h_trans { 0, '^$', '\@thischapter', 'Keyword' }
    h_trans { 0, '^$', '\@thischaptername', 'Keyword' }
    h_trans { 0, '^$', '\@thisfile', 'Keyword' }
    h_trans { 0, '^$', '\@thispage', 'Keyword' }
    h_trans { 0, '^$', '\@thistitle', 'Keyword' }
    h_trans { 2, '^', '\@tindex ', 'Keyword' }
    h_trans { 2, '^', '\@title ', 'Keyword' }
    h_trans { 0, '^$', '\@titlepage', 'Keyword' }
    h_trans { 2, '^', '\@top ', 'Keyword' }
    h_trans { 2, '^', '\@unnumbered ', 'Keyword' }
    h_trans { 2, '^', '\@unnumberedsec ', 'Keyword' }
    h_trans { 2, '^', '\@unnumberedsubsec ', 'Keyword' }
    h_trans { 2, '^', '\@unnumberedsubsubsec ', 'Keyword' }
    h_trans { 2, '^', '\@vindex ', 'Keyword' }
    h_trans { 2, '^', '\@vskip ', 'Keyword' }
    h_trans { 2, '^', '\@vtable ', 'Keyword' }

    ## These keywords are a allowed to stand
    ## everywhere within the text.
    ## That seemed to be working
    h_trans { 3, '<', '\@value\{', 'Tag' }
    h_trans { 3, '<', '\@b\{', 'Tag' }
    h_trans { 3, '<', '\@code\{', 'Tag' }
    h_trans { 3, '<', '\@file\{', 'Tag' }
    h_trans { 3, '<', '\@email\{', 'Tag' } ## Texinfo 2.23
    h_trans { 3, '<', '\@H\{', 'Tag' }     ## Texinfo 2.23
    h_trans { 3, '<', '\@cite\{', 'Tag' }
    h_trans { 3, '<', '\@xref\{', 'Tag' }
    h_trans { 3, '<', '\@pref\{', 'Tag' }
    h_trans { 3, '<', '\@ref\{', 'Tag' }
    h_trans { 3, '<', '\@samp\{', 'Tag' }
    h_trans { 3, '<', '\@kbd\{', 'Tag' }
    h_trans { 3, '<', '\@footnote\{', 'Tag' }


    ## To use those keywords you have to write them
    ## in that manner no other style is valid.
    h_trans { 0, '', '\@TeX\{\}', 'Tag' }
    h_trans { 0, '', '\@bullet\{\}', 'Tag' }
    h_trans { 0, '', '\@copyright\{\}', 'Tag' }
    h_trans { 0, '', '\@dots\{\}', 'Tag' }
    h_trans { 0, '', '\@equiv\{\}', 'Tag' }
    h_trans { 0, '', '\@error\{\}', 'Tag' }
    h_trans { 0, '', '\@expansion\{\}', 'Tag' }
    h_trans { 0, '', '\@minus\{\}', 'Tag' }
    h_trans { 0, '', '\@point\{\}', 'Tag' }
    h_trans { 0, '', '\@print\{\}', 'Tag' }
    h_trans { 0, '', '\@result\{\}', 'Tag' }
    h_trans { 0, '', '\@today\{\}', 'Tag' }
    h_trans { 0, '', '\@AA\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@aa\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@AE\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@ae\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@enddots\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@equiv\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@exclamdown\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@L\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@l\{\}', 'Tag' } ## Texinfo 2.23
    h_trans { 0, '', '\@expansion\{\}', 'Tag' }

    ## Special sequences
    h_trans { 0, '', '\@\*', 'Special'}
    h_trans { 0, '', '\@\.', 'Special'}
    h_trans { 0, '', '\@:', 'Special'}
    h_trans { 0, '', '\@\@', 'Special'}
    h_trans { 0, '', '\@\{', 'Special'}
    h_trans { 0, '', '\@\}', 'Special'}
    h_trans { 0, '', '\@"', 'Special'}  ## Texinfo 2.23
    h_trans { 0, '', '\@\'', 'Special'} ## Texinfo 2.23
    h_trans { 0, '', '\@!', 'Special'}  ## Texinfo 2.23
    h_trans { 0, '', '\@,', 'Special'}  ## Texinfo 2.23
    h_trans { 0, '', '\@-', 'Special'}  ## Texinfo 2.23
    h_trans { 0, '', '\@?', 'Special'}  ## Texinfo 2.23
        ### this has to be changed, cause
        ### one character more is connected with @^ command.
    h_trans { 0, '', '\@\^', 'Special'}  ## Texinfo 2.23
    h_trans { 0, '', '\@=', 'Special'}  ## Texinfo 2.23
    
    ### Comments
    h_state 1 { 'Comment' }
    h_trans { 0, '$', '', 'Comment' }

    ### Keywords like @node
    ### @sections
    ### These are keywords which are working
    ### only on a line.
    h_state 2 { 'Keyword' }
    h_trans { 0, '$', '', 'Keyword' }

    ## Inclusive everything until closing right brace
    ## This might cause problems because
    ## there are commands like @footnote {...}
    ## which allow nesting of commands.
    ## Like: @footnote{Test @code{Atnon} Hi there}
    ## This is not handled correct.
    h_state 3 { 'Tag'}
    h_trans { 0, '>', '\}', 'Tag' }

    ## For @end menu and other stuff.
    ##     @end example 
    h_state 4 { 'Keyword'}
    h_trans { 0, '>', '$', 'Keyword'}


    ## This is only for testing.
    h_state 5 { 'Keyword' }
    h_words '-C' { 'anton', 'egon', 'maier' }
    h_trans { 0, '$', '', 'Keyword'}
}

mode TEXINFO: PLAIN {
    FileNameRx          = /\.\c{TEX}|{STY}|{TEXI}|{TEXINFO}$/;
    HilitOn             = 1;
    Colorizer           = 'TEXINFO';
    MultiLineHilit      = 1;

    SaveFolds           = 2;      # save fold info at end of line
    CommentStart        = '';
    CommentEnd          = '';
}
