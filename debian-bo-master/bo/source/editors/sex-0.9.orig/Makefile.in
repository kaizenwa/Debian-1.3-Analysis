#
# Makefile for SeX
#

VPATH = @srcdir@
srcdir = @srcdir@

CC = @CC@
CFLAGS = @CPPFLAGS@ -I@x_includes@ @CFLAGS@ -I.
LDFLAGS = @LDFLAGS@ -L@x_libraries@
LIBS = -l@PUBNAME@ -lXaw -lXmu -lXt -lX11 -lXext -lm -lc

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@

prefix = /usr/local
bindir=$(prefix)/bin
mandir=$(prefix)/man
man1dir=$(mandir)/man1
appdir=$(prefix)/lib/app-defaults
docdir=$(prefix)/doc/sex

objs = sex.o buflist.o editwin.o win.o x.o font.o actions.o killring.o \
	cmd-cut.o cmd-move.o cmd-misc.o selections.o searchwin.o \
	cmd-search.o menu.o filewin.o cmd-file.o cmd-win.o endprompt.o \
	error.o cmd-selection.o msgwin.o config.o status.o anchor.o tab.o

all: sex manual

install: all
	$(INSTALL_PROGRAM) sex $(bindir)
	$(INSTALL_DATA) $(srcdir)/sex.1 $(man1dir)/sex.1
	$(INSTALL_DATA) $(srcdir)/SeX $(appdir)/SeX
	$(INSTALL_DATA) -d $(manualdir)/sex-manual.html
	$(INSTALL_DATA) sex-manual.html/* $(manualdir)/sex-manual.html

clean:
	rm -f sex *.o core SeX.h

manual: sex-manual.html/index.html
sex-manual.html/index.html: $(srcdir)/doc/sex-manual.sgml
	debiandoc2html $(srcdir)/doc/sex-manual.sgml

sex: $(objs) 
	$(CC) $(LDFLAGS) -o sex $(objs) $(LIBS)

SeX.h: SeX
	$(srcdir)/ad2c $(srcdir)/SeX > SeX.h

sex.o: x.h
actions.o: actions.h cmd.h win.h selections.h filewin.h error.h
anchor.o: anchor.h win.h x.h
buflist.o: buflist.h error.h
cmd-cut.o: cmd.h win.h killring.h error.h anchor.h
cmd-file.o: cmd.h win.h filewin.h error.h config.h buflist.h x.h anchor.h
cmd-move.o: cmd.h win.h filewin.h selections.h error.h x.h anchor.h tab.h
cmd-misc.o: cmd.h win.h error.h x.h anchor.h tab.h
cmd-search.o: cmd.h searchwin.h win.h selections.h error.h anchor.h
cmd-selection.o: cmd.h win.h anchor.h tab.h x.h error.h
cmd-win.o: cmd.h win.h buflist.h anchor.h
config.o: config.h
editwin.o: editwin.h x.h font.h error.h tab.h
endprompt.o: endprompt.h cmd.h win.h x.h error.h
error.o: error.h
filewin.o: filewin.h cmd.h win.h x.h error.h
font.o: font.h x.h error.h
menu.o: menu.h cmd.h win.h error.h
msgwin.o: msgwin.h cmd.h win.h x.h error.h
searchwin.o: searchwin.h win.h x.h error.h
selections.o: selections.h win.h cmd.h killring.h error.h anchor.h
status.o: status.h win.h tab.h
tab.o: tab.h
win.o: win.h editwin.h x.h font.h cmd.h searchwin.h error.h menu.h \
	msgwin.h buflist.h status.h anchor.h
x.o: x.h win.h config.h actions.h font.h cmd.h buflist.h SeX.h
killring.o: killring.h error.h
