<HTML>
<HEAD>
<TITLE>YABASIC, basic for Unix and Win95</TITLE>
</HEAD>

<BODY> 
<H1>yabasic 2.0, yet another basic for unix and win95</H1>

This document contains some information about my little
basic-interpreter.<P>

In short it implements the most common (and simple) elements of the
langugage plus some Grafic facilities; anyone, who has
ever written basic-programs on a <B>C64</B> should feel at home.<P>

This page is the html-description of the yabasic. There is no further
documentation, neither a unix-man-page nor a win95-helpfile.
<BR>
<HR>
<A NAME="contents">Covered issues are:</A>
<UL>
  <LI> <A HREF="#Unix">Unix: </A>
  <UL> <LI> <A HREF="#Unixusage">Usage,</A>
       <LI> <A HREF="#Unixoptions">options,</A>
       <LI> <A HREF="#Unixcustom">setting defaults </A>
  </UL>
  <LI>
  <A HREF="#Win95">Win95: </A>
  <UL>
       <LI> <A HREF="#Win95usage">Usage,</A>
       <LI> <A HREF="#Win95options">options,</A>
       <LI> <A HREF="#Win95custom">setting defaults</A>
  </UL>
  <LI> <A HREF="#description"> Language Description </A> by examples
  <UL>
     <LI> <A HREF="#e1"> <CODE>rem,for,input,print,goto</CODE></A>
     <LI> <A HREF="#e2"> <CODE>gosub,on gosub,return</CODE></A>
     <LI> <A HREF="#e3"> <CODE>dim,read,data,restore</CODE></A>
     <LI> <A HREF="#e4"> <CODE>open,close</CODE></A>
     <LI> <A HREF="#ot"><CODE>wait,bell</CODE></A>
     <LI> <A HREF="#fu"> Functions in examples</A>
     <LI> <A HREF="#gr"> Grafics in examples</A>
     <LI> <A HREF="#pr"> Printing</A>
     <LI> <A HREF="#in"> Internal Variables</A>
  </UL>
  <LI> <A HREF="#internals"> Internals </A>
  <LI> <A HREF="#copy"> Copyleft </A>
</UL>

<HR>
<H2><A NAME="Unix">Unix</A></H2>
<H3><A NAME="Unixusage">Unix usage </A></H3>
Invoking yabasic under Unix is simple:
<BLOCKQUOTE>
  <CODE> yabasic </CODE><EM>[options] [filename]</EM>
</BLOCKQUOTE>
Where <EM>filename</EM> is the name of the file, containing the
basic-Program.<P>
If you type <CODE>yabasic</CODE> without any filename, the program
will read from standard input until you type <CODE>RETURN</CODE> twice.

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3>Under Unix the following <A NAME="Unixoptions"> options </A>
are supported:</H3>

<DL>
  <DT><CODE>-h</CODE>
  <DD>Prints out a short help message; <CODE>-help</CODE> or
      <CODE>-?</CODE> are accepted as well.
  <DT><CODE>-fg</CODE> <VAR>foreground-color</VAR>
  <DD>Sets the foreground color for grafics. The usual X colornames
      like <EM>red, green</EM> are accepted.
  <DT><CODE>-bg</CODE> <VAR>background-color</VAR>
  <DD> Sets the background color.
  <DT><CODE>-geometry</CODE> <VAR>geometry-string</VAR>
  <DD>The usual X geometry-string will be accepted (e.g. <CODE>+10+10</CODE>),
       but any window size will be ignored. 
  <DT><CODE>-display</CODE> <VAR>Name-of-Display</VAR>
  <DD>Name of the Display, where the window should appear.
  <DT><CODE>-font</CODE> <VAR>Name-of-font</VAR>
  <DD>Name of the font which will be used for grafics text.
  <DT><CODE>-i</CODE>
  <DD>Sets the initial <A NAME="infolevel">infolevel</A>. 
      This controls the amount
      of information one gets about the progress of program execution,
      Every level contains all lower levels (e.g. <CODE>w</CODE>
      contains <CODE>f</CODE> and <CODE>e</CODE>).
      and can be one of:
  <DL>	
     <DT><CODE>d</CODE>
     <DD> Set the inoflevel to <EM> diagnostic </EM>: This 
          gives detailed	 debugging information; much more
          output than you'd like to read.
     <DT><CODE>n</CODE>
     <DD> <EM> note </EM>: Useful information; e.g. about
          execution time and memory consumption.
     <DT><CODE>w</CODE>
     <DD> <EM> warning </EM>: Gives you warnings, that something
          has gone wrong (e.g. division by zero); nevertheless
          execution proceeds.
     <DT><CODE>e</CODE>
     <DD><EM> error </EM>: There is a serious error (e.g. array boundary
          violation), stopping the program.
     <DT><CODE>f</CODE>
     <DD><EM> fatal </EM>: Something has gone wrong an cannot be ment;
          the interpreter exits immediately. Most often in the course
	  of an arithmetic fault (floating point exception).
  </DL>
  The initial infolevel is <CODE>w</CODE>.
</DL>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3> Examples for for Unix</H3>
<BLOCKQUOTE>
<CODE> yabasic -i d test.yab </CODE>
</BLOCKQUOTE>
calls the interpreter to execute the file <CODE>test.yab</CODE>,
reporting in detail about its work.

<BLOCKQUOTE>
<CODE> yabasic test.yab </CODE>
</BLOCKQUOTE>
The same as above, but with inolevel=<EM>warning</EM> (the default).

<BLOCKQUOTE>
<CODE> yabasic </CODE>
</BLOCKQUOTE>
Now You have to type in your program by hand. Press <CODE>RETURN</CODE> 
twice, when done.

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="Unixcustom">Setting defaults under Unix</A></H3>
The colors, the text-font and the window position should be set on the
<A HREF="#options"> command-line </A>, or specified
in the users resource file; e.g. like:
<BLOCKQUOTE>
<PRE>
  yabasic*foreground: blue
  yabasic*background: gold
  yabasic*geometry: +10+10	
  yabasic*font: 9x15
</BLOCKQUOTE>
</PRE>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H2><A NAME="Win95">Win95</A></H2>
<H3><A NAME="Win95usage">Usage under Win95</A></H3>
After you have run the setup program, yabasic can be invoked in three ways:
<UL>
<LI> Choose "yabasic" in the start-menu: This allows for typing
in your program immediatly on the console-window.
<LI> Click with the right mousebutton on the root window. Choose 'new' in
the context-menu appearing; this gives you a new icon on your desktop.
Its context-menu has the two entries 'execute' and 'edit'. Doubleclick
executes the program.
<LI> Create a file containing your yabasic-program. This file
should have the extension ".yab". Double-click on this file then
invokes yabasic, executing your program.
</UL>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="Win95options">Options for Win95</A></H3>
<DL>
  <DT><CODE>-h</CODE>
  <DD>Prints out a short help message; <CODE>-help</CODE> or
      <CODE>-?</CODE> are accepted as well.
  <DT><CODE>-geometry</CODE> <VAR>geometry-string</VAR>
  <DD> E.g. <CODE>+10+10</CODE> will place the grafic-window 10 pixels below
       and left of the upper left corner of the screen.
  <DT><CODE>-font</CODE> <VAR>Name-of-font</VAR>
  <DD>Name of the font which will be used for grafics text.
      Can be any of: <BR><CODE>decorative, dontcare, modern, 
      roman, script, swiss</CODE>
  <DT><CODE>-i</CODE>
  <DD>Sets the initial infolevel. This controls the amount
      of information one gets about the progress of program execution,
      Every level contains all lower levels (e.g. <CODE>w</CODE>
      contains <CODE>f</CODE> and <CODE>e</CODE>).
      and can be one of:
  <DL>	
     <DT><CODE>d</CODE>
     <DD> Set the inoflevel to <EM> diagnostic </EM>: This 
          gives detailed	 debugging information; much more
          output than you'd like to read.
     <DT><CODE>n</CODE>
     <DD> <EM> note </EM>: Useful information; e.g. about
          execution time and memory consumption.
     <DT><CODE>w</CODE>
     <DD> <EM> warning </EM>: Gives you warnings, that something
          has gone wrong (e.g. division by zero); nevertheless
          execution proceeds.
     <DT><CODE>e</CODE>
     <DD><EM> error </EM>: There is a serious error (e.g. array boundary
          violation), stopping the program.
     <DT><CODE>f</CODE>
     <DD><EM> fatal </EM>: Something has gone wrong an cannot be ment;
          the interpreter exits immediately. Most often in the course
	  of an arithmetic fault (floating point exception).
  </DL>
  The initial infolevel is <CODE>w</CODE>.
</DL>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="Win95custom">Customization under Win95</A></H3>
To choose the default-values for grafic-font, fontsize and windowposition,
You have to edit the registry<P>
Yabasic stores its defaults under:<BR>
<BLOCKQUOTE>
HKEY_LOCAL_MACHINE/SOFTWARE/yabasic
</BLOCKQUOTE>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H2><A NAME="description"> Language Description </A></H2>
Instead of giving a detailed language description, which can be
found in many books, I will reproduce here some simple
Programs (all of them totally useless for themselves).<P>
<A NAME="e1">The</A> first one introduces half of the language:
<BLOCKQUOTE>
<PRE>
rem  this is a simple test-program !
REM  This is a comment
label loop
  for a=1 to 100 step 2:print a:next a
  input "once more ? (y/n)" a$
if (a$="y" or a$="j") then goto loop 
            else print "byebye" fi
</PRE>
</BLOCKQUOTE>
Among others, the following things can be seen:
<UL>
  <LI> The <CODE>REM</CODE>-statement is used to start comments, which
       extend til the end of the line.
  <LI> Command names are not case sensitive (variables and functions are).
  <LI> There are no line numbers; if you want to jump
       to a specific location you have to put a label there.
  <LI> The only loop is the <CODE>for</CODE>-loop. The <CODE>step</CODE>-part
       is optional, its got to be a <B>plain number</B> !
  <LI> Commands are delimited by a colon (&quot;:&quot;) or
       the <EM>newline</EM> character.
  <LI> There are two sorts of variables; <EM>double</EM> like 
       <CODE> a,b,LongName </CODE> and <EM>strings</EM>
       like <CODE> a$,b$ </CODE> marked with a trailing Dollar sign.
  <LI> The <CODE>if</CODE> statement has an optional <CODE>else</CODE>
       branch, and has to be ended with <CODE>fi</CODE> 
       or <CODE>endif</CODE>
</UL>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<A NAME="e2">The</A> next example introduces the <CODE>gosub</CODE> statement
<BLOCKQUOTE>
<PRE>
rem This Program is good for nothing ...
input "Please enter a number" num
on num gosub one,two,three,four,five,six,seven
end
label one:print "one":return
label two:print "two":return
rem 
rem     guess you can imagine the rest ...
rem
</PRE>
</BLOCKQUOTE>
In fact, it shows the even cooler <CODE> ON GOSUB </CODE> statement;
depending on the value of <CODE>num</CODE> the execution is continued 
at the labels
<CODE>one</CODE>, <CODE>two</CODE> and so on.<CODE> ON GOTO </CODE>
can be used as well.
Furthermore you see, that the input statement can handle an
optional prompt string (which is <EM>not</EM> separated by a comma)
<P>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<A NAME="e3">Now</A> it's time for arrays and 
<CODE>READ</CODE>, <CODE>DATA</CODE>,
<CODE>RESTORE</CODE>:
<BLOCKQUOTE>
<PRE>
rem Show READ,DATA,RESTORE and ARRAYS !
restore table:read length
dim number(length),name$(length)
rem NOTE: number has length+1 elements ! 
rem       The index can start from zero !
for a=1 to length:read number(a),name$(a):next a

label table:rem here comes the data
data 4,1,"one",2,"two",3,"three",4,"four"
</PRE>
</BLOCKQUOTE>

The <CODE>RESTORE</CODE> statement comes with an optional label; 
<CODE>DATA</CODE> lines can appear anywhere in the code.
As you see, every array has to be dimed before first use;
there is no limit on array size but array dimension has to be
less than 10.<P>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<A NAME="e4">The</A> last example tells about I/O:

<BLOCKQUOTE>
<PRE>
open 1,"numbers","w"
print #1 "one, two, three"
close 1
</PRE>
</BLOCKQUOTE>

Every file has to be opened; giving it:
<UL>
<LI> A number for identification (here 1), which ranges from 1 to 9.
     This number is <EM>not</EM> related to the standard UNIX file
     numbers; especially 1 and 2 are <EM>not</EM> stdout or stderr.
<LI> A filename in usual UNIX convention.
<LI> A string giving the access mode. This string is directly used
     in the underlying C-call <CODE>fopen()</CODE>; so its meaning
     can be found in any C-book.
     Here is a selection:
     <UL>
     <LI><CODE>r</CODE>: read only.
     <LI><CODE>w</CODE>: overwrite file if it already exists, create
         and write otherwise.
     <LI><CODE>a</CODE>: append to file.
     </UL>
</UL>
In any print or input statement the file number has to appear preceded
by a hash (#).<BR>
The file is closed with <CODE>close</CODE> (guess you're not surprised).<P>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="ot"> Other commands </A></H3>
Right now these are the following two:
<DL>
  <DT><CODE>wait</CODE> <EM>seconds</EM>
  <DD>Waits a specified number of seconds, which can be any real number.<BR>
      <CODE>pause</CODE> will be understood as well.
  <DT><CODE>bell</CODE>
  <DD>Ring the terminals bell.
</DL>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="fu"> Functions in examples: </A></H3>
<DL>
   <DT>sin,asin,cos,acos
   <DD> These are the trigonometric functions, operating in
	Radian; i.e. <CODE>sin(3.14159) = -1.0</CODE>.
        By the way: there is a predefined variable <CODE>PI</CODE>,
	so you might as well write <CODE>sin(PI)</CODE>.
   <DT>tan,atan
   <DD> These are trigonometric functions too, but at least
        <CODE>atan</CODE> offers an additional feature:
        <CODE>atan(x/y)</CODE> can be replaced by <CODE>atan(x,y)</CODE>;
	the latter comes from the C-function <CODE>atan2()</CODE> and
        has the advantage of giving the right angle in the full span
        from 0 to 2*PI.
   <DT>exp,log
   <DD>These are exponential and logarithmic functions for the
       base 2.71828 , which is predefined in the variable <CODE>EULER</CODE>
   <DT>sqrt
   <DD>Is the normal square root, i.e. <CODE>sqrt(2)=1.41421</CODE>.
   <DT>int, frac
   <DD>Give integer and fractional Part of an arithemtic expression:
       <CODE>int(3.141)</CODE>=3.0 and <CODE>frac(3.141)</CODE>=0.141.
   <DT>left$,right$,mid$
   <DD>Are the well known (I hope so) string-functions:
       <CODE>left$("12345",2)="12"</CODE><BR>
       <CODE>right$("12345",2)="56"</CODE><BR>
       <CODE>mid$("12345",3,2)="34"</CODE><BR>
   <DT>len
   <DD>Gives the length of a string: <CODE>len("123456")=6.0</CODE>.
   <DT>val
   <DD>Tries to read a string as a number: <CODE>val("12.0")=12.0</CODE>
       and <CODE>val("Hello2.0")=0.0</CODE>	
   <DT>str$
   <DD>Just the opposit: <CODE>str$(12.0)="12.000000"</CODE>
</DL>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="gr"> Grafics in examples: </A></H3>
yabasic includes some rudimental grafics:
<BLOCKQUOTE>
<PRE>
rem
rem All features of grafic
rem
print "Test of Grafic"
open window 400,400

line 200,0 to 200,400
line 0,200 to 400,200

text "test",120,120
text 100,100,"test" : rem      both variants work ...

input "press RETURN ..." a$
clear window
for a=0 to 400:dot a,200+100*sin((a-200)/30):next a

circle 200,200,150
input "Press RETURN ..." a$

clear window
close window
</BLOCKQUOTE>
</PRE>
As You can see from the listing, there are commands to open, clear
and close a single window, to draw lines, circles, text and dots.<BR>
<CODE> open window </CODE> takes three arguments, specifying the x,y-extension
of the window to be created and the height of the font, used 
for printertext.<P> You can just as well call <CODE>open window</CODE>
with zero or two arguments. Missing data will be taken from
the appropriate <A HREF="#in">internal variables</A> 
<CODE>yabwinwidth, yabwinheight, yabfontheight</CODE>.

This is <EM> all </EM> there is for grafic !<P>

So, you can not change colors or any line properties, you
can not open multiple windows and you can not erase any single dot.
Some of these features might be added in the future ... <P>

The size of the window is specified in the <CODE>open window</CODE> command;
any value given in the geometry-resource is ignored.

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="pr"> Printing </A></H3>
Printing is simple (and identical under Win95 and Unix):
<BLOCKQUOTE>
<PRE>
open printer "printeroutput"
open window 400,400
line 200,0 to 200,400
close printer
close window
</BLOCKQUOTE>
</PRE>
As you see, there are only two commands related with printing:
<DL>
<DT><CODE>open printer </CODE><EM>[filename]</EM>
<DD>Opens <EM>filename</EM> and starts printing. From now on, every
grafic-command will be executed on screen and paper.<BR>
<EM>filename</EM> can be omitted, printer commands will then be send
to the printer directly.
<DT><CODE>close printer</CODE>
<DD>stops printing. If you print to file, the file will be closed.
If you print to the printer directly, the page will be printed.
</DL>
Every grafic-command between <CODE>open printer</CODE> and 
<CODE>close printer</CODE> is mirrored to paper. 
The grafics well be scaled to fit on a DIN-A4-sheet. 
<P>
If you want to print without opening a window, you've got to tell
the computer, how large the window would have been. Yabasic needs
this info to scale the printer-output correctly.
This information can be passed using the three 
<A HREF="#in">internal variables</A> <CODE>yabwinwidth, yabwinheight,
yabfontheight</CODE>.

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3><A NAME="in"> Internal variables </A></H3>
Internal Variables can be read or assigned as any other 
variable (E.g. <CODE>yabwinwidth=100</CODE>).
But their value influences the way, yabasic works. Every internal
variable starts with <CODE>yab</CODE>.<P>
There are three internal variables connected with grafics:
<UL>
<LI> <CODE>yabwinwidth</CODE>: specifies the the default width of the
grafic window. This value will be used, if the call of
<CODE>open window</CODE> doesn't specify this value. The initial
value is 100.
<LI> <CODE>yabwinheight</CODE>: specifies the the default height of the
grafic window. This is a fallback-value too. The initial value is 100.
<LI> <CODE>yabfontheight</CODE>: specifies the the default height of the
graficfont. This is a fallback-value too. The initial value is 10.
</UL>
Finally, there are six variables to set the 
<A HREF="#infolevel">infolevel</A> at runtime:
<UL>
<LI><CODE>yabinfolevel</CODE> set this to any of the next five
variables, to change the infolevel during execution of the program.
<LI><CODE>yabfatal</CODE>: fatal-infolevel.
<LI><CODE>yaberror</CODE>: error-infolevel.
<LI><CODE>yabwarning</CODE>: warning-infolevel.
<LI><CODE>yabnote</CODE>: note-infolevel.
<LI><CODE>yabdiagnostic</CODE>: diagnostic-infolevel.
</UL>
A valid assignement would be <CODE>yabinfolevel=yabnote</CODE>, setting
the infolevel to note.

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H2><A NAME="internals"> Internals </A></H2>
yabasic has been written in an attempt to learn
Flex and Bison. Which are the prime tools used for
its construction. 9610 Bytes of Flex and Bison instructions resulted
in 81896 Bytes of C-code, which has to be compared with the 62960 Bytes
C-code I wrote myself, coding the rest of yabasic. So most of
the code has been generated by Flex and Bison !<P>

Although yabasic behaves mostly like an interpreter, in fact it is not;
Rather it's a compiler: If you give it any basic-code for execution,
the code is compiled yielding instructions for a simple stack-machine;
these instructions are then interpreted immedeately, so that you will never
get in touch with the stack-machine. You can find out the time
needed for this process, if you invoke yabasic with infolevel set to
<CODE>note</CODE>.<P>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H2><A NAME="copy"> Copyrights </A></H2>
Yabasic is due to the GNU copyleft, which (in a nutshell)
gives you every freedom, except the right to restrict other people's
freedom. To get an idea of it I just reproduce the preamble
of the GNU copyleft; the exact terms can be found in the file
<CODE>COPYING</CODE> which comes along as part of the distribution, or
can be obtained from the Free Software Foundation, Inc., 675 Mass Ave, 
Cambridge, MA 02139, USA.<P>

<P>
<A HREF="#contents">Back to table of contents ...</A>
<HR>
<H3>Preamble</H3>

  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Library General Public License instead.)  You can apply it to
your programs, too.<P>

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.<P>

  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.<P>

  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.<P>

  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.<P>

  Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.<P>

  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.<P>

</PRE>
</BODY>
