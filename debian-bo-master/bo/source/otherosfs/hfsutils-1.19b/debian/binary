#!/bin/sh -ex
#
# Script to build a Debian binary package
# Version 1.5
#
# Robert Leslie <rob@mars.org>

test $# -eq 4 || exit 1

PKG="$1"
VER="$2"
ARC="$3"
TMP="$4"

rm -rf $TMP
umask 022

install -m 755 -d $TMP/DEBIAN
sed -e "2s/=/$VER/" -e "3s/=/$ARC/" debian/control > $TMP/DEBIAN/control
chown 0.0 $TMP/DEBIAN/control
chmod 644 $TMP/DEBIAN/control

install -m 755 -d $TMP/usr/doc/copyright
install -m 644 debian/README $TMP/usr/doc/copyright/$PKG

# hfsutils proper

install -m 755 -d $TMP/usr/{bin,man/man1}

make install  \
	DESTDIR="$TMP/usr"  \
	BININSTALL="install -s -c -m 755"
