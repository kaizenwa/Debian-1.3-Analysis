		     <!-- -*-Indented-text-*- -->
<!doctype manpage public "-//JFW//DTD Manpage//EN"[
<!ENTITY % remark "ignore" >
<!ENTITY instdir system "instdir">
]>
<manpage
author="Joerg Wittenberger"
date="28. 4. 1995"
>bbset
<short>correct the bounding box of an EPS file
<synopsis>
<code>bbset <var>file
<descript>
Bbset sets the <code/%%BoundingBox:/ comment in the header of a
PostScript file to the correct value. The corrected file is written to
the standard output.

The corrected <code/%%BoundingBox:/ comment either replaces the old
comment of the same name or it inserted right before the 
<code/%%EndComments/ comment.

The page is rendered with ghostscript using <code/bb4gs.ps/. ( If this
is not in the path searched by ghostscript, it may be fetched from
<code>&instdir;/bin</code>.)


<![ %Literat [
The source:
<literate file="bbset"<rverb>
#!/bin/sh
# I hate this shell! I hope the day is close I can do those things
# from the rc shell. /jfw.

# usage: bbset file
#  The computed value is then written instead of the old
#  %%BoundingBox comment or inserted right before the %%EndComments.
#  The result is printed to stdout.

TMP="bbset$$"
TMP2="";

# Refer to the doc for bb4gs what the following command is good for.

echo /show /print load def > $TMP

if [ x$1 != x ]
then
  INFILE=$1;
else
  TMP2=bbset2$$;
  cat > $TMP2 
  INFILE=$TMP2;
fi

GS_LIB=&instdir;/bin
export GS_LIB
</rverb>
<verb>

BB="`(gs -dSAFER -dNODISPLAY $TMP bb4gs.ps $INFILE quit.ps ; \
      echo ' ') | sed -n -e /%%BoundingBox/p`"

# Write a short sed script to exchange/insert the new %%BoundingBox

cat >$TMP <<EOF
:head
/%%BoundingBox/ {
d
i\\
$BB
b rest
}

/%%EndComments/ {
i\\
$BB
b rest
}

n
b head

:rest
n
b rest
EOF

sed -f $TMP $INFILE

rm $TMP $TMP2
</verb>
</literate>]]>

<files>
<desc
<dt/bb4gs.ps/ Must be somewhere in the path searched by ghostscript.
</desc>

<see>
See <ref t=m id="gs(1)"//.
