#  Makefile - Top-level Makefile for af.
#  Copyright (C) 1992, 1993, 1994, 1995, 1996 Malc Arnold.
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2, or (at your option)
#  any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  */
#
#
##############################################################################
# RCS Info
#
# $Id: Makefile,v 1.18 1996/10/17 18:49:08 malc Exp $
#
##############################################################################
# Required programs
SHELL=/bin/sh
MAKE=make

# The files generated by Configure
CONFIG=config.status config.cache config.log

# The current version of af
VERSION=1.99-beta

# How to make af
all: config.status
	cd doc ; $(MAKE) $(MFLAGS) all
	cd lib ; $(MAKE) $(MFLAGS) all
	cd src ; $(MAKE) $(MFLAGS) all

# How to lint everything
lint: config.status
	cd lib ; $(MAKE) $(MFLAGS) lint
	cd src ; $(MAKE) $(MFLAGS) lint

# How to install everything
install: all
	cd afl ; $(MAKE) $(MFLAGS) install
	cd doc ; $(MAKE) $(MFLAGS) install
	cd src ; $(MAKE) $(MFLAGS) install

# How to clean up
clean:
	cd doc ; $(MAKE) $(MFLAGS) clean
	cd lib ; $(MAKE) $(MFLAGS) clean
	cd src ; $(MAKE) $(MFLAGS) clean

# How to clean up everything
distclean:
	cd afl ; $(MAKE) $(MFLAGS) distclean
	cd doc ; $(MAKE) $(MFLAGS) distclean
	cd lib ; $(MAKE) $(MFLAGS) distclean
	cd src ; $(MAKE) $(MFLAGS) distclean
	rm -f $(CONFIG)

# How to make a distribution
dist:
	mkdir af-$(VERSION)
	cp Makefile COPYING README INSTALL install.sh af-$(VERSION)
	cp configure configure.in aclocal.m4 af-$(VERSION)
	mkdir af-$(VERSION)/afl
	cp afl/*.in afl/*.afl af-$(VERSION)/afl
	mkdir af-$(VERSION)/doc
	cp doc/*.in doc/af.help doc/*.man af-$(VERSION)/doc
	cp doc/*.texi doc/*.tex af-$(VERSION)/doc
	mkdir af-$(VERSION)/lib
	cp lib/*.in lib/*.[ch] af-$(VERSION)/lib
	mkdir af-$(VERSION)/src
	cp src/*.in src/*.[ch] src/*.sh af-$(VERSION)/src
	rm -f af-$(VERSION)/src/config.h
	(cd af-$(VERSION)/doc; makeinfo af.texi)
	chmod -R u+w af-$(VERSION)
	tar cvf af-$(VERSION).tar af-$(VERSION)
	rm -fr af-$(VERSION)

# And how to make config.status
config.status: configure
	$(SHELL) ./configure
