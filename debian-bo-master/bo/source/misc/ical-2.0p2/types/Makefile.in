# Copyright (c) 1995 by Sanjay Ghemawat

       srcdir = @srcdir@
        VPATH = $(srcdir)

          CXX = @CXX@
    CXXLINKER = $(CXX)

 MALLOC_DEBUG = @MALLOC_DEBUG@
   MALLOC_LIB = @MALLOC_LIB@

           RM = rm
           AR = ar
         ECHO = echo
       RANLIB = @RANLIB@

     CXXFLAGS = -O2
      CXXINCS = -I.. -I$(srcdir) $(MALLOC_DEBUG)
         OBJS = bitvec.o hashfuncs.o intset.o ht_priv.o
        TESTS = testarray testbv testomap testoset timemap testhash testmap

all: libtypes.a

libtypes.a: $(OBJS)
	$(RM) -f $@
	$(AR) r $@ $(OBJS)
	$(RANLIB) $@

tests: $(TESTS)

testarray: testarray.o
	$(CXXLINKER) -o $@ testarray.o $(MALLOC_LIB)

testbv: testbv.o bitvec.o
	$(CXXLINKER) -o $@ testbv.o bitvec.o $(MALLOC_LIB)

testomap: testomap.o libtypes.a
	$(CXXLINKER) -o $@ testomap.o libtypes.a $(MALLOC_LIB)

testoset: testoset.o libtypes.a
	$(CXXLINKER) -o $@ testoset.o libtypes.a $(MALLOC_LIB)

testhash: testhash.o libtypes.a
	$(CXXLINKER) -o $@ testhash.o libtypes.a $(MALLOC_LIB)

testmap: testmap.o ht_priv.o
	$(CXXLINKER) -o $@ testmap.o ht_priv.o $(MALLOC_LIB)

timemap: timemap.o libtypes.a
	$(CXXLINKER) -o $@ timemap.o libtypes.a $(MALLOC_LIB)

timemap.o: $(srcdir)/timemap.C
	$(CXX) $(CXXFLAGS) -DNDEBUG $(CXXINCS) -c $(srcdir)/timemap.C

clean::
	$(RM) -f *.o *.a Makefile.bak malloc.log $(TESTS)

.SUFFIXES: .C

.C.o:
	$(CXX) $(CXXFLAGS) $(CXXINCS) -c $<

# DO NOT DELETE THIS LINE -- make depend depends on it.

bitvec.o: $(srcdir)/basic.h
bitvec.o: $(srcdir)/mdebug.h
bitvec.o: $(srcdir)/bitvec.h
hashfuncs.o: $(srcdir)/hashfuncs.h
ht_priv.o: $(srcdir)/ht_priv.h
intset.o: $(srcdir)/intset.h
intset.o: $(srcdir)/intcontrol.h
intset.o: $(srcdir)/htable.h
intset.o: $(srcdir)/htable_p.h
intset.o: $(srcdir)/ht_priv.h
testarray.o: $(srcdir)/Array.h
testarray.o: $(srcdir)/basic.h
testarray.o: $(srcdir)/mdebug.h
testbv.o: $(srcdir)/bitvec.h
testhash.o: $(srcdir)/intset.h
testhash.o: $(srcdir)/intcontrol.h
testhash.o: $(srcdir)/htable.h
testmap.o: $(srcdir)/intcontrol.h
testmap.o: $(srcdir)/hmap.h
testmap.o: $(srcdir)/htable.h
testmap.o: $(srcdir)/hmap_p.h
testmap.o: $(srcdir)/htable_p.h
testmap.o: $(srcdir)/ht_priv.h
testomap.o: $(srcdir)/ohashmap.h
testomap.o: $(srcdir)/basic.h
testomap.o: $(srcdir)/mdebug.h
testomap.o: $(srcdir)/hashfuncs.h
testoset.o: $(srcdir)/ohashset.h
testoset.o: $(srcdir)/basic.h
testoset.o: $(srcdir)/mdebug.h
testoset.o: $(srcdir)/hashfuncs.h
timemap.o: $(srcdir)/Array.h
timemap.o: $(srcdir)/basic.h
timemap.o: $(srcdir)/mdebug.h
timemap.o: $(srcdir)/ohashmap.h
timemap.o: $(srcdir)/ohashset.h
timemap.o: $(srcdir)/intcontrol.h
timemap.o: $(srcdir)/hashfuncs.h
timemap.o: $(srcdir)/hashfuncs.C
timemap.o: $(srcdir)/htable.h
timemap.o: $(srcdir)/htable_p.h
timemap.o: $(srcdir)/ht_priv.h
timemap.o: $(srcdir)/hmap.h
timemap.o: $(srcdir)/hmap_p.h
