# Copyright (c) 1993 by Sanjay Ghemawat

       srcdir = @srcdir@
        VPATH = $(srcdir)

          CXX = @CXX@
    CXXLINKER = @CXXLINKER@

 MALLOC_DEBUG = @MALLOC_DEBUG@
   MALLOC_LIB = @MALLOC_LIB@

           RM = rm
           AR = ar
         ECHO = echo
       RANLIB = @RANLIB@

     CXXFLAGS = -O2
      CXXINCS = -I.. -I$(srcdir) $(MALLOC_DEBUG)
         OBJS = Date.o Month.o Time.o WeekDay.o Year.o parse.o
        TESTS = testparse

all: libtime.a

libtime.a: $(OBJS)
	$(RM) -f $@
	$(AR) r $@ $(OBJS)
	$(RANLIB) $@

check: tests
	@echo checking time/date parsers
	@testparse < $(srcdir)/parse.in | diff -c $(srcdir)/parse.out -

tests: $(TESTS)

testparse: testparse.o libtime.a
	$(CXXLINKER) -o $@ testparse.o libtime.a $(MALLOC_LIB)

clean::
	$(RM) -f *.o *.a Makefile.bak malloc.log $(TESTS)

.SUFFIXES: .C

.C.o:
	$(CXX) $(CXXFLAGS) $(CXXINCS) -c $<

# DO NOT DELETE THIS LINE -- make depend depends on it.

Date.o: $(srcdir)/Date.h
Date.o: $(srcdir)/Time.h
Date.o: $(srcdir)/Month.h
Date.o: $(srcdir)/WeekDay.h
Date.o: $(srcdir)/Year.h
Month.o: $(srcdir)/Month.h
Month.o: $(srcdir)/Year.h
Time.o: $(srcdir)/Month.h
Time.o: $(srcdir)/WeekDay.h
Time.o: $(srcdir)/Time.h
WeekDay.o: $(srcdir)/WeekDay.h
Year.o: $(srcdir)/Year.h
parse.o: $(srcdir)/../types/Array.h
parse.o: $(srcdir)/../types/basic.h
parse.o: $(srcdir)/../types/mdebug.h
parse.o: $(srcdir)/Date.h
parse.o: $(srcdir)/Month.h
parse.o: $(srcdir)/WeekDay.h
parse.o: $(srcdir)/Year.h
testparse.o: $(srcdir)/Date.h
testparse.o: $(srcdir)/Month.h
testparse.o: $(srcdir)/WeekDay.h
testparse.o: $(srcdir)/Year.h
testparse.o: $(srcdir)/parse.h
testparse.o: $(srcdir)/Time.h
