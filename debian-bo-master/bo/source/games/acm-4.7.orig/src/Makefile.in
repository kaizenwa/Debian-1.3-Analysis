
      srcdir = @srcdir@

# "prefix" needs to be in the first column for autoconf-1.7 to substitute
prefix = /usr/local

      bindir = $(prefix)/bin
       VPATH = @srcdir@
       SHELL = /bin/sh
          CC = @CC@
       SLIBS = @LIBS@
     INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@
STD_INCLUDES = -I. -I$(srcdir) -I$(srcdir)/../V/lib
      TOPDIR = ..
 CLEAN_THESE = flight-state black_box_input black_box_output bitmap.h
      manext = 1
  MAKEDEPEND = makedepend


ACM_OBJECT_LIBRARY = $(prefix)/games/acm/
   PROGRAMS = acm acms
    DEFINES = -DACM_LIBRARY=\"$(ACM_OBJECT_LIBRARY)\"
     CFLAGS = -O $(DEFINES) @DEFS@ $(STD_INCLUDES)
      SRCS1 = server.c pm.c gear.c flaps.c droneCalc.c init.c aim9m.c\
		box.c \
		m61a1.c weapon.c newPlayer.c newPlane.c inventory.c missile.c\
		newObserver.c chaser.c \
		missileCalc.c update.c doEvents.c getStick.c\
		damage.c panel.c doViews.c hud.c hsi.c navaid.c windows.c\
		doRadar.c placeCraft.c transpose.c doScale.c \
		interpolate.c resupply.c air.c effects.c \
		imath.c alarm.c audio.c
      OBJS1 = server.o pm.o gear.o flaps.o droneCalc.o init.o aim9m.o\
		box.o \
		m61a1.o weapon.o newPlayer.o newPlane.o inventory.o missile.o\
		newObserver.o chaser.o \
		missileCalc.o update.o doEvents.o getStick.o\
		damage.o panel.o doViews.o hud.o hsi.o navaid.o windows.o\
		doRadar.o placeCraft.o transpose.o doScale.o \
		interpolate.o resupply.o air.o effects.o \
		imath.o alarm.o audio.o

      SRCS2 = acm.c
      OBJS2 = acm.o
       VLIB = ../V/lib/libV.a
BITMAP_FILES = $(srcdir)/eng.xbm $(srcdir)/flaps0.xbm \
		$(srcdir)/flaps1.xbm $(srcdir)/flaps2.xbm \
		$(srcdir)/flaps3.xbm $(srcdir)/gearDown.xbm \
		$(srcdir)/gearTran.xbm $(srcdir)/gearUp.xbm \
		$(srcdir)/handleDn.xbm $(srcdir)/handleUp.xbm
       SRCS = $(SRCS1) $(SRCS2)

all:	$(PROGRAMS)

acm:	$(OBJS2)
	$(CC) $(CFLAGS) -o $@ $(OBJS2) $(SLIBS)

acms:	$(OBJS1) $(VLIB)
	$(CC) $(CFLAGS) -o $@ $(OBJS1) $(VLIB) $(SLIBS)

../V/lib/libV.a:
	cd ../V/lib; $(MAKE) -e

mostlyclean clean:
	rm -f $(PROGRAMS) *.o core *~

TAGS:	$(SRCS)
	etags $(SRCS)

distclean:
	rm -f Makefile $(CLEAN_THESE)

realclean:	distclean
	rm -f TAGS

install: $(PROGRAMS) kill-acms
	$(INSTALL_PROGRAM) acm $(bindir)/acm
	$(INSTALL_PROGRAM) acms $(bindir)/acms
	$(INSTALL_PROGRAM) kill-acms $(bindir)/kill-acms
	$(INSTALL_DATA) $(srcdir)/acm.man \
		$(prefix)/man/man$(manext)/acm.$(manext)

uninstall:
	rm -f $(bindir)/acm $(bindir)/acms

doViews.o: bitmap.h

newPlayer.o: bitmap.h

bitmap.h: $(BITMAP_FILES)
	grep '^#define' $(BITMAP_FILES) | sed -e 's/^.*://g' > $@

depend: bitmap.h
	$(MAKEDEPEND) $(DEFINES) @DEFS@ $(STD_INCLUDES) $(SRCS)

# DO NOT DELETE THIS LINE -- make depend depends on it.
