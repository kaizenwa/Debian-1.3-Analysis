# ---------------------------------------------------------------------------#
# /etc/pam.conf								     #
#									     #
# Modified by Andrew Morgan <morgan@parc.power.net>			     #
#									     #
# ---------------------------------------------------------------------------#
# $Id: pam.conf,v 1.18 1997/02/15 20:20:20 morgan Exp $
#
# $Log: pam.conf,v $
# Revision 1.18  1997/02/15 20:20:20  morgan
# update for .56
#
# Revision 1.17  1997/02/15 15:54:20  morgan
# removed module paths from the modules.. these now have a default value
#
# Revision 1.16  1997/01/04 21:58:32  morgan
# update for .55
#
# Revision 1.15  1996/12/01 03:28:47  morgan
# update for .54 (for SimplePAMApps mostly)
#
# Revision 1.14  1996/11/10 19:50:12  morgan
# updated for .53 . use pwdb for su and passwd and added an entry for
# the latest example "check_user".
#
# ---------------------------------------------------------------------------#

# ---------------------------------------------------------------------------#
# serv.	module	 ctrl		module [path]	...[args..]		     #
# name	type	 flag							     #
# ---------------------------------------------------------------------------#

#
# SimplePAMApps-0.52+ login uses libpwdb
#
login	auth	 required	pam_pwdb.so
login	auth	 optional	pam_mail.so 
login	account  required	pam_pwdb.so
login   session	 required 	pam_pwdb.so
login	session	 optional	pam_lastlog.so
login	password required 	pam_pwdb.so

#
# test application: blank
# stress_test module: pam_stress.so
#
# 'debug' option sends stuff to syslog (NB with this option *passwords*
#         are sent to syslog too)
#
# see Linux-PAM-0.XX/modules/pam_stress/README for more info.
#

blank	auth	 required	pam_stress.so
blank	ACCOUNT	 required	pam_stress.so
blank	account	 required	pam_time.so
blank	password required	pam_stress.so
blank	session	 required	pam_stress.so

#
# the next line applies some annoying transposition to all input/output
#
xsh	auth	 required	pam_filter.so run1 \
					/usr/sbin/pam_filter/upperLOWER
#
# uncomment the next line to apply the transposition a second time (undo it)
# this is done on the second function in the auth module.. ie. at the
# setting credential stage..
#
#xsh	auth	 required	pam_filter.so run2 \
#					/usr/sbin/pam_filter/upperLOWER
#
xsh	auth	 required	pam_stress.so
xsh	account	 required	pam_time.so debug
xsh	account	 required	pam_stress.so
xsh	password required	pam_stress.so
xsh	session  required	pam_stress.so

# check_user:
check	auth	 required	pam_unix_auth.so
check	account	 required	pam_unix_acct.so

# ---------------------------------------------------------------------------#
#									     #
# real applications					        	     #
#							                     #
# ---------------------------------------------------------------------------#

# SimpleApps-0.51 'su' configured to use pam_pwdb

su	auth	 sufficient	pam_rootok.so
su	auth	 requisite	pam_wheel.so
su	auth	 required	pam_pwdb.so
su	account  required	pam_pwdb.so
su	password required	pam_pwdb.so
su	session	 required	pam_pwdb.so

# 'passwd' program configured to use pwdb module, strength checking via
# cracklib.

passwd	password required	pam_cracklib.so	retry=3
passwd	password required	pam_pwdb.so	use_authtok debug

# rlogind configuration

rlogind	auth	 sufficient	pam_rhosts_auth.so
rlogind	auth	 required	pam_unix_auth.so
rlogind ACCOUNT	 required	pam_unix_acct.so
rlogind	password required	pam_unix_passwd.so
rlogind	session	 required	pam_unix_sess.so

#
# default; deny access
#

OTHER	auth	 required	pam_deny.so
OTHER	account	 required	pam_deny.so
OTHER	password required	pam_deny.so
OTHER	session	 required	pam_deny.so

#
# the following are commented out....
#
# ftp	auth	required	pam_skey_auth.so    debug
# ftp	session	required	pam_unix_session.so
#
