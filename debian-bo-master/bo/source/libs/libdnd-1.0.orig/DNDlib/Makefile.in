# Makefile for the DND Xt library
#
# Cesar Crusius - 1996

CC = @CC@
CFLAGS = -I.@CFLAGS@@X_CFLAGS@

CXX = @CXX@
CXXFLAGS = -I.@CXXFLAGS@ @X_CFLAGS@

LDFLAGS = @LDFLAGS@

RANLIB = @RANLIB@

LIBS = @LIBS@@X_LIBS@@X_PRE_LIBS@ -lXmu -lXaw -lXt -lX11@X_EXTRA_LIBS@

prefix = @prefix@
exec_prefix = @exec_prefix@
LIB_DIR = @libdir@
INC_DIR = @includedir@/OffiX

COMPILE = $(CC) $(INCLUDES) $(CFLAGS) -c
CXXCOMPILE = $(CXX) $(INCLUDES) $(CXXFLAGS) -c
LINK = $(CC) $(LDFLAGS) -o $@

default: all

all: libC libCpp dndtest

install: libCpp libC
	install -d $(INC_DIR)
	install DragAndDrop.h DragAndDropTypes.h $(INC_DIR)
	install -d $(LIB_DIR)
	install libDnd.a libDnd++.a $(LIB_DIR)

libC: libDnd.a

libCpp: libDnd++.a

dndtest: dndtest.c libDnd.a
	rm -f dndtest
	$(COMPILE) dndtest.c
	$(LINK) dndtest.o -L. -lDnd $(LIBS)

libDnd.a: DragAndDrop.c
	rm -f DragAndDrop.o
	$(COMPILE) DragAndDrop.c
	rm -f libDnd.a
	$(AR) cru libDnd.a DragAndDrop.o
	$(RANLIB) libDnd.a

libDnd++.a: DragAndDrop.c
	rm -f DragAndDrop.o DragAndDrop.cxx
	ln -s DragAndDrop.c DragAndDrop.cxx
	$(CXXCOMPILE) DragAndDrop.cxx
	rm -f libDnd++.a
	$(AR) cru libDnd++.a DragAndDrop.o
	$(RANLIB) libDnd++.a

clean:
	rm -f *.o *.cxx *.a dndtest *~ *bak

