<HTML>
<HEAD>
<TITLE>The DND internals</TITLE>
</HEAD>
<BODY>
<A NAME="DNDinternals"></A> <H1>3. <A NAME="s3"></A>The DND internals</H1>
<P>
<A HREF="DragDropHOWTO.html#toc3">Contents of this section</A></P>

<P>I will not describe the DND internals in detail. Instead, I will give the
information necessary for the non-Xt programmers to handle DND drops. I will
do that because I don't have time to document the whole thing, sorry.
If you want to handle drags you may take a look at the DND code.
DND defines two atoms that you must define too. This can be done with the
following code:
<BLOCKQUOTE><CODE>
<HR>
<PRE>
Atom DndProtocol,DndSelection;
DndProtocol=XInternAtom(display,&quot;DndProtocol&quot;,False);
DndSelection=XInternAtom(display,&quot;DndSelection&quot;,False);
</PRE>
<HR>
</CODE></BLOCKQUOTE>
</P>
<P>When a drop occurs, DND will send a client message event to the top level
window of the application that receives the drop. The event will have the
following data:
<BLOCKQUOTE><CODE>
<PRE>
Event.xclient.type              = ClientMessage;
Event.xclient.message_type      = DndProtocol;
Event.xclient.format            = 32;
Event.xclient.data.l[0]         = DataType;
Event.xclient.data.l[1]         = (long)event-&gt;xbutton.state;
Event.xclient.data.l[2]         = (long)widget;
Event.xclient.data.l[3]         = 0;
Event.xclient.data.l[4]         = 0;
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>So your program main event loop will need to intercept this message and take
the appropriate action. Normally, this action consists in getting the drop data
and processing it. This can be done by getting the <CODE>DndSelection</CODE> property
contents of the root window.</P>
<P></P>
<HR>
<P>
<A HREF="DragDropHOWTO-2.html">Previous</A> Chapter
<P>
Table of contents of <A HREF="DragDropHOWTO.html#toc3">this chapter</A>,
 General <A HREF="DragDropHOWTO.html#toc">table of contents</A></P>
<P>
<A HREF="DragDropHOWTO.html">Top</A> of the document,
 <A HREF="#0"> Beginning of this Chapter</A></P>
</BODY>
</HTML>
