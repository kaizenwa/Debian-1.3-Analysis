# rclock/Makefile.in	-*- Makefile -*-
@MCOMMON@
basedir = $(srcdir)/..
thisdir = rclock

first_rule: clock
dummy:

SRCS =	rclock.c
OBJS =	rclock.o
HDRS =	feature.h

#
# Distribution variables
#

DIST = $(HDRS) $(SRCS) Makefile.in rclock.1.in

# inference rules
.c.o:
	$(CC) -c $(CPPFLAGS) $(XINC) -I$(basedir) $(DEFS) $(CFLAGS) $<
#-------------------------------------------------------------------------
all:

clock: alldoc allbin

rclock: VERSION.h $(OBJS)
	$(CC) $(LDFLAGS) -o $@ $(OBJS) $(LIBS) $(XLIB)

VERSION.h:
	echo "#define VERSION \""$(VERSION)"\"" > $@;

rclock.1: rclock.1.in
	sed 's%@VERSION@%$(VERSION)%g;s%@DATE@%$(DATE)%g' $@.in > $@

tags: $(SRCS)
	ctags $(SRCS)

allbin: rclock

alldoc:	rclock.1

clean:
	$(RMF) rclock rclock.1 core a.out *.o *.bak *~

realclean: clean
	$(RMF) VERSION.h tags

distclean:
	(cd $(srcdir); $(RMF) rclock rclock.1 *~ *.o core a.out)
	if test $(srcdir) = .; then $(MAKE) realclean; fi
	(cd $(srcdir); $(RMF) Makefile)

install: allbin alldoc
	$(INSTALL_PROGRAM) rclock $(DESTDIR)$(bindir)/$(binprefix)rclock
	$(INSTALL_DATA) rclock.1 $(DESTDIR)$(mandir)/$(manprefix)rclock.$(manext)

uninstall:
	cd $(bindir); $(RMF) $(binprefix)rclock
	cd $(mandir); $(RMF) $(manprefix)rclock.$(manext)

distdirs:
	mkdir $(basedir)/../$(VERNAME)/$(thisdir)

distcopy:  rclock.1
	$(CP) $(DIST) $(basedir)/../$(VERNAME)/$(thisdir)
	(cd $(basedir)/../$(VERNAME)/$(thisdir) && ln -s ../install.sh ./)
	if test -f rclock.html; then \
	$(CP) rclock.html $(basedir)/../$(VERNAME)/rclock-$(VERSION).html; \
	fi

# -----------------------------------------------------------------------
# DO NOT DELETE: ugly dependency list follows
rclock.o: rclock.c feature.h
