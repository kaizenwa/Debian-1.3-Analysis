# This file is part of the FreeType project.
#
# It builds the library and test programs for emx-gcc.
#
# You will need GNU make.

CC= gcc
INCDIRS= -Ilib
CFLAGS= -Wall -O2 -g -fbounds-checking -ansi $(INCDIRS)
# CFLAGS= -Wall -O2 -s $(INCDIRS)

SRC=  zoom.c timer.c fs_dos.c

OBJ=  fs_dos.o
OBJ1= zoom.o
OBJ2= timer.o


all: freetype timer.exe zoom.exe

freetype:
	make -C lib -f makefile.emx all

zoom.exe: $(OBJ) $(OBJ1) lib/libttf.a
	gcc $(CFLAGS) -o $@ $^ lib/libttf.a

timer.exe: $(OBJ) $(OBJ2) lib/libttf.a
	gcc $(CFLAGS) -o $@ $^ lib/libttf.a

clean: do_clean
	make -C lib -f makefile.emx clean

distclean: do_clean
	make -C lib -f makefile.emx distclean
	-del dep.end
	-del *.exe

do_clean:
	-del *.o

depend:
	make -C lib -f makefile.emx depend
	gcc -E -M $(INCDIRS) $(SRC) > dep.end

ifeq (dep.end,$(wildcard dep.end))
  include dep.end
endif
