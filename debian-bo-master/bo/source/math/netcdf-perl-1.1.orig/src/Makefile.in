# $Id: Makefile.in,v 1.6 1995/06/29 16:11:37 steve Exp $

.POSIX:

PACKAGE		= netcdf-perl
perl		= @PERL@
perl_srcdir	= @PERL_SRCDIR@
SUBDIRS		= port
SUBDIR_TARGETS	= \
		  perl/dynamic perl/perl \
		  perl/test \
		  perl/install perl/inst_perl \
		  perl/clean perl/realclean

MANUALS		= netCDFPerl.1
MANIFEST	= \
		  COPYRIGHT \
		  CUSTOMIZE \
		  HISTORY \
		  INSTALL \
		  Makefile.in \
		  README \
		  VERSION \
		  aclocal.m4 \
		  configure \
		  configure.in \
		  perl/MANIFEST \
		  perl/Makefile.PL.in \
		  perl/NetCDF.pm \
		  perl/NetCDF.xs \
		  perl/test.pl \
		  netCDFPerl.1
GARBAGE		= *.nc

all:		perl/Makefile
	@$(MAKE) $(MFLAGS) decision \
	    DYNAMIC_GOAL=perl/dynamic STATIC_GOAL=perl/perl
	test ! -f perl/so_locations || chmod a+w perl/so_locations

test:		perl/Makefile
	@case `uname -s` in \
	    ULTRIX) \
		$(MAKE) $(MFLAGS) perl/perl; \
		perl/perl -I perl perl/test.pl; \
		;; \
	    *) \
		$(MAKE) $(MFLAGS) perl/test; \
		;; \
	esac

install:	perl/Makefile installed_manuals
	@$(MAKE) $(MFLAGS) decision \
	    DYNAMIC_GOAL=perl/install STATIC_GOAL=perl/inst_perl

clean:		perl/Makefile perl/clean
	rm -f perl/perl

realclean:	perl/Makefile perl/clean
	rm -f perl/perl

perl/Makefile:	perl/Makefile.PL
	cd perl && $(perl) Makefile.PL

decision:	FORCE
	@case `uname -s` in \
	    ULTRIX) \
		$(MAKE) $(MFLAGS) $(STATIC_GOAL); \
		;; \
	    *) \
		$(MAKE) $(MFLAGS) $(DYNAMIC_GOAL); \
		;; \
	esac

perl/perl:	FORCE

include port/master.mk
