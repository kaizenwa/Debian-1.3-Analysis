
# The program name
PROGNAME = @PROGNAME@

# Stuff we install
MANPAGE = flin.1
GPL = COPYING
HELP = system.help
MANUAL = Manual
FLINMENU = system.menu
FLINLOGIN = system.flinlogin
FLINRC = system.flinrc

# Directory to install everything to
prefix = @prefix@
EXEC_PREFIX = @exec_prefix@
BINDIR = $(EXEC_PREFIX)/bin
LIBDIR = $(prefix)/lib/flin
MANDIR = $(prefix)/man/man1

INSTALL = @INSTALL@
MKDIR = mkdir -p
BINFLAGS = -m 755 -s
MANFLAGS = -m 444

RM = rm -f

# C Compiler
CC = @CC@
#DEBUG = -DDEBUG -g
CPPFLAGS = -I. @DEFS@ -DPREFIX=\"@prefix@\"
CFLAGS = @CFLAGS@ $(CPPFLAGS) $(DEBUG)

LDFLAGS = @LDFLAGS@
LIBRARIES = @LIBS@

SCREEN = ncurses

SOURCES = main.c parse.c string.c misc.c menu.c exec.c additional.c screens/$(SCREEN).c
OBJECTS = main.o parse.o string.o misc.o menu.o exec.o additional.o screens/$(SCREEN).o

.c.o:
		$(CC) $(CFLAGS) -c -o $@ $<

$(PROGNAME):	$(OBJECTS)
		$(RM) $@
		$(CC) -o $@ $(OBJECTS) $(LDFLAGS) $(LIBRARIES)

install:
		$(INSTALL) $(BINFLAGS) $(PROGNAME) $(BINDIR)/$(PROGNAME)
		$(MKDIR) $(LIBDIR)
		$(INSTALL) $(MANFLAGS) $(GPL) $(LIBDIR)/GPL
		$(INSTALL) $(MANFLAGS) $(HELP) $(LIBDIR)/$(HELP)
		$(INSTALL) $(MANFLAGS) $(MANUAL) $(LIBDIR)/$(MANUAL)
		$(INSTALL) $(MANFLAGS) $(FLINLOGIN) $(LIBDIR)/$(FLINLOGIN)
		$(INSTALL) $(MANFLAGS) $(FLINRC) $(LIBDIR)/$(FLINRC)
		$(INSTALL) $(MANFLAGS) $(FLINMENU) $(LIBDIR)/$(FLINMENU)
		$(INSTALL) $(MANFLAGS) $(MANPAGE) $(MANDIR)/$(MANPAGE)

clean:		
		$(RM) $(PROGNAME) $(OBJECTS)

mrproper:	clean
		$(RM) configure config.cache config.status config.log config.h Makefile .depend

depend:		dep

dep:		
		$(CC) $(CPPFLAGS) -M $(SOURCES) > .depend

ifeq (.depend,$(wildcard .depend))
include .depend
endif
