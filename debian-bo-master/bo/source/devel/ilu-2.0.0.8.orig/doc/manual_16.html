<!-- This HTML file has been created by texi2html 1.29
     from manual.texinfo on 17 July 1996 -->

<TITLE>ILU Reference Manual - Using Imake with ILU</TITLE>
<BODY TEXT=#000000 BGCOLOR=#ffffff>
<P>Go to the <A HREF="manual_15.html">previous</A>, <A HREF="manual_17.html">next</A> section.<P>
<H1><A NAME="SEC267" HREF="manual_toc.html#SEC267">Using Imake with ILU</A></H1>
<P>
ILU uses the <CODE>imake</CODE> system from the X Window System distribution.
<CODE>imake</CODE> provides a parameterized way of constructing <TT>`Makefile'</TT>s automatically
from <TT>`Imakefile'</TT>s.  The <TT>`Imakefile'</TT>s contain macros which are expanded to regular <TT>`Makefile'</TT>
rules when the program <CODE>imake</CODE> is run.
<P>
<A NAME="IDX218"></A>
<H2><A NAME="SEC268" HREF="manual_toc.html#SEC268">Creating <TT>`Makefile'</TT>s from <TT>`Imakefile'</TT>s</A></H2>
<P>
The program <CODE>ilumkmf</CODE>
<A NAME="IDX219"></A>
is supplied with the ILU system.
When run, it will use the <TT>`Imakefile'</TT> in your current working
directory as input, and produce the corresponding <TT>`Makefile'</TT>,
again in the current working directory:
<P>
<PRE>
% <STRONG>cd myilu</STRONG>
% <STRONG>ls</STRONG>
Imakefile foo.isl fooProg.cc
% <STRONG>ilumkmf</STRONG>
% <STRONG>ls</STRONG>
Imakefile Makefile foo.isl fooProg.cc
%
</PRE>
<P>
<H2><A NAME="SEC269" HREF="manual_toc.html#SEC269">ANSI C Usage</A></H2>
<P>
A typical <TT>`Imakefile'</TT> for an ANSI C ILU application would look like:
<P>
<PRE>
NormalObjectRule()  /* this rule defines the .c -&#62; .o step */

InterfaceTarget(foo.isl)
ILUCTarget(foo.h foo-surrogate.c foo-common.c foo-true.c, foo.isl)

DepObjectTarget(programComponent1.o, foo.h somethingElse.h)
ObjectTarget(programComponent2.o)

CProgramTarget(program, programComponent1.o programComponent2.o foo-surrogate.o foo-common.o,,)
</PRE>
<P>
<H3><A NAME="SEC270" HREF="manual_toc.html#SEC270">ANSI C ILU <CODE>imake</CODE> Macros</A></H3>
<P>
The variable <CODE>LOCAL_INCLUDES</CODE>
<A NAME="IDX220"></A>
is a list of include
file locations to be included when compiling.
<P>
The variable <CODE>ANSI_C_COMMAND</CODE>
<A NAME="IDX221"></A>
defines the particular
command invoked for compiling ANSI C on your system.  If you
wish to use a different ANSI C compiler, override the default
command by redefining this value in your <TT>`Imakefile'</TT>.  Note that it may also be
necessary to build a version of the ILU ANSI C library,
<TT>`<VAR>ILUHOME</VAR>/lib/libilu-c.a'</TT>, to use with this compiler.
<P>
<CODE>NormalObjectRule()</CODE>
<A NAME="IDX222"></A>
defines a number of suffix rules, in particular
the one to go from <TT>`.c'</TT> files to <TT>`.o'</TT> files in your environment.
<P>
<CODE>InterfaceTarget(<VAR>ISL-file</VAR>)</CODE>
<A NAME="IDX223"></A>
defines a number of rules
about the <TT>`.isl'</TT> file <VAR>ISL-file</VAR>.  You should have one of these
in your <TT>`Imakefile'</TT> for every interface you use.
<P>
<CODE>ILUCTarget(<VAR>generated-files</VAR>, <VAR>ISL-file</VAR>)</CODE>
<A NAME="IDX224"></A>
defines
which ANSI C files are generated from the <TT>`isl'</TT> file and may therefore by
re-generated at will, and when the <TT>`.isl'</TT> file changes.  Generally, for
an interface called <CODE>foo</CODE>, the generated files will be
<TT>`foo-surrogate.c'</TT>, <TT>`foo-true.c'</TT>, <TT>`foo-common.c'</TT>, and <TT>`foo.h'</TT>.
<P>
<CODE>ObjectTarget(<VAR>object-file</VAR>)</CODE>
<A NAME="IDX225"></A>
simply states that the
specified <VAR>object-file</VAR> should be built.
<P>
<CODE>DepObjectTarget(<VAR>object-file</VAR>, <VAR>dependencies</VAR>)</CODE>
<A NAME="IDX226"></A>
says
that the specified <VAR>object-file</VAR> should be built, and that it
depends on the files specified in <VAR>dependencies</VAR>, which is a list
of file names separated by spaces.  Whenever something in the <VAR>dependencies</VAR>
list changes, the <VAR>object-file</VAR> will be re-built.
<P>
<CODE>CProgramTarget(<VAR>program-name</VAR>, <VAR>objects</VAR>, <VAR>dep-libraries</VAR>, <VAR>non-dep-libraries</VAR>)</CODE>
<A NAME="IDX227"></A>
defines a program called <VAR>program-name</VAR> that is dependent on
the object files defined in <VAR>objects</VAR>, and the libraries specified in
<VAR>dep-libraries</VAR>, so that it will be re-built if anything changes
in those two groups.  It will also be linked with libraries specified in
<VAR>non-dep-libraries</VAR>, but will not be re-built if they change.  Note that
the ILU ANSI C libraries are not automatically included
by this command, but may be specified as part of the program by specifying them
as part of either <CODE>dep-libraries</CODE> or <CODE>non-dep-libraries</CODE>.
<P>
<CODE>ILUCProgramTarget(<VAR>program-name</VAR>, <VAR>objects</VAR>, <VAR>dep-libraries</VAR>, <VAR>non-dep-libraries</VAR>)</CODE>
<A NAME="IDX228"></A>
defines a program called <VAR>program-name</VAR> that is dependent on
the object files defined in <VAR>objects</VAR>, and the libraries specified in
<VAR>dep-libraries</VAR>, and the normal ILU ANSI C libraries,
so that it will be re-built if anything changes
in those three groups, all of which will be linked into the program <VAR>program-name</VAR>.
It will also be linked with libraries specified in
<VAR>non-dep-libraries</VAR>, but will not be re-built if they change.
This differs from <CODE>CProgramTarget</CODE> in that the ILU libraries
are automatically included.
<P>
<H2><A NAME="SEC271" HREF="manual_toc.html#SEC271">C++ Usage</A></H2>
<P>
A typical <TT>`Imakefile'</TT> for a C++ application and ILU would look like:
<P>
<PRE>
LOCALINCLUDES = -I$(ILUHOME)/include
ILULIBS = $(ILUHOME)/lib/libilu-c++.a $(ILUHOME)/lib/libilu.a

NormalObjectRule()  /* this rule defines the .cc -&#62; .o step */

InterfaceTarget(foo.isl)
ILUCPlusPlusTarget(foo.H foo.cc foo-server-stubs.cc, foo.isl)

DepObjectTarget(programComponent1.o, foo.H somethingElse.H)
ObjectTarget(programComponent2.o)

CPlusPlusProgramTarget(program, programComponent1.o programComponent2.o foo.o, $(ILULIBS),)
</PRE>
<P>
<H3><A NAME="SEC272" HREF="manual_toc.html#SEC272">C++ ILU <CODE>imake</CODE> Macros</A></H3>
<P>
The variable <CODE>LOCAL_INCLUDES</CODE>
<A NAME="IDX229"></A>
is a list of include
file locations to be included when compiling.  <CODE>-I$(ILUHOME)/include</CODE>
should always be on this list for compiling ILU applications.
<P>
The variable <CODE>CPLUSPLUS_COMMAND</CODE>
<A NAME="IDX230"></A>
defines the particular
command invoked for compiling C++ on your system.  If you
wish to use a different C++, override the default
command by redefining this value.  Note that it will also be
necessary to build a version of ILU C++ library,
<TT>`<VAR>ILUHOME</VAR>/lib/libilu-c++.a'</TT>, to use with this compiler.
<P>
<CODE>NormalObjectRule()</CODE>
<A NAME="IDX231"></A>
defines a number of suffix rules, in particular
the one to go from <TT>`.cc'</TT> files to <TT>`.o'</TT> files in your environment.
<P>
<CODE>InterfaceTarget(<VAR>ISL-file</VAR>)</CODE>
<A NAME="IDX232"></A>
defines a number of rules
about the <TT>`.isl'</TT> file <VAR>ISL-file</VAR>.  You should have one of these
in your <TT>`Imakefile'</TT> for every interface you use.
<P>
<CODE>ILUCPlusPlusTarget(<VAR>generated-files</VAR>, <VAR>ISL-file</VAR>)</CODE>
<A NAME="IDX233"></A>
defines
which C++ files are generated from the <TT>`isl'</TT> file and may therefore by
re-generated at will, and when the <TT>`.isl'</TT> file changes.  Generally, for
an interface called <CODE>foo</CODE>, the generated files will be
<TT>`foo.cc'</TT>, <TT>`foo.H'</TT>, and <TT>`foo-server-stubs.cc'</TT>.
<P>
<CODE>ObjectTarget(<VAR>object-file</VAR>)</CODE>
<A NAME="IDX234"></A>
simply states that the
specified <VAR>object-file</VAR> should be built.
<P>
<CODE>DepObjectTarget(<VAR>object-file</VAR>, <VAR>dependencies</VAR>)</CODE>
<A NAME="IDX235"></A>
says
that the specified <VAR>object-file</VAR> should be built, and that it
depends on the files specified in <VAR>dependencies</VAR>, which is a list
of file names separated by spaces.  Whenever something in the <VAR>dependencies</VAR>
list changes, the <VAR>object-file</VAR> will be re-built.
<P>
<CODE>CPlusPlusProgramTarget(<VAR>program-name</VAR>, <VAR>objects</VAR>, <VAR>dep-libraries</VAR>, <VAR>non-dep-libraries</VAR>)</CODE>
<A NAME="IDX236"></A>
defines a program called <VAR>program-name</VAR> that is dependent on
the object files defined in <VAR>objects</VAR>, and the libraries specified in
<VAR>dep-libraries</VAR>, so that it will be re-built if anything changes
in those two groups.  It will also be linked with libraries specified in
<VAR>non-dep-libraries</VAR>, but will not be re-built if they change.
Note that
the ILU ANSI C libraries are not automatically included
by this command, but may be specified as part of the program by specifying them
as part of either <CODE>dep-libraries</CODE> or <CODE>non-dep-libraries</CODE>.
<P>
<CODE>ILUCPlusPlusProgramTarget(<VAR>program-name</VAR>, <VAR>objects</VAR>, <VAR>dep-libraries</VAR>, <VAR>non-dep-libraries</VAR>)</CODE>
<A NAME="IDX237"></A>
defines a program called <VAR>program-name</VAR> that is dependent on
the object files defined in <VAR>objects</VAR>, and the libraries specified in
<VAR>dep-libraries</VAR>, and the normal ILU ANSI C libraries,
so that it will be re-built if anything changes
in those three groups, all of which will be linked into the program <VAR>program-name</VAR>.
It will also be linked with libraries specified in
<VAR>non-dep-libraries</VAR>, but will not be re-built if they change.
This differs from <CODE>CProgramTarget</CODE> in that the ILU libraries
are automatically included.
<P>
<H2><A NAME="SEC273" HREF="manual_toc.html#SEC273">Modula-3 Usage</A></H2>
<P>
A typical <TT>`Imakefile'</TT> for a Modula-3 application and ILU would look like:
<P>
<PRE>
LOCALM3FLAGS = -D$(ILUHOME)/include -L$(ILUHOME)/lib

InterfaceTarget(foo.isl)
ILUM3Target(IluM3Files(foo), foo.isl)
M3LibraryTarget(libfoo.a, IluM3Files(foo), -lilu-m3)
M3ProgramTarget(FooM3Server, FooM3Server.m3 libfoo.a, -lilu-m3 -lilu)
M3ProgramTarget(FooM3Client, FooM3Client.m3 libfoo.a, -lilu-m3 -lilu)
</PRE>
<P>
<H3><A NAME="SEC274" HREF="manual_toc.html#SEC274">Modula-3 ILU <CODE>imake</CODE> Macros</A></H3>
<P>
The variable <CODE>LOCALM3FLAGS</CODE>
<A NAME="IDX238"></A>
is a list of extra arguments to be passed to the <CODE>m3</CODE> command when compiling.  <CODE>-D$(ILUHOME)/include</CODE> and <CODE>-L$(ILUHOME)/lib</CODE>
should always be on this list for compiling ILU applications.
<P>
The variable <CODE>M3_COMMAND</CODE>
<A NAME="IDX239"></A>
defines the particular
command invoked for compiling Modula-3 on your system.  If you
wish to use a different Modula-3, override the default
command by redefining this value.  Note that it will also be
necessary to build a version of ILU Modula-3 library,
<TT>`<VAR>ILUHOME</VAR>/lib/libilu-m3.a'</TT>, to use with this compiler.
<P>
<CODE>IluM3Files(<VAR>base</VAR>)</CODE>
<A NAME="IDX240"></A>
expands to the series of filenames generated by the Modula-3 stubber from <TT>`<VAR>base</VAR>.isl'</TT>: <TT>`<VAR>base</VAR>.i3 <VAR>base</VAR>_x.i3 <VAR>base</VAR>_y.m3 <VAR>base</VAR>_c.m3 <VAR>base</VAR>_s.m3'</TT>.
<P>
<CODE>ILUM3Target(<VAR>generated-files</VAR>, <VAR>ISL-file</VAR>)</CODE>
<A NAME="IDX241"></A>
declares that files <VAR>generated-files</VAR> are generated from the <TT>`isl'</TT> file and may therefore by
re-generated at will, and should be when the <TT>`.isl'</TT> file changes.
<P>
<CODE>M3LibraryTarget(<VAR>library-name</VAR>, <VAR>parts</VAR>, <VAR>non-dep-libraries</VAR>)</CODE>
<A NAME="IDX242"></A>
defines a library called <VAR>library-name</VAR> that is built from <VAR>parts</VAR> and <VAR>non-dep-libraries</VAR>; it will be re-built if anything among the <VAR>parts</VAR> changes.  The <VAR>library-name</VAR> should be the name of the <TT>`.a'</TT> file, including the ".a".
<P>
<CODE>M3ProgramTarget(<VAR>program-name</VAR>, <VAR>parts</VAR>, <VAR>non-dep-libraries</VAR>)</CODE>
<A NAME="IDX243"></A>
defines a program called <VAR>program-name</VAR> that is built from <VAR>parts</VAR> and <VAR>non-dep-libraries</VAR>; it will be re-built if anything among the <VAR>parts</VAR> changes.
<P>
<P>Go to the <A HREF="manual_15.html">previous</A>, <A HREF="manual_17.html">next</A> section.<P>
