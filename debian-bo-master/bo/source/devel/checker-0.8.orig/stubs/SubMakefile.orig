#STUB_CFLAGS = -Wall -fdollars-in-identifiers -c -g
STUB_MOBJS = stubs-stdio.o stubs-string.o stubs-malloc.o stubs-stdlib.o \
 stubs-time.o stubs-sys_timeb.o stubs-unistd.o stubs-fcntl.o stubs-getopt.o \
 stubs-pwd.o stubs-grp.o stubs-sys_stat.o stubs-setjmp.o stubs-signal.o \
 stubs-sys_resource.o stubs-sys_wait.o stubs-sys_utsname.o stubs-dirent.o \
 stubs-utime.o stubs-ioctl.o stubs-fnmatch.o \
 stubs-netinet_in.o stubs-sys_time.o stubs-sys_socket.o stubs-arpa_inet.o \
 stubs-netdb.o stubs-termios.o stubs-sys_uio.o stubs-ctype.o stubs-math.o \
 stubs-termcap.o check-printf.o stubs-sys_mman.o stubs-mntent.o \
 stubs-assert.o # stubs-curses.o

STUB_OBJS = $(STUB_MOBJS) stubs-ncurses.o

stubs-ncurses.o:
	$(CC) -I/usr/include/ncurses $(STUB_CFLAGS) $(srcdir)/stubs/stubs-ncurses.c -o $@

$(STUB_MOBJS):
	$(CC) $(STUB_CFLAGS) $(srcdir)/stubs/$(subst .o,.c,$@) -o $@

libstubs.a: $(STUB_OBJS)
	$(AR) rcv libstubs.a $(STUB_OBJS)

mk-stubs.o: $(srcdir)/stubs/mk-stubs.c
	$(CC) -g -c -o $@ $(srcdir)/stubs/mk-stubs.c

mk-stubs: mk-stubs.o
	$(CC) -o mk-stubs mk-stubs.o

install.stubs: ./stamp-stubs
	@true

./stamp-stubs:
	if test ! -d $(includedir) ; then mkdir $(includedir); fi
	if test ! -d $(includedir)/sys ; then mkdir $(includedir)/sys; fi
	$(INSTALL_DATA) $(srcdir)/stubs/inc-stdio.h $(includedir)/stdio.h
	$(INSTALL_DATA) $(srcdir)/stubs/inc-sys_time.h $(includedir)/sys/time.h
	touch ./stamp-stubs	

uninstall.stubs:
	$(RM) -f $(includedir)/stdio.h $(includedir)/sys/time.h
	$(RM] ./stamp-stubs

stubs-stdio.o: $(srcdir)/stubs/stubs-stdio.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-string.o: $(srcdir)/stubs/stubs-string.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-malloc.o: $(srcdir)/stubs/stubs-malloc.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-stdlib.o: $(srcdir)/stubs/stubs-stdlib.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-time.o: $(srcdir)/stubs/stubs-time.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_timeb.o: $(srcdir)/stubs/stubs-sys_timeb.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-unistd.o: $(srcdir)/stubs/stubs-unistd.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-fcntl.o: $(srcdir)/stubs/stubs-fcntl.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-getopt.o: $(srcdir)/stubs/stubs-getopt.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-pwd.o: $(srcdir)/stubs/stubs-pwd.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-grp.o: $(srcdir)/stubs/stubs-grp.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_stat.o: $(srcdir)/stubs/stubs-sys_stat.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-setjmp.o: $(srcdir)/stubs/stubs-setjmp.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-signal.o: $(srcdir)/stubs/stubs-signal.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_resource.o: $(srcdir)/stubs/stubs-sys_resource.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_wait.o: $(srcdir)/stubs/stubs-sys_wait.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_utsname.o: $(srcdir)/stubs/stubs-sys_utsname.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-dirent.o: $(srcdir)/stubs/stubs-dirent.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-utime.o: $(srcdir)/stubs/stubs-utime.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-ioctl.o: $(srcdir)/stubs/stubs-ioctl.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-fnmatch.o: $(srcdir)/stubs/stubs-fnmatch.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-curses.o: $(srcdir)/stubs/stubs-curses.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-netinet_in.o: $(srcdir)/stubs/stubs-netinet_in.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_time.o: $(srcdir)/stubs/stubs-sys_time.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_socket.o: $(srcdir)/stubs/stubs-sys_socket.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-arpa_inet.o: $(srcdir)/stubs/stubs-arpa_inet.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-netdb.o: $(srcdir)/stubs/stubs-netdb.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-termios.o: $(srcdir)/stubs/stubs-termios.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_uio.o: $(srcdir)/stubs/stubs-sys_uio.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-ctype.o: $(srcdir)/stubs/stubs-ctype.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-math.o: $(srcdir)/stubs/stubs-math.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-termcap.o: $(srcdir)/stubs/stubs-termcap.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-ncurses.o: $(srcdir)/stubs/stubs-ncurses.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-sys_mman.o: $(srcdir)/stubs/stubs-sys_mman.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-mntent.o: $(srcdir)/stubs/stubs-mntent.c $(srcdir)/checker_api.h \
  ./available-stubs.h
stubs-assert.o: $(srcdir)/stubs/stubs-assert.c $(srcdir)/checker_api.h \
  ./available-stubs.h

check-printf.o: $(srcdir)/stubs/check-printf.c \
  $(srcdir)/stubs/check-printf.h $(srcdir)/checker_api.h
